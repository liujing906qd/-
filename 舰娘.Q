[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=c0ac3c71-3249-4d6f-ae63-2f2425773c90
Description=舰娘
Enable=0
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Dimenv AutoSupply
Dimenv AutoRepair
Dimenv AutoExpedition
Dimenv AutoAttack

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply1.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply2.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply3.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply4.Value = Form.CB_AutoSupply.Value
End Event
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
End Event
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
End Event
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
End Event


/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"

//远征地图下标
Dim ExpeditionMapIndex
ExpeditionMapIndex = 0
//远征任务下标
Dim ExpeditionMisstionIndex
ExpeditionMisstionIndex = 4

//出击地图下标
Dim AttackMapIndex
AttackMapIndex = 0
//出击任务下标X
Dim AttackMisstionXIndex
AttackMisstionXIndex = 0
//出击任务下标Y
Dim AttackMisstionYIndex
AttackMisstionYIndex = 0
Dim AttackNightFight
AttackNightFight = 1
Dim AttackFightRound
AttackFightRound = 3

//补给舰队下标最大值
Dim SupplyNavyMax
SupplyNavyMax = 1
/*****************************设置常量*****************************/
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMisstionPosition = "160|170"
Const ExpeditionMisstionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//入渠类型坐标
Const RepairTypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMisstionPosition = "280|200"
Const AttackMisstionPositionOffsetX = 350
Const AttackMisstionPositionOffsetY = 150
/**********************************************************初始化变量**********************************************************/
Dim X, Y
X = -1 
Y = -1
//**********************************************************逻辑**********************************************************/
/****************************初始化****************************/
Call GetHwndForGame()
/****************************远征结束*****************************/
Call GoToMuGang()
Call LJ_FindPic("远征_结束_开始")
If (FoundPic = 1) Then 
    Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
    Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
    Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
End If
/*****************************补给*****************************/
If (AutoSupply = 1) Then 
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
If (AutoRepair = 1) Then 
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    Call RepairNavy()
End If
/*****************************远征*****************************/
If (AutoExpedition = 1) Then 
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    Call SelectExpeditionMap()
    Delay 1000
    Call SelectExpeditionMisstion()
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call GoToMuGang()
    Call LJ_DeleyForNet()
End If
/****************************出击****************************/
If (AutoAttack = 1) Then 
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
    Call SelectAttackMap()
    Call SelectAttackMisstion()
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
    Call Fighting()
    Call LJ_DeleyForNet()
End If
/*****************************结束*****************************/
Delay 600000
/**********************************************************函数**********************************************************/
/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
End Function
Function GoToScene(SceneName)
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*选择远征地图*/
Function SelectExpeditionMap()
    Call LJ_PointAdd(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
    Call LJ_LeftClickOnXY()
End Function
/*选择远征关卡*/
Function SelectExpeditionMisstion()
    Call LJ_PointAdd(ExpeditionMisstionPosition,0,ExpeditionMisstionIndex * ExpeditionMisstionPositionOffset)
    Call LJ_LeftClickOnXY()
End Function

/*选择补给舰队*/
Function SupplyNavy()
    For index = 0 To SupplyNavyMax
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
        Call LJ_FindPicUntilFoundThenClick("补给_补给列表_确定补给")
        Call LJ_DeleyForNet()
    Next
End Function

/*入渠*/
Function RepairNavy()
    For index = 0 To 3
        Call LJ_PointAddAndClick(RepairEmptyPosition, 0, index * RepairEmptyPositionOffset)
        
        Dim Timeout
        Timeout = 0
        Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        Do While (FoundPic = 0)
            Call LJ_PointGetAndClick(RepairTypePosition)
            Delay 100
            Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
            Delay 100
            Timeout = Timeout + 100
            If (Timeout >= 20000) Then 
                Exit Function
            End If
        Loop
        //确定船只
        Call LJ_PointAdd(RepairNavyPosition,0,index * RepairNavyPositionOffset)
        Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_入渠开始")
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_维修开始_确定维修")
    Next
End Function

/*选择出击地图*/
Function SelectAttackMap()
    Call LJ_PointAdd(AttackMapPosition,AttackMapIndex * AttackMapPositionOffset,0)
    Call LJ_LeftClickOnXY()
End Function
/*选择出击关卡*/
Function SelectAttackMisstion()
    Call LJ_PointAdd(AttackMisstionPosition,AttackMisstionXIndex * AttackMisstionPositionOffsetX,AttackMisstionYIndex * AttackMisstionPositionOffsetY)
    Call LJ_LeftClickOnXY()
End Function

Function Fighting()
    FightingRound = 0
    Do
        Call LJ_FindPicAndClick ("战斗_战斗中_指南针")
        Call LJ_FindPicAndClick ("战斗_战斗中_阵形_复k阵")
        Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1	
            End If
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
        	Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
        	If (FoundPic = 1) Then 
        		FightingRound = 999//不在继续战斗
        	End If
        End If
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function
/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndTidu,HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(hwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    hwnd = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    If (hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
End Function
/**第三方库查找图片**/
Function LiebFindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(hwnd, 0, 0, 800, 480, resourceFolder & picName & ".bmp", 50, 0.9, X, Y)
End Function
Function LiebFindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, 0.9, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call LiebFindPic(picName)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call LiebFindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call LiebFindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call LiebFindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    Call Plugin.Bkgnd.LeftClick(hwnd, X, Y)
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim zb
    ZB = InStr(XY, "|")
    X = Clng(Left(XY, ZB - 1)) : Y = Clng(Right(XY, Len(XY) - ZB))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

Function LJ_DeleyForNet()
    Delay 5000
End Function
