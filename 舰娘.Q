[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=c0ac3c71-3249-4d6f-ae63-2f2425773c90
Description=舰娘
Enable=1
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Dimenv AutoSupply
Dimenv AutoRepair
Dimenv AutoExpedition
Dimenv AutoAttack

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply1.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply2.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply3.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply4.Value = Form.CB_AutoSupply.Value
End Event
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
End Event
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
End Event
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
End Event


/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"

ExpeditionNavyMisstion1ID = 1
ExpeditionNavyMisstion2ID = 2

//出击地图下标
AttackMapIndex = 1
//出击任务下标X
AttackMisstionXIndex = 1
//出击任务下标Y
AttackMisstionYIndex = 1
AttackNightFight = 0
AttackFightRound = 0

//补给舰队下标最大值
SupplyNavyMax = 2
/*****************************设置常量*****************************/
//远征舰队坐标
Const ExpeditionNavyPosition = "356|120"
Const ExpeditionNavyPositionOffset = 30
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMisstionPosition = "160|170"
Const ExpeditionMisstionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//入渠类型坐标
Const RepairTypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMisstionPosition = "280|200"
Const AttackMisstionPositionOffsetX = 350
Const AttackMisstionPositionOffsetY = 150
/**********************************************************初始化变量**********************************************************/
X = -1 
Y = - 1 

ShipWasDestroyed = 0














//**********************************************************逻辑**********************************************************/

/****************************初始化****************************/
Call GetHwndForGame()
Call TD_CheckExpedition()
/****************************远征结束*****************************/
Call GoToMuGang()
/*****************************补给*****************************/
TracePrint "AutoSupply:" & AutoSupply
If (AutoSupply = 1) Then 
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
TracePrint "AutoRepair:" & AutoRepair
If (AutoRepair = 1) Then 
    Call RepairNavy()
End If
/*****************************远征*****************************/
TracePrint "AutoExpedition:" & AutoExpedition
If (AutoExpedition = 1) Then 
    Call ExpeditionNavy()
End If
/****************************出击****************************/
TracePrint "AutoAttack:" & AutoAttack
If (AutoAttack = 1) Then 
    Call AttackNavy()
End If
/*****************************补给*****************************/
If (AutoSupply = 1) Then 
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
If (AutoRepair = 1) Then 
    Call RepairNavy()
End If
/*****************************结束*****************************/
Call TD_CheckExpedition()
























/**********************************************************函数**********************************************************/








/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    //回到母港
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
    //每次回港都直接检查远征
    Call LJ_FindPic("远征_结束_开始")
    If (FoundPic = 1) Then 
        Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
        Call LJ_DeleyForNet()
        Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
        Call LJ_DeleyForNet()
        Call LJ_DeleyForNet()
        Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
        If (AutoSupply = 1) Then 
            Call SupplyNavy()
        End If
    End If
End Function
Function GoToScene(SceneName)
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*远征主逻辑*/
Function ExpeditionNavy()
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    
    Call ExpeditionSelectMapByMisstionID(ExpeditionNavyMisstion1ID,1)
    Call ExpeditionSelectMapByMisstionID(ExpeditionNavyMisstion2ID,2)
    
    Call LJ_DeleyForNet()
    
    Call GoToMuGang()
End Function

/*选择远征地图*/
Function ExpeditionSelectMapByMisstionID(ExpeditionMisstionID,NavyNumber)
    //远征地图下标
    ExpeditionMapIndex = ExpeditionMisstionID / 8
    TracePrint "ExpeditionMapIndex:" & ExpeditionMapIndex
    //远征任务下标
    ExpeditionMisstionIndex = ExpeditionMisstionID mod 8
    TracePrint "ExpeditionMisstionIndex:" & ExpeditionMisstionIndex
    
    /*选择远征地图*/
    Call LJ_PointAddAndClick(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
	/*选择远征关卡*/
    Call LJ_PointAddAndClick(ExpeditionMisstionPosition,0,ExpeditionMisstionIndex * ExpeditionMisstionPositionOffset)

    Call LJ_FindPic("出击_远征_远征中止")
    If (FoundPic = 1) Then //如果远征正在执行，则退出
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_PointAddAndClick(ExpeditionNavyPosition, NavyNumber * ExpeditionNavyPositionOffset, 0)
    Call LJ_FindPic("远征_结束_舰队_缺油")
    If (FoundPic = 1) Then 
        If (AutoSupply = 1) Then 
            Call SupplyNavy()
        End If
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
End Function

/*补给*/
Function SupplyNavy()
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    For index = 0 To SupplyNavyMax
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_FindPic("补给_补给列表_全选框")
        If (FoundPic = 1) Then 
       		Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
            Call LJ_FindPic("补给_补给列表_确定补给_disable")
            If (FoundPic = 0) Then 
                Call LJ_FindPicAndClick("补给_补给列表_确定补给")
                Call LJ_DeleyForNet()
            End If
        End If
    Next
End Function

/*入渠*/
Function RepairNavy()
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    
    Dim FlagShipIsRepayed
    FlagShipIsRepayed = 0
    Dim RepairedX, RepairedY
    RepairedX = 0
    RepairedY = 0
    For index = 0 To 3
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_空位")
        
        //        Dim Timeout
        //        Timeout = 0
        //        Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //        Do While (FoundPic = 0)
        //            Call LJ_PointGetAndClick(RepairTypePosition)
        //            Delay 100
        //            Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //            Delay 100
        //            Timeout = Timeout + 100
        //            If (Timeout >= 5000) Then 
        //                Exit Function
        //            End If
        //        Loop
        //确定船只
        For index = 0 To 9
            //            Call LJ_FindPicByRect("入渠_维修列表_第一舰队附舰",RepairedX,RepairedY,800,480)
            //            If (FoundPic = 1) Then 
            RepairedX = X
            RepairedY = Y
            Call LJ_FindPicByRect("入渠_战斗状态_小破", RepairedX, RepairedY, 800,480)
            Call LJ_LeftClickOnXY()
            Call LJ_FindPicByRect("入渠_战斗状态_中破", RepairedX, RepairedY, 800,480)
            Call LJ_LeftClickOnXY()
            Call LJ_FindPicByRect("入渠_战斗状态_大破", RepairedX, RepairedY, 800,480)
            Call LJ_LeftClickOnXY()
            Call LJ_FindPicByRect("入渠_战斗状态_修复", RepairedX, RepairedY, 800,480)
            If (FoundPic = 1) Then 
                RepairedX = RepairedX + 0
                RepairedY = RepairedY + 25
                Goto IsRepayed
            End If
            //            End If
            Call LJ_FindPicAndClick("入渠_维修列表_入渠开始")
            Call LJ_FindPicAndClick("入渠_维修列表_维修开始_确定维修")
            Call LJ_FindPicAndClick("入渠_维修列表_空位_详情返回")
            Call LJ_FindPicAndClick("入渠_维修列表_空位_列表返回")
            Rem IsRepayed
        Next
    Next
    Call GoToMuGang()
End Function

/**战斗**/
Function AttackNavy()
    Call LJ_FindPicByRect("提督_舰队状态_可以出击",107,579,122,594)
    If (FoundPic = 0) Then 
        TracePrint "舰队没有准备完毕"
    End If
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
	/*选择出击地图*/
    Call LJ_PointAddAndClick(AttackMapPosition, AttackMapIndex * AttackMapPositionOffset, 0)
    Delay 1000
	/*选择出击关卡*/
    Call LJ_PointAddAndClick(AttackMisstionPosition,AttackMisstionXIndex * AttackMisstionPositionOffsetX,AttackMisstionYIndex * AttackMisstionPositionOffsetY)
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPic("出击_出击_出击开始_disable")
    If (FoundPic = 0) Then 
        Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
        Call Fighting()
        Call LJ_DeleyForNet()
    End If
End Function
Function Fighting()
    FightingRound = 0
    Do
        Call LJ_FindPicAndClick("战斗_战斗中_指南针")
        Call LJ_FindPic("战斗_地图_2_2_boss")
        If (FoundPic = 1) Then 
            Call RefreshGame()
        End If
        Call LJ_FindPicAndClick("战斗_战斗中_阵形_复k阵")
        If (AttackNightFight = 1) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_追击")
        End If
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1	
            End If
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
            Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
            If (FoundPic = 1) Then 
                ShipWasDestroyed = 1
                FightingRound = 999//不在继续战斗
            End If
        End If
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function














/**********************************************************控制提督很忙**********************************************************/











Function TD_RefreshGame()
    Call setHwndByTidu()
    Call LJ_PointGetAndClick("30|840")
    Call LJ_PointGetAndClick("130|590")
    Call LJ_PointGetAndClick("770|590")
    Call LJ_FindPicAndClick("提督_设置")
    Call setHwndByGame()
End Function

Function TD_BackToMuGang()
    Call setHwndByGame()
    Call GoToMuGang()
End Function


/**检查远征是否就绪**/
Function TD_CheckExpedition()
    Do
        Call setHwndByTidu()
        Call LJ_FindPic("提督_远征_第二舰队_准备就绪1")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Call LJ_FindPic("提督_远征_第二舰队_准备就绪2")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Call LJ_FindPic("提督_远征_第三舰队_准备就绪1")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Call LJ_FindPic("提督_远征_第三舰队_准备就绪2")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Call LJ_FindPic("提督_舰队_可以出击")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Call LJ_FindPic("提督_舰队_疲劳回复完毕")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Call LJ_FindPic("提督_综合_6只疲劳49")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Call LJ_FindPic("提督_综合_6只疲劳40以上")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Delay 5000
    loop While (True)
End Function













/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(HwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    HwndGame = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    Call setHwndByGame()
    If (Hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
    Call Plugin.Window.SetClientSize(HwndTidu, 800, 1000)
    TracePrint "HwndTidu:" & HwndTidu
    TracePrint "HwndGame:" & HwndGame
    TracePrint "Hwnd:" & Hwnd
End Function
Function setHwndByGame()
    Hwnd = HwndGame
    TracePrint "Hwnd Game Hwnd:" & Hwnd
    ScreenHeight = 480
    ScreenWidth = 800
    PicDefinition = 0.9
End Function
Function setHwndByTidu()
    TracePrint "Hwnd Tidu Hwnd:" & Hwnd
    Hwnd = HwndTidu
    ScreenHeight = 1000
    ScreenWidth = 800
    PicDefinition = 1.0
End Function

/**第三方库查找图片**/
Function Lib_FindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, 0, 0, ScreenWidth, ScreenHeight, resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function
Function Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call Lib_FindPic(picName)
    If X > - 1  Then //找到了
        TracePrint "LJ_FindPic:" & picName & " FoundPic = true"
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            TracePrint "LJ_FindPic:" & picName & " FoundPic = false"
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    If X <= - 1  Then 
        Exit Function
    End If
    TracePrint "LJ_LeftClickOnXY x:" & X & " Y :" & Y
    If (Y < 800) Then 
        Call Plugin.Bkgnd.LeftClick(Hwnd, X, Y)
    Else 
        Call Plugin.Bkgnd.LeftClick(HwndTidu, X, Y)
    End If
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim ZuoBiao
    ZuoBiao = InStr(XY, "|")
    X = Clng(Left(XY, ZuoBiao - 1)) : Y = Clng(Right(XY, Len(XY) - ZuoBiao))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

Function LJ_DeleyForNet()
    Delay 5000
End Function
