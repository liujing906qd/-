[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=2a66429a-f8d4-4300-b6ee-02f792c0369c
Description=舰娘
Enable=1
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]
记得停止睡眠模式

[UIPackage]
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


[Script]
Dimenv AutoSupply
Dimenv AutoRepair
Dimenv AutoExpedition
Dimenv AutoAttack

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

DimEnv Expedition_Navy2_Enable,Expedition_Navy3_Enable,Expedition_Navy4_Enable
DimEnv ExpeditionMisstionID_Navy2, ExpeditionMisstionID_Navy3, ExpeditionMisstionID_Navy4

DimEnv AttackMisstionXIndex,AttackMisstionYIndex,AttackMapIndex

//自动补给开关
Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply1.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply2.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply3.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply4.Value = Form.CB_AutoSupply.Value
End Event
//自动入渠开关
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
    Form.CB_Repair_Dapo.Value = Form.CB_AutoRepair.Value
    Form.CB_Repair_ZhongPo.Value = 0
    Form.CB_Repair_XiaoPo.Value = 0
    Form.CB_Repair_Navy_1.Value = Form.CB_AutoRepair.Value
End Event
//自动远征开关
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
    Form.CB_Expedition_Navy2_Enable.Value = Form.CB_AutoExpedition.Value
    Form.CB_Expedition_Navy3_Enable.Value = Form.CB_AutoExpedition.Value
    Form.CB_Expedition_Navy4_Enable.Value = Form.CB_AutoExpedition.Value
End Event
//自动攻击开关
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
    //    Form.CB_Attack_When_DaPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_When_DaPo.Value = 0
    Form.CB_Attack_When_ZhongPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_When_XiaoPo.Value = Form.CB_AutoAttack.Value
End Event

//大破出击开关
Event Form.CB_Attack_When_DaPo.Click
    If (Form.CB_Attack_When_DaPo.Value = 1) Then 
        MessageBox "警告，这极有可能导致舰船沉没！请确认了解该情况会导致的后果！"
    End If
End Event

//出击地图
Event Form.CB_Attack_MapLevel.SelectChange
    AttackMapIndex = Form.CB_Attack_MapLevel.ListIndex
End Event
//出击关卡
Event Form.CB_Attack_MissionLevel.SelectChange
    AttackMisstionXIndex = Form.CB_Attack_MissionLevel.ListIndex mod 2
    AttackMisstionYIndex = Int(Form.CB_Attack_MissionLevel.ListIndex / 2)
End Event
//是否进击回合次数
Event Form.CB_AttackNightFight.Click
    AttackNightFight = Form.CB_AttackNightFight.Value
End Event
//是否夜战
Event Form.CB_AttackFightRound.SelectChange
    AttackFightRound = Form.CB_AttackFightRound.ListIndex
End Event

//设置第几舰队远征
Event Form.CB_Expedition_Navy2_Enable.Click
    Expedition_Navy2_Enable = Form.CB_Expedition_Navy2_Enable.Value
End Event
Event Form.CB_Expedition_Navy3_Enable.Click
    Expedition_Navy3_Enable = Form.CB_Expedition_Navy3_Enable.Value
End Event
Event Form.CB_Expedition_Navy4_Enable.Click
    Expedition_Navy4_Enable = Form.CB_Expedition_Navy4_Enable.Value
End Event
//设置远征地图
Event Form.CB_Expedition_Missionevel_Navy2.SelectChange
    ExpeditionMisstionID_Navy2 = Form.CB_Expedition_Missionevel_Navy2.ListIndex
End Event
Event Form.CB_Expedition_Missionevel_Navy3.SelectChange
    ExpeditionMisstionID_Navy3 = Form.CB_Expedition_Missionevel_Navy3.ListIndex
End Event
Event Form.CB_Expedition_Missionevel_Navy4.SelectChange
    ExpeditionMisstionID_Navy4 = Form.CB_Expedition_Missionevel_Navy4.ListIndex
End Event

/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"

//补给舰队下标最大值
SupplyNavyMax = 2
/*****************************设置常量*****************************/
//远征舰队坐标
Const ExpeditionNavyPosition = "356|120"
Const ExpeditionNavyPositionOffset = 30
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMisstionPosition = "160|170"
Const ExpeditionMisstionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//入渠类型坐标
Const RepairTypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMisstionPosition = "280|200"
Const AttackMisstionPositionOffsetX = 350
Const AttackMisstionPositionOffsetY = 150
/**********************************************************初始化变量**********************************************************/
X = -1 
Y = - 1 

ShipWasDestroyed = 0














//**********************************************************逻辑**********************************************************/

/****************************初始化****************************/
Call GetHwndForGame()
TracePrint "Form.CB_Supply1.Value:" & Form.CB_Supply1.Value
Call TD_CheckTiDu()
///****************************远征结束*****************************/
//Call GoToMuGang()
///*****************************补给*****************************/
//TracePrint "AutoSupply:" & AutoSupply
//If (AutoSupply = 1) Then 
//    Call SupplyNavy()
//End If
///*****************************入渠*****************************/
//TracePrint "AutoRepair:" & AutoRepair
//If (AutoRepair = 1) Then 
//    Call RepairNavy()
//End If
///*****************************远征*****************************/
//TracePrint "AutoExpedition:" & AutoExpedition
//If (AutoExpedition = 1) Then 
//    Call ExpeditionNavy()
//End If
///****************************出击****************************/
//TracePrint "AutoAttack:" & AutoAttack
//If (AutoAttack = 1) Then 
//    Call AttackNavy()
//End If
///*****************************补给*****************************/
//If (AutoSupply = 1) Then 
//    Call SupplyNavy()
//End If
///*****************************入渠*****************************/
//If (AutoRepair = 1) Then 
//    Call RepairNavy()
//End If
///*****************************结束*****************************/
//Call TD_CheckExpedition()
























/**********************************************************函数**********************************************************/








/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    Call setHwndByGame()
    //回到母港
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
    
    Do While(FoundPic = 1)
        //每次回港都直接检查远征
        Call LJ_FindPic("远征_结束_开始")
        If (FoundPic = 1) Then 
            TracePrint "发现远征结束舰队"
            Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
            Call LJ_DeleyForNet()
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPic("远征_结束_开始")
            isExpeditionFinish = True
        End If
    Loop
    If (isExpeditionFinish) Then 
        isExpeditionFinish = False
        Call SupplyNavy()
    End If
End Function
Function GoToScene(SceneName)
    Call setHwndByGame()
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*远征主逻辑*/
Function ExpeditionNavy()
    TracePrint "AutoExpedition:" & AutoExpedition
    Call setHwndByGame()
    If (AutoExpedition = 0) Then 
        Exit Function
    End If
    
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    
    If (Expedition_Navy2_Enable = 1) Then 
        Call ExpeditionSelectMapByMisstionID(ExpeditionMisstionID_Navy2,1)	
    End If
    If (Expedition_Navy3_Enable = 1) Then 
        Call ExpeditionSelectMapByMisstionID(ExpeditionMisstionID_Navy3,2)	
    End If
    If (Expedition_Navy4_Enable = 1) Then 
        Call ExpeditionSelectMapByMisstionID(ExpeditionMisstionID_Navy4,3)	
    End If
    
    
    Call LJ_DeleyForNet()
    
    Call GoToMuGang()
End Function

/*选择远征地图*/
Function ExpeditionSelectMapByMisstionID(ExpeditionMisstionID,NavyNumber)
    //远征地图下标
    ExpeditionMapIndex = ExpeditionMisstionID / 8
    TracePrint "ExpeditionMapIndex:" & ExpeditionMapIndex
    //远征任务下标
    ExpeditionMisstionIndex = ExpeditionMisstionID mod 8
    TracePrint "ExpeditionMisstionIndex:" & ExpeditionMisstionIndex
    
    /*选择远征地图*/
    Call LJ_PointAddAndClick(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
	/*选择远征关卡*/
    Call LJ_PointAddAndClick(ExpeditionMisstionPosition,0,ExpeditionMisstionIndex * ExpeditionMisstionPositionOffset)

    Call LJ_FindPic("出击_远征_远征中止")
    If (FoundPic = 1) Then //如果远征正在执行，则退出
        TracePrint "第" & NavyNumber + 1 & "舰队已经在执行远征任务"
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_PointAddAndClick(ExpeditionNavyPosition, NavyNumber * ExpeditionNavyPositionOffset, 0)
    Call LJ_FindPic("远征_结束_舰队_缺油")
    If (FoundPic = 1) Then 
        TracePrint NavyNumber & "舰队在执行任务" & ExpeditionMisstionID + 1  & "时缺油"
        Call SupplyNavy()
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
End Function

/*补给主逻辑*/
Function SupplyNavy()
    TracePrint "AutoSupply:" & AutoSupply
    Call setHwndByGame()
    If (AutoSupply = 0) Then 
        Exit Function
    End If
    Call GoToMuGang()
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    For index = 0 To SupplyNavyMax
        If (index = 0) Then 
            If (Form.CB_Supply1.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 1) Then 
            If (Form.CB_Supply2.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 2) Then 
            If (Form.CB_Supply3.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 3) Then 
            If (Form.CB_Supply4.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_FindPic("补给_补给列表_全选框")
        If (FoundPic = 1) Then 
            TracePrint "补给第" & index+1 &"舰队时，使用全选框"
            Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
            Call LJ_FindPic("补给_补给列表_确定补给_disable")
            If (FoundPic = 0) Then 
                TracePrint "不能补给，第" & index+1 &"舰队"
                Call LJ_FindPicAndClick("补给_补给列表_确定补给")
                Call LJ_DeleyForNet()
            End If
        End If
        Rem 下一个补给舰队
    Next
End Function

/*入渠主逻辑*/
Function RepairNavy()
    TracePrint "AutoRepair:" & AutoRepair
    Call setHwndByGame()
    If (AutoRepair = 0) Then 
        Exit Function
    End If
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    
    Dim FlagShipIsRepayed
    FlagShipIsRepayed = 0
    Dim RepairedX, RepairedY
    RepairedX = 0
    RepairedY = 0
    IsRepayed = 0
    For index = 0 To 3
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_空位")
        
        //        Dim Timeout
        //        Timeout = 0
        //        Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //        Do While (FoundPic = 0)
        //            Call LJ_PointGetAndClick(RepairTypePosition)
        //            Delay 100
        //            Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //            Delay 100
        //            Timeout = Timeout + 100
        //            If (Timeout >= 5000) Then 
        //                Exit Function
        //            End If
        //        Loop
        //确定船只
        For index = 0 To 9
            TracePrint "正在判断第" & index+1 &"艘舰"
            If (Form.CB_Repair_Navy_1.Value = 1) Then 
                Call LJ_FindPicByRect("入渠_维修列表_第一舰队", X, Y, 800, 480)
            End If
            If (FoundPic = 1) Then 
                TracePrint "找到第一舰队 x:" & X & " Y:" &Y
                IsRepayed = RepairFindShip(X, Y)
            End If
            If (IsRepayed = 0) Then 
                Call LJ_FindPicAndClick("入渠_维修列表_入渠开始")
                Call LJ_FindPicAndClick("入渠_维修列表_维修开始_确定维修")
                Call LJ_FindPicAndClick("入渠_维修列表_空位_详情返回")
                Call LJ_FindPicAndClick("入渠_维修列表_空位_列表返回")
            End If
        Next
    Next
    Call GoToMuGang()
End Function

Function RepairFindShip(RepairedX,RepairedY)
    RepairedYStart = RepairedY - 10
    RepairedYEnd = RepairedY + 30
    If (Form.CB_Repair_XiaoPo.Value = 1) Then 
        TracePrint"小破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_小破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_ZhongPo.Value = 1) Then 
        TracePrint"中破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_中破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_DaPo.Value = 1) Then 
        TracePrint"大破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_大破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    Call LJ_FindPicByRect("入渠_战斗状态_修复", RepairedX, RepairedYStart, 800,RepairedYEnd)
    If (FoundPic = 1) Then 
        RepairedX = RepairedX + 0
        RepairedY = RepairedY + 25
        RepairFindShip = 0
    End If
    
End Function

/**战斗**/
Function AttackNavy()
    Call setHwndByGame()
    TracePrint "AttackNavy:" & AttackNavy
    If (AutoAttack = 0) Then 
        Exit Function
    End If
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
	/*选择出击地图*/
    Call LJ_PointAddAndClick(AttackMapPosition, AttackMapIndex * AttackMapPositionOffset, 0)
    Delay 1000
	/*选择出击关卡*/
    Call LJ_PointAddAndClick(AttackMisstionPosition,AttackMisstionXIndex * AttackMisstionPositionOffsetX,AttackMisstionYIndex * AttackMisstionPositionOffsetY)
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPic("出击_出击_出击开始_disable")
    If (FoundPic = 0) Then 
        Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
        Call Fighting()
        Call LJ_DeleyForNet()
    End If
End Function
Function Fighting()
    FightingRound = 0
    Do
        Call LJ_FindPicAndClick("战斗_战斗中_指南针")
        Call LJ_FindPicAndClick("战斗_战斗中_阵形_复k阵")
        If (AttackNightFight = 1) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_追击")
        End If
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1
                TracePrint "当前战斗回合数：" & FightingRound & " 总攻击回合数：" & AttackFightRound
            End If
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
            TracePrint "战斗结束，判断舰船是否大破"
            Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
            If (FoundPic = 1) Then 
                TracePrint "检测到舰船大破，不在继续进击"
                ShipWasDestroyed = 1
                FightingRound = 999//不在继续战斗
            End If
        End If
        Call LJ_FindPicAndClick("进击_结束_评价_继续")
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function














/**********************************************************控制提督很忙**********************************************************/











Function TD_RefreshGame()
    Call setHwndByTidu()
    Call LJ_PointGetAndClick("30|840")
    Call LJ_PointGetAndClick("130|590")
    Call LJ_PointGetAndClick("770|590")
    Call LJ_FindPicAndClick("提督_设置")
    Call setHwndByGame()
End Function

Function TD_BackToMuGang()
    Call setHwndByGame()
    Call GoToMuGang()
End Function

/*****************************远征*****************************/
Function TD_Expedition()
    Call setHwndByGame()
    Call GoToMuGang()
    Call SupplyNavy()
    TracePrint "AutoExpedition:" & AutoExpedition
    Call ExpeditionNavy()
End Function

/****************************出击****************************/
Function TD_Attack()
    Call setHwndByGame()
    Call GoToMuGang()
    Call SupplyNavy()
    Call RepairNavy()
    Call AttackNavy()
End Function


/**检查远征是否就绪**/
Function TD_CheckTiDu()
    Do
        Call setHwndByTidu()
        
        Rem 远征判断
        Call LJ_FindPic("提督_综合_远征_第二舰队_准备就绪1")
        If (FoundPic = 1) Then 
            Call TD_Expedition()
            Exit Function
        End If
        Call LJ_FindPic("提督_综合_远征_第二舰队_准备就绪2")
        If (FoundPic = 1) Then 
            Call TD_Expedition()
            Exit Function
        End If
        Call LJ_FindPic("提督_综合_远征_第三舰队_准备就绪1")
        If (FoundPic = 1) Then 
            Call TD_Expedition()
            Exit Function
        End If
        Call LJ_FindPic("提督_综合_远征_第三舰队_准备就绪2")
        If (FoundPic = 1) Then 
            Call TD_Expedition()
            Exit Function
        End If
        Rem 远征结束
        
        Rem 进击判断
        If (AutoAttack = 1) Then 
            Call LJ_FindPic("提督_综合_舰队列表_HP_大破")
            If (Form.CB_Attack_When_DaPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否大破"
            Else 
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否大破：是 取消出击！"
                    Call TD_Repair()
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否大破：否"
                End If
            End If
            If (Form.CB_Attack_When_ZhongPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否中破"
            Else 
                Call LJ_FindPic("提督_综合_舰队列表_HP_中破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否中破：是 取消出击！"
                    Call TD_Repair() 
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否中破：否"
                End If
            End If
            If (Form.CB_Attack_When_XiaoPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否小破"
            Else
                Call LJ_FindPic("提督_综合_舰队列表_HP_小破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否小破：是 取消出击！"
                    Call TD_Repair()
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否小破：否"
                End If
            End If
            Call LJ_FindPic("提督_综合_舰队列表_入渠中")
            If (FoundPic = 1) Then 
                TracePrint "当前舰队有船只正在入渠"
                Goto 进击结束
            End If
            TracePrint "AutoAttack:" & AutoAttack
            If (AutoAttack = 1) Then 
                Call LJ_FindPic("提督_综合_舰队列表_可以出击")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_疲劳回复完毕")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_6只疲劳49")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_6只疲劳40以上")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPicByRect("提督_综合_舰队列表_舰队状态_可以出击",103,572,130,604)
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
            End If
        End If
        Rem 进击结束
        TracePrint "进击结束"
        
        Delay 5000
    loop While (True)
End Function













/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(HwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    HwndGame = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    Call setHwndByGame()
    If (Hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
    Call Plugin.Window.SetClientSize(HwndTidu, 800, 1000)
    TracePrint "HwndTidu:" & HwndTidu
    TracePrint "HwndGame:" & HwndGame
    TracePrint "Hwnd:" & Hwnd
End Function
Function setHwndByGame()
    Hwnd = HwndGame
    TracePrint "Hwnd Game Hwnd:" & Hwnd
    ScreenHeight = 480
    ScreenWidth = 800
    PicDefinition = 0.9
End Function
Function setHwndByTidu()
    TracePrint "Hwnd Tidu Hwnd:" & Hwnd
    Hwnd = HwndTidu
    ScreenHeight = 1000
    ScreenWidth = 800
    PicDefinition = 1.0
End Function

/**第三方库查找图片**/
Function Lib_FindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, 0, 0, ScreenWidth, ScreenHeight, resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function
Function Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call Lib_FindPic(picName)
    If X > - 1  Then //找到了
        TracePrint "LJ_FindPic:" & picName & " FoundPic = true"
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            TracePrint "LJ_FindPic:" & picName & " FoundPic = false"
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    If X <= - 1  Then 
        Exit Function
    End If
    TracePrint "LJ_LeftClickOnXY x:" & X & " Y :" & Y
    If (Y < 800) Then 
        Call Plugin.Bkgnd.LeftClick(Hwnd, X, Y)
    Else 
        Call Plugin.Bkgnd.LeftClick(HwndTidu, X, Y)
    End If
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim ZuoBiao
    ZuoBiao = InStr(XY, "|")
    X = Clng(Left(XY, ZuoBiao - 1)) : Y = Clng(Right(XY, Len(XY) - ZuoBiao))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

Function LJ_DeleyForNet()
    Delay 5000
End Function
