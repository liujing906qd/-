[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=c0ac3c71-3249-4d6f-ae63-2f2425773c90
Description=舰娘
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Dimenv AutoSupply
Dimenv AutoRepair
Dimenv AutoExpedition
Dimenv AutoAttack

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply1.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply2.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply3.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply4.Value = Form.CB_AutoSupply.Value
End Event
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
End Event
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
End Event
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
End Event


/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"

//远征地图下标
Dim ExpeditionMapIndex
ExpeditionMapIndex = 0
//远征任务下标
Dim ExpeditionMisstionIndex
ExpeditionMisstionIndex = 4

//出击地图下标
Dim AttackMapIndex
AttackMapIndex = 1
//出击任务下标X
Dim AttackMisstionXIndex
AttackMisstionXIndex = 1
//出击任务下标Y
Dim AttackMisstionYIndex
AttackMisstionYIndex = 0
Dim AttackNightFight
AttackNightFight = 1
Dim AttackFightRound
AttackFightRound = 3

//补给舰队下标最大值
Dim SupplyNavyMax
SupplyNavyMax = 1
/*****************************设置常量*****************************/
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMisstionPosition = "160|170"
Const ExpeditionMisstionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//入渠类型坐标
Const RepairTypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMisstionPosition = "280|200"
Const AttackMisstionPositionOffsetX = 350
Const AttackMisstionPositionOffsetY = 150
/**********************************************************初始化变量**********************************************************/
Dim X, Y
X = -1 
Y = - 1 
Dim ShipWasDestroyed
ShipWasDestroyed = 0





//**********************************************************逻辑**********************************************************/
/****************************初始化****************************/
Call GetHwndForGame()
/****************************远征结束*****************************/
Call GoToMuGang()
Call LJ_FindPic("远征_结束_开始")
If (FoundPic = 1) Then 
    Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
    Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
    Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
End If
/*****************************补给*****************************/
If (AutoSupply = 1) Then 
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
If (AutoRepair = 1) Then 
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    Call RepairNavy()
End If
/*****************************远征*****************************/
If (AutoExpedition = 1) Then 
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    Call SelectExpeditionMap()
    Call SelectExpeditionMisstion()
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
    Call GoToMuGang()
End If
/****************************出击****************************/
If (AutoAttack = 1) Then 
    If (ShipWasDestroyed = 1) Then 
        MessageBox "舰船大破无法出击，脚本中止。请修理后在启动脚本"
        EndScript
    End If
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
    Call SelectAttackMap()
    Call SelectAttackMisstion()
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
    Call Fighting()
    Call LJ_DeleyForNet()
End If
/*****************************补给*****************************/
If (AutoSupply = 1) Then 
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
If (AutoRepair = 1) Then 
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    Call RepairNavy()
End If
/*****************************结束*****************************/
//Delay 600000










/**********************************************************函数**********************************************************/
/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
End Function
Function GoToScene(SceneName)
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*选择远征地图*/
Function SelectExpeditionMap()
    Call LJ_PointAdd(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
    Call LJ_LeftClickOnXY()
End Function
/*选择远征关卡*/
Function SelectExpeditionMisstion()
    Call LJ_PointAdd(ExpeditionMisstionPosition,0,ExpeditionMisstionIndex * ExpeditionMisstionPositionOffset)
    Call LJ_LeftClickOnXY()
End Function

/*选择补给舰队*/
Function SupplyNavy()
    For index = 0 To SupplyNavyMax
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
        Call LJ_FindPicUntilFoundThenClick("补给_补给列表_确定补给")
        Call LJ_DeleyForNet()
    Next
End Function

/*入渠*/
Function RepairNavy()
    Dim FlagShipIsRepayed
    FlagShipIsRepayed = 0
    Dim RepairedX, RepairedY
    RepairedX = 0
    RepairedY = 0
    For index = 0 To 3
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_空位")
        
        //        Dim Timeout
        //        Timeout = 0
        //        Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //        Do While (FoundPic = 0)
        //            Call LJ_PointGetAndClick(RepairTypePosition)
        //            Delay 100
        //            Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //            Delay 100
        //            Timeout = Timeout + 100
        //            If (Timeout >= 5000) Then 
        //                Exit Function
        //            End If
        //        Loop
        //确定船只
        For index = 0 To 9
            Call LJ_FindPicByRect("入渠_维修列表_第一舰队附舰",RepairedX,RepairedY,800,480)
            If (FoundPic = 1) Then 
                RepairedX = X
                RepairedY = Y
                Call LJ_FindPicByRect("入渠_战斗状态_修复", RepairedX, RepairedY, 800,480)
                If (FoundPic = 1) Then 
                    RepairedX = RepairedX + 0
                    RepairedY = RepairedY + 25
                    Goto IsRepayed
                End If
                Call LJ_FindPicByRect("入渠_战斗状态_大破", RepairedX, RepairedY, 800,480)
                Call LJ_LeftClickOnXY()
                Call LJ_FindPicByRect("入渠_战斗状态_中破", RepairedX, RepairedY, 800,480)
                Call LJ_LeftClickOnXY()
                Call LJ_FindPicByRect("入渠_战斗状态_小破", RepairedX, RepairedY, 800,480)
                Call LJ_LeftClickOnXY()
            End If
            Call LJ_FindPicAndClick("入渠_维修列表_入渠开始")
            Call LJ_FindPicAndClick("入渠_维修列表_维修开始_确定维修")
            Call LJ_FindPicAndClick("入渠_维修列表_空位_详情返回")
            Call LJ_FindPicAndClick("入渠_维修列表_空位_列表返回")
            Rem IsRepayed
        Next
    Next
    Call GoToMuGang()
End Function

/*选择出击地图*/
Function SelectAttackMap()
    Call LJ_PointAdd(AttackMapPosition,AttackMapIndex * AttackMapPositionOffset,0)
    Call LJ_LeftClickOnXY()
End Function
/*选择出击关卡*/
Function SelectAttackMisstion()
    Call LJ_PointAdd(AttackMisstionPosition,AttackMisstionXIndex * AttackMisstionPositionOffsetX,AttackMisstionYIndex * AttackMisstionPositionOffsetY)
    Call LJ_LeftClickOnXY()
End Function

Function Fighting()
    FightingRound = 0
    Do
        Call LJ_FindPicAndClick ("战斗_战斗中_指南针")
        Call LJ_FindPicAndClick ("战斗_战斗中_阵形_复k阵")
        Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1	
            End If
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
            Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
            If (FoundPic = 1) Then 
                ShipWasDestroyed = 1
                FightingRound = 999//不在继续战斗
            End If
        End If
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function










/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndTidu,HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(hwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    hwnd = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    If (hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
End Function
/**第三方库查找图片**/
Function LiebFindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(hwnd, 0, 0, 800, 480, resourceFolder & picName & ".bmp", 50, 0.9, X, Y)
End Function
Function LiebFindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, 0.9, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call LiebFindPic(picName)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call LiebFindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call LiebFindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call LiebFindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    If X <= - 1  Then 
        Exit Function
    End If
    Call Plugin.Bkgnd.LeftClick(hwnd, X, Y)
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim zb
    ZB = InStr(XY, "|")
    X = Clng(Left(XY, ZB - 1)) : Y = Clng(Right(XY, Len(XY) - ZB))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

Function LJ_DeleyForNet()
    Delay 5000
End Function
