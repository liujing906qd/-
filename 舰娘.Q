[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=c0ac3c71-3249-4d6f-ae63-2f2425773c90
Description=舰娘
Enable=1
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Dimenv AutoSupply
Dimenv AutoRepair
Dimenv AutoExpedition
Dimenv AutoAttack

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply1.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply2.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply3.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply4.Value = Form.CB_AutoSupply.Value
End Event
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
End Event
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
End Event
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
End Event


/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"

ExpeditionNavyMisstion1ID = 1
ExpeditionNavyMisstion2ID = 2

//出击地图下标
AttackMapIndex = 1
//出击任务下标X
AttackMisstionXIndex = 1
//出击任务下标Y
AttackMisstionYIndex = 0
AttackNightFight = 0
AttackFightRound = 0

//补给舰队下标最大值
SupplyNavyMax = 2
/*****************************设置常量*****************************/
//远征舰队坐标
Const ExpeditionNavyPosition = "356|120"
Const ExpeditionNavyPositionOffset = 30
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMisstionPosition = "160|170"
Const ExpeditionMisstionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//入渠类型坐标
Const RepairTypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMisstionPosition = "280|200"
Const AttackMisstionPositionOffsetX = 350
Const AttackMisstionPositionOffsetY = 150
/**********************************************************初始化变量**********************************************************/
X = -1 
Y = - 1 

ShipWasDestroyed = 0





//**********************************************************逻辑**********************************************************/
/****************************初始化****************************/
Call GetHwndForGame()
Call TD_CheckExpedition()
/****************************远征结束*****************************/
Call GoToMuGang()
/*****************************补给*****************************/
TracePrint "AutoSupply:" & AutoSupply
If (AutoSupply = 1) Then 
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
TracePrint "AutoRepair:" & AutoRepair
If (AutoRepair = 1) Then 
    Call RepairNavy()
End If
/*****************************远征*****************************/
TracePrint "AutoExpedition:" & AutoExpedition
If (AutoExpedition = 1) Then 
    Call ExpeditionNavy()
End If
/****************************出击****************************/
TracePrint "AutoAttack:" & AutoAttack
If (AutoAttack = 1) Then 
    If (ShipWasDestroyed = 1) Then 
        MessageBox "舰船大破无法出击，脚本中止。请修理后在启动脚本"
        EndScript
    End If
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
	/*选择出击地图*/
    Call LJ_PointAddAndClick(AttackMapPosition, AttackMapIndex * AttackMapPositionOffset, 0)
	/*选择出击关卡*/
    Call LJ_PointAddAndClick(AttackMisstionPosition,AttackMisstionXIndex * AttackMisstionPositionOffsetX,AttackMisstionYIndex * AttackMisstionPositionOffsetY)
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPic("出击_出击_出击开始_disable")
    If (FoundPic = 0) Then 
        Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
        Call Fighting()
        Call LJ_DeleyForNet()
    End If
End If
/*****************************补给*****************************/
If (AutoSupply = 1) Then 
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
If (AutoRepair = 1) Then 
    Call RepairNavy()
End If
/*****************************结束*****************************/
Call TD_CheckExpedition()


/**********************************************************函数**********************************************************/
/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    //回到母港
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
    //每次回港都直接检查远征
    Call LJ_FindPic("远征_结束_开始")
    If (FoundPic = 1) Then 
        Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
        Call LJ_DeleyForNet()
        Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
        Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
        If (AutoSupply = 1) Then 
            Call SupplyNavy()
        End If
    End If
End Function
Function GoToScene(SceneName)
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*远征主逻辑*/
Function ExpeditionNavy()
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    
    Call ExpeditionSelectMapByMisstionID(ExpeditionNavyMisstion1ID,1)
    Call ExpeditionSelectMapByMisstionID(ExpeditionNavyMisstion2ID,2)
    
    Call LJ_DeleyForNet()
    
    Call GoToMuGang()
End Function

/*选择远征地图*/
Function ExpeditionSelectMapByMisstionID(ExpeditionMisstionID,NavyNumber)
    //远征地图下标
    ExpeditionMapIndex = ExpeditionMisstionID / 8
    TracePrint "ExpeditionMapIndex:" & ExpeditionMapIndex
    //远征任务下标
    ExpeditionMisstionIndex = ExpeditionMisstionID mod 8
    TracePrint "ExpeditionMisstionIndex:" & ExpeditionMisstionIndex
    
    /*选择远征地图*/
    Call LJ_PointAddAndClick(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
	/*选择远征关卡*/
    Call LJ_PointAddAndClick(ExpeditionMisstionPosition,0,ExpeditionMisstionIndex * ExpeditionMisstionPositionOffset)

    Call LJ_FindPic("出击_远征_远征中止")
    If (FoundPic = 1) Then //如果远征正在执行，则退出
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_PointAddAndClick(ExpeditionNavyPosition,NavyNumber * ExpeditionNavyPositionOffset,0)
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
End Function

/*补给*/
Function SupplyNavy()
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    For index = 0 To SupplyNavyMax
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
        Call LJ_FindPic("补给_补给列表_确定补给_disable")
        If (FoundPic = 0) Then 
            Call LJ_FindPicAndClick("补给_补给列表_确定补给")
            Call LJ_DeleyForNet()
        End If
    Next
End Function

/*入渠*/
Function RepairNavy()
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    
    Dim FlagShipIsRepayed
    FlagShipIsRepayed = 0
    Dim RepairedX, RepairedY
    RepairedX = 0
    RepairedY = 0
    For index = 0 To 3
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_空位")
        
        //        Dim Timeout
        //        Timeout = 0
        //        Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //        Do While (FoundPic = 0)
        //            Call LJ_PointGetAndClick(RepairTypePosition)
        //            Delay 100
        //            Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //            Delay 100
        //            Timeout = Timeout + 100
        //            If (Timeout >= 5000) Then 
        //                Exit Function
        //            End If
        //        Loop
        //确定船只
        For index = 0 To 9
            //            Call LJ_FindPicByRect("入渠_维修列表_第一舰队附舰",RepairedX,RepairedY,800,480)
            //            If (FoundPic = 1) Then 
            RepairedX = X
            RepairedY = Y
            Call LJ_FindPicByRect("入渠_战斗状态_小破", RepairedX, RepairedY, 800,480)
            Call LJ_LeftClickOnXY()
            Call LJ_FindPicByRect("入渠_战斗状态_中破", RepairedX, RepairedY, 800,480)
            Call LJ_LeftClickOnXY()
            Call LJ_FindPicByRect("入渠_战斗状态_大破", RepairedX, RepairedY, 800,480)
            Call LJ_LeftClickOnXY()
            Call LJ_FindPicByRect("入渠_战斗状态_修复", RepairedX, RepairedY, 800,480)
            If (FoundPic = 1) Then 
                RepairedX = RepairedX + 0
                RepairedY = RepairedY + 25
                Goto IsRepayed
            End If
            //            End If
            Call LJ_FindPicAndClick("入渠_维修列表_入渠开始")
            Call LJ_FindPicAndClick("入渠_维修列表_维修开始_确定维修")
            Call LJ_FindPicAndClick("入渠_维修列表_空位_详情返回")
            Call LJ_FindPicAndClick("入渠_维修列表_空位_列表返回")
            Rem IsRepayed
        Next
    Next
    Call GoToMuGang()
End Function

/**战斗**/
Function Fighting()
    FightingRound = 0
    Do
        Call LJ_FindPicAndClick("战斗_战斗中_指南针")
        Call LJ_FindPic("战斗_地图_2_2_boss")
        If (FoundPic = 1) Then 
            Call RefreshGame()
        End If
        Call LJ_FindPicAndClick ("战斗_战斗中_阵形_复k阵")
        Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1	
            End If
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
            Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
            If (FoundPic = 1) Then 
                ShipWasDestroyed = 1
                FightingRound = 999//不在继续战斗
            End If
        End If
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function

/**********************************************************控制提督很忙**********************************************************/
Function TD_RefreshGame()
    Call setHwndByTidu()
    Call LJ_PointGetAndClick("30|840")
    Call LJ_PointGetAndClick("130|590")
    Call LJ_PointGetAndClick("770|590")
    Call setHwndByGame()
End Function

/**检查远征是否就绪**/
Function TD_CheckExpedition()
    Do
        Call setHwndByTidu()
        Call LJ_FindPic("提督_远征_第二舰队_准备就绪1")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Call LJ_FindPic("提督_远征_第二舰队_准备就绪2")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Call LJ_FindPic("提督_远征_第三舰队_准备就绪1")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Delay 100
    loop While (True)
End Function

Function TD_BackToMuGang()
    Call setHwndByGame()
    Call GoToMuGang()
End Function

/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(HwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    HwndGame = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    Call setHwndByGame()
    If (Hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
    Call Plugin.Window.SetClientSize(HwndTidu, 800, 1000)
    TracePrint "HwndTidu:" & HwndTidu
    TracePrint "HwndGame:" & HwndGame
    TracePrint "Hwnd:" & Hwnd
End Function
Function setHwndByGame()
    Hwnd = HwndGame
    TracePrint "Hwnd Game Hwnd:" & Hwnd
    ScreenHeight = 480
    ScreenWidth = 800
End Function
Function setHwndByTidu()
    TracePrint "Hwnd Tidu Hwnd:" & Hwnd
    Hwnd = HwndTidu
    ScreenHeight = 1000
    ScreenWidth = 800
End Function

/**第三方库查找图片**/
Function Lib_FindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, 0, 0, ScreenWidth, ScreenHeight, resourceFolder & picName & ".bmp", 50, 0.9, X, Y)
End Function
Function Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, 0.9, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call Lib_FindPic(picName)
    If X > - 1  Then //找到了
        TracePrint "LJ_FindPic:" & picName & " FoundPic = true"
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            TracePrint "LJ_FindPic:" & picName & " FoundPic = false"
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    If X <= - 1  Then 
        Exit Function
    End If
    TracePrint "LJ_LeftClickOnXY x:" & X & " Y :" & Y
    If (Y < 800) Then 
        Call Plugin.Bkgnd.LeftClick(Hwnd, X, Y)
    Else 
        Call Plugin.Bkgnd.LeftClick(HwndTidu, X, Y)
    End If
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim ZuoBiao
    ZuoBiao = InStr(XY, "|")
    X = Clng(Left(XY, ZuoBiao - 1)) : Y = Clng(Right(XY, Len(XY) - ZuoBiao))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

Function LJ_DeleyForNet()
    Delay 5000
End Function
