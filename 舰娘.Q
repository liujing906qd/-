[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=c0ac3c71-3249-4d6f-ae63-2f2425773c90
Description=舰娘
Enable=1
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Dimenv AutoSupply
Dimenv AutoRepair
Dimenv AutoExpedition
Dimenv AutoAttack

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply1.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply2.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply3.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply4.Value = Form.CB_AutoSupply.Value
End Event
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
End Event
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
End Event
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
End Event


/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"

ExpeditionNavyMisstion1ID = 2
ExpeditionNavyMisstion2ID = 3

//出击地图下标
AttackMapIndex = 1
//出击任务下标X
AttackMisstionXIndex = 1
//出击任务下标Y
AttackMisstionYIndex = 0
AttackNightFight = 0
AttackFightRound = 0

//补给舰队下标最大值
SupplyNavyMax = 2
/*****************************设置常量*****************************/
//远征舰队坐标
Const ExpeditionNavyPosition = "356|120"
Const ExpeditionNavyPositionOffset = 30
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMisstionPosition = "160|170"
Const ExpeditionMisstionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//入渠类型坐标
Const RepairTypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMisstionPosition = "280|200"
Const AttackMisstionPositionOffsetX = 350
Const AttackMisstionPositionOffsetY = 150
/**********************************************************初始化变量**********************************************************/
X = -1 
Y = - 1 

ShipWasDestroyed = 0





//**********************************************************逻辑**********************************************************/
/****************************初始化****************************/
Call GetHwndForGame()
Call RefreshGame()
/****************************远征结束*****************************/
Call GoToMuGang()
/*****************************补给*****************************/
If (AutoSupply = 1) Then 
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
If (AutoRepair = 1) Then 
    Call RepairNavy()
End If
/*****************************远征*****************************/
If (AutoExpedition = 1) Then 
    Call ExpeditionNavy()
End If
/****************************出击****************************/
If (AutoAttack = 1) Then 
    If (ShipWasDestroyed = 1) Then 
        MessageBox "舰船大破无法出击，脚本中止。请修理后在启动脚本"
        EndScript
    End If
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
    Call SelectAttackMap()
    Call SelectAttackMisstion()
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
    Call Fighting()
    Call LJ_DeleyForNet()
End If
/*****************************补给*****************************/
If (AutoSupply = 1) Then 
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
If (AutoRepair = 1) Then 
    Call RepairNavy()
End If
/*****************************结束*****************************/
Delay 600000










/**********************************************************函数**********************************************************/
/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    //回到母港
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
    //每次回港都直接检查远征
    Call LJ_FindPic("远征_结束_开始")
    If (FoundPic = 1) Then 
        Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
        Call LJ_DeleyForNet()
        Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
        Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
    End If
End Function
Function GoToScene(SceneName)
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*远征主逻辑*/
Function ExpeditionNavy()
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    
    Call ExpeditionSelectMapByMisstionID(ExpeditionNavyMisstion1ID,1)
    Call ExpeditionSelectMapByMisstionID(ExpeditionNavyMisstion2ID,2)
    
    Call LJ_DeleyForNet()
    
    Call GoToMuGang()
End Function

/*选择远征地图*/
Function ExpeditionSelectMapByMisstionID(ExpeditionMisstionID,NavyNumber)
    //远征地图下标
    ExpeditionMapIndex = ExpeditionMisstionID / 8
    //远征任务下标
    ExpeditionMisstionIndex = ExpeditionMisstionID mod 8
    /*选择出击地图*/
	Call LJ_PointAddAndClick(AttackMapPosition, AttackMapIndex * AttackMapPositionOffset, 0)
	/*选择出击关卡*/
    Call LJ_PointAddAndClick(AttackMisstionPosition,AttackMisstionXIndex * AttackMisstionPositionOffsetX,AttackMisstionYIndex * AttackMisstionPositionOffsetY)
    Call LJ_FindPic("出击_远征_远征中止")
    If (FoundPic = 1) Then //如果远征正在执行，则退出
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_PointAddAndClick(ExpeditionNavyPosition,NavyNumber * ExpeditionNavyPositionOffset,0)
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
End Function

/*选择远征地图*/
Function ExpeditionSelectMap()
    Call LJ_PointAddAndClick(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
End Function
/*选择远征关卡*/
Function ExpeditionSelectMisstion()
    Call LJ_PointAddAndClick(ExpeditionMisstionPosition,0,ExpeditionMisstionIndex * ExpeditionMisstionPositionOffset)
End Function

/*补给*/
Function SupplyNavy()
    Call GoToScene("补给")
    For index = 0 To SupplyNavyMax
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
        Call LJ_FindPic("补给_补给列表_不能补给")
        If (FoundPic = 1) Then 
        	Exit Function
        End If
        Call LJ_FindPicAndClick("补给_补给列表_确定补给")
        Call LJ_DeleyForNet()
    Next
End Function

/*入渠*/
Function RepairNavy()
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    
    Dim FlagShipIsRepayed
    FlagShipIsRepayed = 0
    Dim RepairedX, RepairedY
    RepairedX = 0
    RepairedY = 0
    For index = 0 To 3
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_空位")
        
        //        Dim Timeout
        //        Timeout = 0
        //        Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //        Do While (FoundPic = 0)
        //            Call LJ_PointGetAndClick(RepairTypePosition)
        //            Delay 100
        //            Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //            Delay 100
        //            Timeout = Timeout + 100
        //            If (Timeout >= 5000) Then 
        //                Exit Function
        //            End If
        //        Loop
        //确定船只
        For index = 0 To 9
            //            Call LJ_FindPicByRect("入渠_维修列表_第一舰队附舰",RepairedX,RepairedY,800,480)
            //            If (FoundPic = 1) Then 
            RepairedX = X
            RepairedY = Y
            Call LJ_FindPicByRect("入渠_战斗状态_小破", RepairedX, RepairedY, 800,480)
            Call LJ_LeftClickOnXY()
            Call LJ_FindPicByRect("入渠_战斗状态_中破", RepairedX, RepairedY, 800,480)
            Call LJ_LeftClickOnXY()
            Call LJ_FindPicByRect("入渠_战斗状态_大破", RepairedX, RepairedY, 800,480)
            Call LJ_LeftClickOnXY()
            Call LJ_FindPicByRect("入渠_战斗状态_修复", RepairedX, RepairedY, 800,480)
            If (FoundPic = 1) Then 
                RepairedX = RepairedX + 0
                RepairedY = RepairedY + 25
                Goto IsRepayed
            End If
            //            End If
            Call LJ_FindPicAndClick("入渠_维修列表_入渠开始")
            Call LJ_FindPicAndClick("入渠_维修列表_维修开始_确定维修")
            Call LJ_FindPicAndClick("入渠_维修列表_空位_详情返回")
            Call LJ_FindPicAndClick("入渠_维修列表_空位_列表返回")
            Rem IsRepayed
        Next
    Next
    Call GoToMuGang()
End Function

Function Fighting()
    FightingRound = 0
    Do
        Call LJ_FindPicAndClick("战斗_战斗中_指南针")
        Call LJ_FindPic("战斗_地图_2_2_boss")
        If (FoundPic = 1) Then 
            Call RefreshGame()
        End If
        Call LJ_FindPicAndClick ("战斗_战斗中_阵形_复k阵")
        Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1	
            End If
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
            Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
            If (FoundPic = 1) Then 
                ShipWasDestroyed = 1
                FightingRound = 999//不在继续战斗
            End If
        End If
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function


/**********************************************************控制提督很忙**********************************************************/
Function RefreshGame()
    Call LJ_PointGetAndClick("30|840")
    Call LJ_PointGetAndClick("130|590")
    Call LJ_PointGetAndClick("770|590")
End Function






/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(hwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    hwnd = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    //    hwnd = HwndTidu
    If (hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
End Function
/**第三方库查找图片**/
Function Lib_FindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(hwnd, 0, 0, 800, 480, resourceFolder & picName & ".bmp", 50, 0.9, X, Y)
End Function
Function Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, 0.9, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call Lib_FindPic(picName)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    If X <= - 1  Then 
        Exit Function
    End If
    If (Y < 800) Then 
        Call Plugin.Bkgnd.LeftClick(hwnd, X, Y)
    Else 
        Call Plugin.Bkgnd.LeftClick(HwndTidu, X, Y)
    End If
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim ZuoBiao
    ZuoBiao = InStr(XY, "|")
    X = Clng(Left(XY, ZuoBiao - 1)) : Y = Clng(Right(XY, Len(XY) - ZuoBiao))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

Function LJ_DeleyForNet()
    Delay 5000
End Function
