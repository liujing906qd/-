[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=c0ac3c71-3249-4d6f-ae63-2f2425773c90
Description=舰娘
Enable=1
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Dimenv AutoSupply
Dimenv AutoRepair
Dimenv AutoExpedition
Dimenv AutoAttack

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply1.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply2.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply3.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply4.Value = Form.CB_AutoSupply.Value
End Event
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
End Event
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
End Event
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
End Event


/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"

ExpeditionNavyMisstion1ID = 1
ExpeditionNavyMisstion2ID = 2

//出击地图下标
AttackMapIndex = 1
//出击任务下标X
AttackMisstionXIndex = 1
//出击任务下标Y
AttackMisstionYIndex = 1
AttackNightFight = 0
AttackFightRound = 0

//补给舰队下标最大值
SupplyNavyMax = 2
/*****************************设置常量*****************************/
//远征舰队坐标
Const ExpeditionNavyPosition = "356|120"
Const ExpeditionNavyPositionOffset = 30
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMisstionPosition = "160|170"
Const ExpeditionMisstionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//入渠类型坐标
Const RepairTypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMisstionPosition = "280|200"
Const AttackMisstionPositionOffsetX = 350
Const AttackMisstionPositionOffsetY = 150
/**********************************************************初始化变量**********************************************************/
X = -1 
Y = - 1 

ShipWasDestroyed = 0














//**********************************************************逻辑**********************************************************/

/****************************初始化****************************/
Call GetHwndForGame()
/****************************远征结束*****************************/
Call GoToMuGang()
/*****************************补给*****************************/
TracePrint "AutoSupply:" & AutoSupply
If (AutoSupply = 1) Then 
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
TracePrint "AutoRepair:" & AutoRepair
If (AutoRepair = 1) Then 
    Call RepairNavy()
End If
/*****************************远征*****************************/
TracePrint "AutoExpedition:" & AutoExpedition
If (AutoExpedition = 1) Then 
    Call ExpeditionNavy()
End If
/****************************出击****************************/
TracePrint "AutoAttack:" & AutoAttack
If (AutoAttack = 1) Then 
    Call AttackNavy()
End If
/*****************************补给*****************************/
If (AutoSupply = 1) Then 
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
If (AutoRepair = 1) Then 
    Call RepairNavy()
End If
/*****************************结束*****************************/
Call TD_CheckExpedition()
























/**********************************************************函数**********************************************************/








/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    //回到母港
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
    //每次回港都直接检查远征
    Call LJ_FindPic("远征_结束_开始")
    If (FoundPic = 1) Then 
        Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
        Call LJ_DeleyForNet()
        Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
        Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
        If (AutoSupply = 1) Then 
            Call SupplyNavy()
        End If
    End If
End Function
Function GoToScene(SceneName)
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*远征主逻辑*/
Function ExpeditionNavy()
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    
    Call ExpeditionSelectMapByMisstionID(ExpeditionNavyMisstion1ID,1)
    Call ExpeditionSelectMapByMisstionID(ExpeditionNavyMisstion2ID,2)
    
    Call LJ_DeleyForNet()
    
    Call GoToMuGang()
End Function

/*选择远征地图*/
Function ExpeditionSelectMapByMisstionID(ExpeditionMisstionID,NavyNumber)
    //远征地图下标
    ExpeditionMapIndex = ExpeditionMisstionID / 8
    TracePrint "ExpeditionMapIndex:" & ExpeditionMapIndex
    //远征任务下标
    ExpeditionMisstionIndex = ExpeditionMisstionID mod 8
    TracePrint "ExpeditionMisstionIndex:" & ExpeditionMisstionIndex
    
    /*选择远征地图*/
    Call LJ_PointAddAndClick(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
	/*选择远征关卡*/
    Call LJ_PointAddAndClick(ExpeditionMisstionPosition,0,ExpeditionMisstionIndex * ExpeditionMisstionPositionOffset)

    Call LJ_FindPic("出击_远征_远征中止")
    If (FoundPic = 1) Then //如果远征正在执行，则退出
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_PointAddAndClick(ExpeditionNavyPosition, NavyNumber * ExpeditionNavyPositionOffset, 0)
    Call LJ_FindPic("远征_结束_舰队_缺油")
    If (FoundPic = 1) Then 
        If (AutoSupply = 1) Then 
            Call SupplyNavy()
        End If
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
End Function

/*补给*/
Function SupplyNavy()
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    For index = 0 To SupplyNavyMax
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
        Call LJ_FindPic("补给_补给列表_确定补给_disable")
        If (FoundPic = 0) Then 
            Call LJ_FindPicAndClick("补给_补给列表_确定补给")
            Call LJ_DeleyForNet()
        End If
    Next
End Function

/*入渠*/
Function RepairNavy()
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    
    Dim FlagShipIsRepayed
    FlagShipIsRepayed = 0
    Dim RepairedX, RepairedY
    RepairedX = 0
    RepairedY = 0
    For index = 0 To 3
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_空位")
        
        //        Dim Timeout
        //        Timeout = 0
        //        Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //        Do While (FoundPic = 0)
        //            Call LJ_PointGetAndClick(RepairTypePosition)
        //            Delay 100
        //            Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //            Delay 100
        //            Timeout = Timeout + 100
        //            If (Timeout >= 5000) Then 
        //                Exit Function
        //            End If
        //        Loop
        //确定船只
        For index = 0 To 9
            //            Call LJ_FindPicByRect("入渠_维修列表_第一舰队附舰",RepairedX,RepairedY,800,480)
            //            If (FoundPic = 1) Then 
            RepairedX = X
            RepairedY = Y
            Call LJ_FindPicByRect("入渠_战斗状态_小破", RepairedX, RepairedY, 800,480)
            Call LJ_LeftClickOnXY()
            Call LJ_FindPicByRect("入渠_战斗状态_中破", RepairedX, RepairedY, 800,480)
            Call LJ_LeftClickOnXY()
            Call LJ_FindPicByRect("入渠_战斗状态_大破", RepairedX, RepairedY, 800,480)
            Call LJ_LeftClickOnXY()
            Call LJ_FindPicByRect("入渠_战斗状态_修复", RepairedX, RepairedY, 800,480)
            If (FoundPic = 1) Then 
                RepairedX = RepairedX + 0
                RepairedY = RepairedY + 25
                Goto IsRepayed
            End If
            //            End If
            Call LJ_FindPicAndClick("入渠_维修列表_入渠开始")
            Call LJ_FindPicAndClick("入渠_维修列表_维修开始_确定维修")
            Call LJ_FindPicAndClick("入渠_维修列表_空位_详情返回")
            Call LJ_FindPicAndClick("入渠_维修列表_空位_列表返回")
            Rem IsRepayed
        Next
    Next
    Call GoToMuGang()
End Function

/**战斗**/
Function AttackNavy()
    Call LJ_FindPicByRect("提督_舰队状态_可以出击",107,579,122,594)
    If (FoundPic = 0) Then 
        TracePrint "舰队没有准备完毕"
    End If
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
	/*选择出击地图*/
    Call LJ_PointAddAndClick(AttackMapPosition, AttackMapIndex * AttackMapPositionOffset, 0)
    Delay 1000
	/*选择出击关卡*/
    Call LJ_PointAddAndClick(AttackMisstionPosition,AttackMisstionXIndex * AttackMisstionPositionOffsetX,AttackMisstionYIndex * AttackMisstionPositionOffsetY)
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPic("出击_出击_出击开始_disable")
    If (FoundPic = 0) Then 
        Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
        Call Fighting()
        Call LJ_DeleyForNet()
    End If
End Function
Function Fighting()
    FightingRound = 0
    Do
        Call LJ_FindPicAndClick("战斗_战斗中_指南针")
        Call LJ_FindPic("战斗_地图_2_2_boss")
        If (FoundPic = 1) Then 
            Call RefreshGame()
        End If
        Call LJ_FindPicAndClick ("战斗_战斗中_阵形_复k阵")
        Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1	
            End If
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
            Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
            If (FoundPic = 1) Then 
                ShipWasDestroyed = 1
                FightingRound = 999//不在继续战斗
            End If
        End If
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function














/**********************************************************控制提督很忙**********************************************************/











Function TD_RefreshGame()
    Call setHwndByTidu()
    Call LJ_PointGetAndClick("30|840")
    Call LJ_PointGetAndClick("130|590")
    Call LJ_PointGetAndClick("770|590")
    Call LJ_FindPicAndClick("提督_设置")
    Call setHwndByGame()
End Function

/**检查远征是否就绪**/
Function TD_CheckExpedition()
    Do
        Call setHwndByTidu()
        Call LJ_FindPic("提督_远征_第二舰队_准备就绪1")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Call LJ_FindPic("提督_远征_第二舰队_准备就绪2")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Call LJ_FindPic("提督_远征_第三舰队_准备就绪1")
        If (FoundPic = 1) Then 
            Call TD_BackToMuGang()
            Exit Function
        End If
        Delay 5000
    loop While (True)
End Function

Function TD_BackToMuGang()
    Call setHwndByGame()
    Call GoToMuGang()
End Function














/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(HwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    HwndGame = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    Call setHwndByGame()
    If (Hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
    Call Plugin.Window.SetClientSize(HwndTidu, 800, 1000)
    TracePrint "HwndTidu:" & HwndTidu
    TracePrint "HwndGame:" & HwndGame
    TracePrint "Hwnd:" & Hwnd
End Function
Function setHwndByGame()
    Hwnd = HwndGame
    TracePrint "Hwnd Game Hwnd:" & Hwnd
    ScreenHeight = 480
    ScreenWidth = 800
    PicDefinition = 0.9
End Function
Function setHwndByTidu()
    TracePrint "Hwnd Tidu Hwnd:" & Hwnd
    Hwnd = HwndTidu
    ScreenHeight = 1000
    ScreenWidth = 800
    PicDefinition = 1.0
End Function

/**第三方库查找图片**/
Function Lib_FindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, 0, 0, ScreenWidth, ScreenHeight, resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function
Function Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call Lib_FindPic(picName)
    If X > - 1  Then //找到了
        TracePrint "LJ_FindPic:" & picName & " FoundPic = true"
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            TracePrint "LJ_FindPic:" & picName & " FoundPic = false"
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    If X <= - 1  Then 
        Exit Function
    End If
    TracePrint "LJ_LeftClickOnXY x:" & X & " Y :" & Y
    If (Y < 800) Then 
        Call Plugin.Bkgnd.LeftClick(Hwnd, X, Y)
    Else 
        Call Plugin.Bkgnd.LeftClick(HwndTidu, X, Y)
    End If
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim ZuoBiao
    ZuoBiao = InStr(XY, "|")
    X = Clng(Left(XY, ZuoBiao - 1)) : Y = Clng(Right(XY, Len(XY) - ZuoBiao))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

Function LJ_DeleyForNet()
    Delay 5000
End Function
