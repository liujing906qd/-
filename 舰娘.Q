[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=1ea4e81b-f045-449e-81b4-25c7ad71afbb
Description=舰娘
Enable=0
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]
记得停止睡眠模式

[UIPackage]
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


[Script]
//开关
Dimenv AutoSupply,AutoRepair,AutoExpedition,AutoAttack,AutoChangeShip

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

//远征舰队
Dimenv Expedition_Navy2_Enable, Expedition_Navy3_Enable, Expedition_Navy4_Enable
//远征舰队对应任务ID
DimEnv ExpeditionMisstionID_Navy2, ExpeditionMisstionID_Navy3, ExpeditionMisstionID_Navy4

//出击地图
DimEnv AttackMisstionXIndex,AttackMisstionYIndex,AttackMapIndex
//出击状态
DimEnv AttackNightFight,AttackFightRound

//换船
Dimenv ChangeShipPageCount, ChangeShipLineNumber


//自动补给开关
Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply_When_Attack_Before.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply_When_Expedition_Before.Value = Form.CB_AutoSupply.Value
End Event
//自动入渠开关
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
    Form.CB_Repair_Dapo.Value = Form.CB_AutoRepair.Value
    Form.CB_Repair_ZhongPo.Value = 0
    Form.CB_Repair_XiaoPo.Value = 0
    Form.CB_Repair_Navy_1.Value = Form.CB_AutoRepair.Value
End Event
//自动远征开关
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
    Form.CB_Supply_CheckOil.Value = Form.CB_AutoExpedition.Value
End Event
//自动攻击开关
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
    //    Form.CB_Attack_When_DaPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_When_DaPo.Value = 0
    Form.CB_Attack_When_ZhongPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_When_XiaoPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_Suppy.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_CheckOil.Value = Form.CB_AutoAttack.Value
End Event
//结束自动换船开关
Event Form.CB_AutoChangeShip.Click
    AutoChangeShip = Form.CB_AutoChangeShip.Value
End Event


//大破出击开关
Event Form.CB_Attack_When_DaPo.Click
    If (Form.CB_Attack_When_DaPo.Value = 1) Then 
        MessageBox "警告，这极有可能导致舰船沉没！请确认了解该情况会导致的后果！"
    End If
End Event

//出击地图
Event Form.CB_Attack_MapLevel.SelectChange
    AttackMapIndex = Form.CB_Attack_MapLevel.ListIndex
End Event
//出击关卡
Event Form.CB_Attack_MissionLevel.SelectChange
    AttackMisstionXIndex = Form.CB_Attack_MissionLevel.ListIndex mod 2
    AttackMisstionYIndex = Int(Form.CB_Attack_MissionLevel.ListIndex / 2)
End Event
//是否进击回合次数
Event Form.CB_AttackNightFight.Click
    AttackNightFight = Form.CB_AttackNightFight.Value
End Event
//是否夜战
Event Form.CB_AttackFightRound.SelectChange
    AttackFightRound = Form.CB_AttackFightRound.ListIndex
End Event

//设置第几舰队远征
Event Form.CB_Expedition_Navy2_Enable.Click
    Expedition_Navy2_Enable = Form.CB_Expedition_Navy2_Enable.Value
    Form.CB_Supply2.Value = Form.CB_Expedition_Navy2_Enable.Value
    Form.CB_AutoSupply.Value =1
End Event
Event Form.CB_Expedition_Navy3_Enable.Click
    Expedition_Navy3_Enable = Form.CB_Expedition_Navy3_Enable.Value
    Form.CB_Supply3.Value = Form.CB_Expedition_Navy3_Enable.Value
    Form.CB_AutoSupply.Value = 1
End Event
Event Form.CB_Expedition_Navy4_Enable.Click
    Expedition_Navy4_Enable = Form.CB_Expedition_Navy4_Enable.Value
    Form.CB_Supply4.Value = Form.CB_Expedition_Navy4_Enable.Value
    Form.CB_AutoSupply.Value = 1
End Event
//设置远征地图
Event Form.CB_Expedition_Missionevel_Navy2.SelectChange
    ExpeditionMisstionID_Navy2 = Form.CB_Expedition_Missionevel_Navy2.ListIndex
End Event
Event Form.CB_Expedition_Missionevel_Navy3.SelectChange
    ExpeditionMisstionID_Navy3 = Form.CB_Expedition_Missionevel_Navy3.ListIndex
End Event
Event Form.CB_Expedition_Missionevel_Navy4.SelectChange
    ExpeditionMisstionID_Navy4 = Form.CB_Expedition_Missionevel_Navy4.ListIndex
End Event

//出击后强制补给
Event Form.CB_Attack_Suppy.Click
    Form.CB_Supply1.Value = Form.CB_Attack_Suppy.Value
    Form.CB_AutoSupply.Value = 1
End Event
/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"
DimEnv ChangeShipIDArrayIndex










/*****************************设置常量*****************************/
//远征舰队坐标
Const ExpeditionNavyPosition = "356|120"
Const ExpeditionNavyPositionOffset = 30
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMisstionPosition = "160|170"
Const ExpeditionMisstionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//列表类型坐标
Const TypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMisstionPosition = "280|200"
Const AttackMisstionPositionOffsetX = 350
Const AttackMisstionPositionOffsetY = 150
//出击的特殊地图坐标
Const AttackMisstionPositionOfSpecial = "710|260"

//换船接触除了旗舰以外的船坐标
Const ChangeShipWithOutFlagPosition = "420|120"
Const ChangeShipPagePosition = "520|450"
Const ChangeShipPagePositionOffset = 30
Const ChangeShipListPosition = "470|170"
Const ChangeShipListPositionOffset = 30
Const ChangeShipBackToFirstPagePosition = "440|450"
Const ChangeShipJumpPageToNext5Position = "680|450"
Const ChangeShipListNavyPosition = "130|120"

/**********************************************************初始化变量**********************************************************/
X = -1 
Y = - 1 
//攻击阵形坐标数组
AttackFormationPositionArray = Array("450|185","480|185","710|185","510|375","640|185")






















/**********************************************************提督很忙**********************************************************/


















/*****************************远征*****************************/
Function TD_Expedition()
    Call setHwndByGame()
    Call GoToMuGang()
    If (Form.CB_Supply_When_Expedition_Before.Value = 1) Then 
        Call SupplyNavy()
    End If
    Call ExpeditionNavy()
End Function

/****************************出击****************************/
Function TD_Attack()
    Call setHwndByGame()
    Call GoToMuGang()
    If (Form.CB_Supply_When_Attack_Before.Value = 1) Then 
        Call SupplyNavy()
    End If
    Call AttackNavy()
End Function


/**检查远征是否就绪**/
Function TD_CheckTiDu()
    Do
        Call setHwndByTidu()
        
        Rem 远征判断
        If (Form.CB_AutoExpedition.Value = 1) Then 
        	

            Call LJ_FindPic("提督_综合_远征_第二舰队_准备就绪1")
            If (Form.CB_Expedition_Navy2_Enable.Value = 1 and FoundPic = 1) Then 
                Call TD_Expedition()
                Exit Function
            End If
            Call LJ_FindPic("提督_综合_远征_第二舰队_准备就绪2")
            If (Form.CB_Expedition_Navy2_Enable.Value = 1 and FoundPic = 1) Then 
                Call TD_Expedition()
                Exit Function
            End If
            Call LJ_FindPic("提督_综合_远征_第三舰队_准备就绪1")
            If (Form.CB_Expedition_Navy3_Enable.Value = 1 and FoundPic = 1) Then 
                Call TD_Expedition()
                Exit Function
            End If
            Call LJ_FindPic("提督_综合_远征_第三舰队_准备就绪2")
            If (Form.CB_Expedition_Navy3_Enable.Value = 1 and FoundPic = 1) Then 
                Call TD_Expedition()
                Exit Function
            End If
        Else 
            TracePrint "远征没有开启"
        End If
        Rem 远征结束
        
        Rem 入渠开始判断	
        If (Form.CB_Repair_Dapo.Value = 1) Then 
            TracePrint "按照入渠设置，检测是否大破"
            Call LJ_FindPic("提督_综合_舰队列表_HP_大破")
            If (FoundPic = 1) Then 
                TracePrint "按照出击设置，检测是否大破：是"
                Call RepairNavy()
                Call ChangeNavy()
                Goto 入渠结束判断
            Else 
                TracePrint "按照入渠设置，检测是否大破：否"
            End If
        Else 
            TracePrint "按照入渠设置，不检测是否大破"
        End If
        If (Form.CB_Repair_ZhongPo.Value = 1) Then 
            TracePrint "按照入渠设置，检测是否中破"
            Call LJ_FindPic("提督_综合_舰队列表_HP_中破")
            If (FoundPic = 1) Then 
                TracePrint "按照出击设置，检测是否中破：是"
                Call RepairNavy()
                Call ChangeNavy()
                Goto 入渠结束判断
            Else 
                TracePrint "按照出击设置，检测是否中破：否"
            End If
        Else 
            TracePrint "按照入渠设置，不检测是否中破"
        End If
            
        If (Form.CB_Repair_XiaoPo.Value = 1) Then 
            TracePrint "按照入渠设置，检测是否小破"
            Call LJ_FindPic("提督_综合_舰队列表_HP_小破")
            If (FoundPic = 1) Then 
                TracePrint "按照出击设置，检测是否小破：是！"
                Call RepairNavy()
                Call ChangeNavy()
                Goto 入渠结束判断
            Else 
                TracePrint "按照出击设置，检测是否小破：否"
            End If
        Else
            TracePrint "按照入渠设置，不检测是否小破"
        End If
        Rem 入渠结束判断
        
        Rem 进击判断
        If (AutoAttack = 1) Then 
            If (Form.CB_Attack_When_DaPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否大破"
            Else 
                Call LJ_FindPic("提督_综合_舰队列表_HP_大破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否大破：是 取消出击！"
                    Call RepairNavy()
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否大破：否"
                End If
            End If
            If (Form.CB_Attack_When_ZhongPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否中破"
            Else 
                Call LJ_FindPic("提督_综合_舰队列表_HP_中破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否中破：是 取消出击！"
                    Call RepairNavy() 
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否中破：否"
                End If
            End If
            If (Form.CB_Attack_When_XiaoPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否小破"
            Else
                Call LJ_FindPic("提督_综合_舰队列表_HP_小破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否小破：是 取消出击！"
                    Call RepairNavy()
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否小破：否"
                End If
            End If
            Call LJ_FindPic("提督_综合_舰队列表_入渠中")
            If (FoundPic = 1) Then 
                TracePrint "当前舰队有船只正在入渠"
                If (AutoChangeShip = 1) Then 
                    Call ChangeNavy()
                    Exit Function
                End If
                Goto 进击结束
            End If
            TracePrint "AutoAttack:" & AutoAttack
            If (AutoAttack = 1) Then 
                If (Form.CB_Attack_CheckCondition.Value = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_可以出击")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_疲劳回复好了")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_疲劳回复时间到了")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_6只疲劳49")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_6只疲劳40以上")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPicByRect("提督_综合_舰队列表_舰队状态_可以出击",103,572,130,604)
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
            End If
        End If
        Rem 进击结束
        TracePrint "进击结束"
        Delay 5000
    loop While (True)
End Function

Function TD_RefreshGame()
    Call setHwndByTidu()
    Call LJ_PointGetAndClick("30|840")
    Call LJ_PointGetAndClick("130|590")
    Call LJ_PointGetAndClick("770|590")
    Call LJ_FindPicAndClick("提督_设置")
    Call setHwndByGame()
End Function
































//**********************************************************逻辑**********************************************************/
Do
/****************************初始化****************************/
    Call GetHwndForGame()
    //Call AttackChangeNavy()
    Call TD_CheckTiDu()
    ///****************************远征结束*****************************/
    //Call GoToMuGang()
    ///*****************************补给*****************************/
    //TracePrint "AutoSupply:" & AutoSupply
    //If (AutoSupply = 1) Then 
    //    Call SupplyNavy()
    //End If
    ///*****************************入渠*****************************/
    //TracePrint "AutoRepair:" & AutoRepair
    //If (AutoRepair = 1) Then 
    //    Call RepairNavy()
    //End If
    ///*****************************远征*****************************/
    //TracePrint "AutoExpedition:" & AutoExpedition
    //If (AutoExpedition = 1) Then 
    //    Call ExpeditionNavy()
    //End If
    ///****************************出击****************************/
    //TracePrint "AutoAttack:" & AutoAttack
    //If (AutoAttack = 1) Then 
    //    Call AttackNavy()
    //End If
    ///*****************************补给*****************************/
    //If (AutoSupply = 1) Then 
    //    Call SupplyNavy()
    //End If
    ///*****************************入渠*****************************/
    //If (AutoRepair = 1) Then 
    //    Call RepairNavy()
    //End If
    ///*****************************结束*****************************/
    //Call TD_CheckExpedition()
    Delay 1000
Loop While(1=1)




















/**********************************************************函数**********************************************************/





























/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    Call setHwndByGame()
    //回到母港
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
    
    Do While(FoundPic = 1)
        //每次回港都直接检查远征
        Call LJ_FindPic("远征_结束_开始")
        If (FoundPic = 1) Then 
            TracePrint "发现远征结束舰队"
            Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
            Call LJ_DeleyForNet()
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPic("远征_结束_开始")
            isExpeditionFinish = True
        End If
    Loop
    If (isExpeditionFinish) Then 
        isExpeditionFinish = False
        Call SupplyNavy()
    End If
End Function
Function GoToScene(SceneName)
    Call setHwndByGame()
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*远征主逻辑*/
Function ExpeditionNavy()
    TracePrint "AutoExpedition:" & AutoExpedition
    Call setHwndByGame()
    If (AutoExpedition = 0) Then 
        Exit Function
    End If
    
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    
    If (Expedition_Navy2_Enable = 1) Then 
        Call ExpeditionSelectMapByMisstionID(ExpeditionMisstionID_Navy2,1)	
    End If
    If (Expedition_Navy3_Enable = 1) Then 
        Call ExpeditionSelectMapByMisstionID(ExpeditionMisstionID_Navy3,2)	
    End If
    If (Expedition_Navy4_Enable = 1) Then 
        Call ExpeditionSelectMapByMisstionID(ExpeditionMisstionID_Navy4,3)	
    End If
    
    If (Form.CB_Supply_CheckOil.Value = 1) Then 
        If (CheckOilAndAmmo() = false) Then 
            TracePrint NavyNumber & "舰队在执行任务" & ExpeditionMisstionID + 1  & "时缺油或弹药"
            Call SupplyNavy()
            Exit Function
        End If
    End If
    
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
    
    Call GoToMuGang()
End Function

/*选择远征地图*/
Function ExpeditionSelectMapByMisstionID(ExpeditionMisstionID,NavyNumber)
    //远征地图下标
    ExpeditionMapIndex = ExpeditionMisstionID / 8
    TracePrint "ExpeditionMapIndex:" & ExpeditionMapIndex
    //远征任务下标
    ExpeditionMisstionIndex = ExpeditionMisstionID mod 8
    TracePrint "ExpeditionMisstionIndex:" & ExpeditionMisstionIndex
    
    /*选择远征地图*/
    Call LJ_PointAddAndClick(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
	/*选择远征关卡*/
    Call LJ_PointAddAndClick(ExpeditionMisstionPosition,0,ExpeditionMisstionIndex * ExpeditionMisstionPositionOffset)

    Call LJ_FindPic("出击_远征_远征中止")
    If (FoundPic = 1) Then //如果远征正在执行，则退出
        TracePrint "第" & NavyNumber + 1 & "舰队已经在执行远征任务"
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_PointAddAndClick(ExpeditionNavyPosition, NavyNumber * ExpeditionNavyPositionOffset, 0)
    
    If (Form.CB_Attack_CheckOil.Value = 1) Then 
        Call LJ_FindPic("远征_结束_舰队_缺油")
        If (FoundPic = 1) Then 
            Call LJ_FindPic("远征_结束_舰队_缺弹药")
            If (FoundPic = 1) Then 
                TracePrint NavyNumber & "舰队在执行任务" & ExpeditionMisstionID + 1  & "时缺油"
                Call SupplyNavy()
                Exit Function
            End If
            
        End If
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
End Function

Function CheckOilAndAmmo()
    Call LJ_FindPic("远征_结束_舰队_缺油")
    If (FoundPic = 1) Then 
        CheckOilAndAmmo = False
        Exit Function
    End If
    
    Call LJ_FindPic("远征_结束_舰队_缺弹药")
    If (FoundPic = 1) Then 
        CheckOilAndAmmo = False
        Exit Function
    End If
    CheckOilAndAmmo = True
End Function

/*补给主逻辑*/
Function SupplyNavy()
    TracePrint "AutoSupply:" & AutoSupply
    Call setHwndByGame()
    If (AutoSupply = 0) Then 
        Exit Function
    End If
    Call GoToMuGang()
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    For index = 0 To 3
        If (index = 0) Then 
            If (Form.CB_Supply1.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 1) Then 
            If (Form.CB_Supply2.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 2) Then 
            If (Form.CB_Supply3.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 3) Then 
            If (Form.CB_Supply4.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_FindPic("补给_补给列表_全选框")
        If (FoundPic = 1) Then 
            TracePrint "补给第" & index+1 &"舰队时，使用全选框"
            Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
            Call LJ_FindPic("补给_补给列表_确定补给_disable")
            If (FoundPic = 0) Then 
                TracePrint "不能补给，第" & index+1 &"舰队"
                Call LJ_FindPicAndClick("补给_补给列表_确定补给")
                Call LJ_DeleyForNet()
            End If
        End If
        Rem 下一个补给舰队
    Next
    Call GoToMuGang()
End Function

/*入渠主逻辑*/
Function RepairNavy()
    TracePrint "AutoRepair:" & AutoRepair
    Call setHwndByGame()
    If (AutoRepair = 0) Then 
        Exit Function
    End If
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    
    Dim FlagShipIsRepayed
    FlagShipIsRepayed = 0
    Dim RepairedX, RepairedY
    RepairedX = 0
    RepairedY = 0
    IsRepayed = 0
    For index = 0 To 3
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_空位")
        //确定船只
        For index = 0 To 9
            TracePrint "正在判断第" & index+1 &"艘舰"
            If (Form.CB_Repair_Navy_1.Value = 1) Then 
                Call LJ_FindPicByRect("入渠_维修列表_第一舰队", X, Y, 800, 480)
            End If
            If (FoundPic = 1) Then 
                TracePrint "找到第一舰队 x:" & X & " Y:" &Y
                IsRepayed = RepairFindShip(X, Y)
            End If
            If (IsRepayed = 0) Then 
                Call LJ_FindPicAndClick("入渠_维修列表_入渠开始")
                Call LJ_FindPicAndClick("入渠_维修列表_维修开始_确定维修")
                Call LJ_FindPicAndClick("入渠_维修列表_空位_详情返回")
                Call LJ_FindPicAndClick("入渠_维修列表_空位_列表返回")
            End If
        Next
    Next
    Call GoToMuGang()
End Function

Function RepairFindShip(RepairedX,RepairedY)
    RepairedYStart = RepairedY - 10
    RepairedYEnd = RepairedY + 30
    If (Form.CB_Repair_XiaoPo.Value = 1) Then 
        TracePrint"小破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_小破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_ZhongPo.Value = 1) Then 
        TracePrint"中破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_中破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_DaPo.Value = 1) Then 
        TracePrint"大破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_大破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    Call LJ_FindPicByRect("入渠_战斗状态_修复", RepairedX, RepairedYStart, 800,RepairedYEnd)
    If (FoundPic = 1) Then 
        RepairedX = RepairedX + 0
        RepairedY = RepairedY + 25
        RepairFindShip = 0
    End If
    
End Function

/**战斗**/
Function AttackNavy()
    Call setHwndByGame()
    TracePrint "AutoAttack:" & AutoAttack
    If (AutoAttack = 0) Then 
        Exit Function
    End If
    If (Form.CB_Attack_Limit_Count.Value = 1 and Int(Form.Label_Attack_Index.Caption) > Int(Form.IB_Attack_Limit_Count.Text)) Then 
        TracePrint "当前出击次数超过用户设置的最大次数，停止出击" & Form.Label_Attack_Index.Caption &" "& Int(Form.IB_Attack_Limit_Count.Text)
        Exit Function
    End If
    Form.Label_Attack_Index.Caption = Int(Form.Label_Attack_Index.Caption) + 1
        
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
	/*选择出击地图*/
    If (Form.CB_Attack_MissionLevel.ListIndex < 4) Then 
        Call LJ_PointAddAndClick(AttackMapPosition, AttackMapIndex * AttackMapPositionOffset, 0)
    Else 
        Call LJ_PointGetAndClick(AttackMisstionPositionOfSpecial)
        Delay 2000
        Call LJ_PointGetAndClick(AttackMisstionPositionOfSpecial)
    End If
    Delay 1000
	/*选择出击关卡*/
    Call LJ_PointAddAndClick(AttackMisstionPosition,AttackMisstionXIndex * AttackMisstionPositionOffsetX,AttackMisstionYIndex * AttackMisstionPositionOffsetY)
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    
    
    If (Form.CB_Supply_CheckOil.Value = 1) Then 
        If (CheckOilAndAmmo() = false) Then 
            TracePrint NavyNumber & "舰队在执行任务" & ExpeditionMisstionID + 1  & "时缺油或弹药"
            Call SupplyNavy()
            Exit Function
        End If
    End If
    
    Call LJ_FindPic("出击_出击_出击开始_disable")
    If (FoundPic = 0) Then 
        Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
        Call Fighting()
        Call LJ_DeleyForNet()
    End If
End Function
//战斗中
Function Fighting()
    FightingRound = 0
    Timeout = 0
    Do
        Call LJ_FindPicAndClick("战斗_战斗中_指南针")
        
        Call LJ_PointGetAndClick(AttackFormationPositionArray(Form.CB_Attack_Formation.ListIndex))
        
        If (AttackNightFight = 1) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_追击")
        End If
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1
                TracePrint "当前战斗回合数：" & FightingRound & " 总攻击回合数：" & AttackFightRound
            End If
        Else 
            TracePrint "当前战斗回合数：" & FightingRound & " 总攻击回合数：" & AttackFightRound
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
            TracePrint "战斗结束，判断舰船是否大破"
            Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
            If (FoundPic = 1) Then 
                TracePrint "检测到舰船大破，不在继续进击"
                ShipWasDestroyed = 1
                FightingRound = 999//不在继续战斗
            End If
        End If
        Call LJ_FindPicAndClick("进击_结束_评价_继续")
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
        Timeout = Timeout + 1000
        If (Timeout >= 300000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function
//换船
Function ChangeNavy()
    TracePrint "AutoChangeShip:" & AutoChangeShip
    If (AutoChangeShip = 0) Then 
        Exit Function
    End If
    //舰船更换ID
    Call ChangeNavyUpdate()
    Call GoToScene("编成")
    Call LJ_PointGetAndClick(ChangeShipListNavyPosition)
    Call LJ_PointGetAndClick(ChangeShipListNavyPosition)
    Call LJ_PointGetAndClick(ChangeShipWithOutFlagPosition)
    Call LJ_FindPicUntilFoundThenClick("编成_列表_变更")
    Call LJ_DeleyForNet()
    //更换旗舰
    Call LJ_ClickUntilChangeTo(TypePosition, "编成_列表_类型_船只")
    //初始化页数
    Call LJ_PointGetAndClick(ChangeShipBackToFirstPagePosition)
    Call LJ_PointAddAndClick(ChangeShipPagePosition, ChangeShipPagePositionOffset * 2, 0)
    For index = 0 To ChangeShipPageCount /5 - 1 
        Call LJ_PointGetAndClick(ChangeShipJumpPageToNext5Position)
    Next
    Call LJ_PointAddAndClick(ChangeShipPagePosition, ChangeShipPagePositionOffset * (ChangeShipPageCount mod 5), 0)
    Delay 1000
    Call LJ_PointAddAndClick(ChangeShipListPosition, 0, ChangeShipListPositionOffset * ChangeShipLineNumber)
    Delay 1000
    Call LJ_FindPic("编成_列表_确定变更_disable")
    If (FoundPic = 0) Then 
        Call LJ_FindPicUntilFoundThenClick("编成_列表_确定变更")
    Else 
        ChangeShipIDArrayIndex = ChangeShipIDArrayIndex + 1
        Call ChangeNavy()
    End If
End Function
Function ChangeNavyUpdate()
    ChangeShipIDArray = Split(Form.IB_ChangeShipIDs.Text, "|", - 1 , 1)
    
    Dim ShipID
    ShipID = ChangeShipIDArray(ChangeShipIDArrayIndex)
    PageCount = Int(ShipID  / 10)
    LineIndex = Int(ShipID mod 10)
    //换船页数
    ChangeShipPageCount = pageCount - 1
    //换船行数
    ChangeShipLineNumber = LineIndex
    ChangeShipIDArrayIndex = ChangeShipIDArrayIndex + 1
    TracePrint "ChangeShipIDArrayIndex:" &　ChangeShipIDArrayIndex
End Function













































/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(HwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    HwndGame = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    Call setHwndByGame()
    If (Hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
    Call Plugin.Window.SetClientSize(HwndTidu, 800, 1000)
    TracePrint "HwndTidu:" & HwndTidu
    TracePrint "HwndGame:" & HwndGame
    TracePrint "Hwnd:" & Hwnd
End Function
Function setHwndByGame()
    Hwnd = HwndGame
    TracePrint "Hwnd Game Hwnd:" & Hwnd
    ScreenHeight = 480
    ScreenWidth = 800
    PicDefinition = 0.9
End Function
Function setHwndByTidu()
    TracePrint "Hwnd Tidu Hwnd:" & Hwnd
    Hwnd = HwndTidu
    ScreenHeight = 1000
    ScreenWidth = 800
    PicDefinition = 1.0
End Function

/**第三方库查找图片**/
Function Lib_FindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, 0, 0, ScreenWidth, ScreenHeight, resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function
Function Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call Lib_FindPic(picName)
    If X > - 1  Then //找到了
        TracePrint "LJ_FindPic:" & picName & " FoundPic = true"
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            TracePrint "LJ_FindPic:" & picName & " FoundPic = false"
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    If X <= - 1  Then 
        Exit Function
    End If
    TracePrint "LJ_LeftClickOnXY x:" & X & " Y :" & Y
    If (Y < 800) Then 
        Call Plugin.Bkgnd.LeftClick(Hwnd, X, Y)
    Else 
        Call Plugin.Bkgnd.LeftClick(HwndTidu, X, Y)
    End If
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim ZuoBiao
    ZuoBiao = InStr(XY, "|")
    X = Clng(Left(XY, ZuoBiao - 1)) : Y = Clng(Right(XY, Len(XY) - ZuoBiao))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

/**点击坐标，直到出现图片**/
Function LJ_ClickUntilChangeTo(Position,PicName)
    Dim Timeout
    Timeout = 0
    Call LJ_FindPic(PicName)
    Do While (FoundPic = 0)
        Call LJ_PointGetAndClick(Position)
        Delay 100
        Call LJ_FindPic(PicName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop
End Function

Function LJ_DeleyForNet()
    Delay 5000
End Function
