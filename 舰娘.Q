[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=2a66429a-f8d4-4300-b6ee-02f792c0369c
Description=舰娘
Enable=1
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]
记得停止睡眠模式

[UIPackage]
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


[Script]
Dimenv AutoSupply
Dimenv AutoRepair
Dimenv AutoExpedition
Dimenv AutoAttack

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply1.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply2.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply3.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply4.Value = Form.CB_AutoSupply.Value
End Event
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
    Form.CB_Repair_Dapo.Value = Form.CB_AutoRepair.Value
    Form.CB_Repair_ZhongPo.Value = 0
    Form.CB_Repair_XiaoPo.Value = 0
End Event
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
End Event
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
    //    Form.CB_Attack_When_DaPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_When_DaPo.Value = 0
    Form.CB_Attack_When_ZhongPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_When_XiaoPo.Value = Form.CB_AutoAttack.Value
End Event

Event Form.CB_Attack_When_DaPo.Click
    If (Form.CB_Attack_When_DaPo.Value = 1) Then 
        MessageBox "警告，这极有可能导致舰船沉没！请确认了解该情况会导致的后果！"
    End If
End Event

Event Form.CB_MapLevel.SelectChange
    AttackMapIndex = Form.CB_MapLevel.ListIndex
End Event
Event Form.CB_MissionLevel.SelectChange
    //	= Form.CB_MissionLevel.ListIndex
End Event
Event Form.CB_Atatck_MissionLevel.SelectChange

End Event



/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"

ExpeditionNavyMisstion1ID = 2
ExpeditionNavyMisstion2ID = 4

//出击地图下标
AttackMapIndex = 1
//出击任务下标X
AttackMisstionXIndex = 1
//出击任务下标Y
AttackMisstionYIndex = 1
AttackNightFight = 0
AttackFightRound = 0

//补给舰队下标最大值
SupplyNavyMax = 2
/*****************************设置常量*****************************/
//远征舰队坐标
Const ExpeditionNavyPosition = "356|120"
Const ExpeditionNavyPositionOffset = 30
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMisstionPosition = "160|170"
Const ExpeditionMisstionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//入渠类型坐标
Const RepairTypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMisstionPosition = "280|200"
Const AttackMisstionPositionOffsetX = 350
Const AttackMisstionPositionOffsetY = 150
/**********************************************************初始化变量**********************************************************/
X = -1 
Y = - 1 

ShipWasDestroyed = 0














//**********************************************************逻辑**********************************************************/

/****************************初始化****************************/
Call GetHwndForGame()
TracePrint "Form.CB_Supply1.Value:" & Form.CB_Supply1.Value
Call TD_CheckTiDu()
///****************************远征结束*****************************/
//Call GoToMuGang()
///*****************************补给*****************************/
//TracePrint "AutoSupply:" & AutoSupply
//If (AutoSupply = 1) Then 
//    Call SupplyNavy()
//End If
///*****************************入渠*****************************/
//TracePrint "AutoRepair:" & AutoRepair
//If (AutoRepair = 1) Then 
//    Call RepairNavy()
//End If
///*****************************远征*****************************/
//TracePrint "AutoExpedition:" & AutoExpedition
//If (AutoExpedition = 1) Then 
//    Call ExpeditionNavy()
//End If
///****************************出击****************************/
//TracePrint "AutoAttack:" & AutoAttack
//If (AutoAttack = 1) Then 
//    Call AttackNavy()
//End If
///*****************************补给*****************************/
//If (AutoSupply = 1) Then 
//    Call SupplyNavy()
//End If
///*****************************入渠*****************************/
//If (AutoRepair = 1) Then 
//    Call RepairNavy()
//End If
///*****************************结束*****************************/
//Call TD_CheckExpedition()
























/**********************************************************函数**********************************************************/








/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    //回到母港
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
    Do
        //每次回港都直接检查远征
        Call LJ_FindPic("远征_结束_开始")
        If (FoundPic = 1) Then 
            TracePrint "发现远征结束舰队"
            Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
            Call LJ_DeleyForNet()
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPic("远征_结束_开始")
        End If
    Loop While(FoundPic = 1)
End Function
Function GoToScene(SceneName)
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*远征主逻辑*/
Function ExpeditionNavy()
    TracePrint "AutoExpedition:" & AutoExpedition
    If (AutoExpedition = 0) Then 
        Exit Function
    End If
    
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    
    Call ExpeditionSelectMapByMisstionID(ExpeditionNavyMisstion1ID,1)
    Call ExpeditionSelectMapByMisstionID(ExpeditionNavyMisstion2ID,2)
    
    Call LJ_DeleyForNet()
    
    Call GoToMuGang()
End Function

/*选择远征地图*/
Function ExpeditionSelectMapByMisstionID(ExpeditionMisstionID,NavyNumber)
    //远征地图下标
    ExpeditionMapIndex = ExpeditionMisstionID / 8
    TracePrint "ExpeditionMapIndex:" & ExpeditionMapIndex
    //远征任务下标
    ExpeditionMisstionIndex = ExpeditionMisstionID mod 8
    TracePrint "ExpeditionMisstionIndex:" & ExpeditionMisstionIndex
    
    /*选择远征地图*/
    Call LJ_PointAddAndClick(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
	/*选择远征关卡*/
    Call LJ_PointAddAndClick(ExpeditionMisstionPosition,0,ExpeditionMisstionIndex * ExpeditionMisstionPositionOffset)

    Call LJ_FindPic("出击_远征_远征中止")
    If (FoundPic = 1) Then //如果远征正在执行，则退出
        TracePrint "第" & NavyNumber & "舰队已经在执行远征任务"
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_PointAddAndClick(ExpeditionNavyPosition, NavyNumber * ExpeditionNavyPositionOffset, 0)
    Call LJ_FindPic("远征_结束_舰队_缺油")
    If (FoundPic = 1) Then 
        TracePrint NavyNumber & "舰队在执行任务" & ExpeditionMisstionID + 1  & "时缺油"
        Call SupplyNavy()
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
End Function

/*补给主逻辑*/
Function SupplyNavy()
    TracePrint "AutoSupply:" & AutoSupply
    If (AutoSupply = 0) Then 
        Exit Function
    End If
    Call GoToMuGang()
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    For index = 0 To SupplyNavyMax
        If (index = 0) Then 
            If (Form.CB_Supply1.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 1) Then 
            If (Form.CB_Supply2.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 2) Then 
            If (Form.CB_Supply3.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 3) Then 
            If (Form.CB_Supply4.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_FindPic("补给_补给列表_全选框")
        If (FoundPic = 1) Then 
            TracePrint "补给第" & index+1 &"舰队时，使用全选框"
            Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
            Call LJ_FindPic("补给_补给列表_确定补给_disable")
            If (FoundPic = 0) Then 
                TracePrint "不能补给，第" & index+1 &"舰队"
                Call LJ_FindPicAndClick("补给_补给列表_确定补给")
                Call LJ_DeleyForNet()
            End If
        End If
        Rem 下一个补给舰队
    Next
End Function

/*入渠主逻辑*/
Function RepairNavy()
    TracePrint "AutoRepair:" & AutoRepair
    If (AutoRepair = 0) Then 
        Exit Function
    End If
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    
    Dim FlagShipIsRepayed
    FlagShipIsRepayed = 0
    Dim RepairedX, RepairedY
    RepairedX = 0
    RepairedY = 0
    IsRepayed = 0
    For index = 0 To 3
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_空位")
        
        //        Dim Timeout
        //        Timeout = 0
        //        Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //        Do While (FoundPic = 0)
        //            Call LJ_PointGetAndClick(RepairTypePosition)
        //            Delay 100
        //            Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //            Delay 100
        //            Timeout = Timeout + 100
        //            If (Timeout >= 5000) Then 
        //                Exit Function
        //            End If
        //        Loop
        //确定船只
        For index = 0 To 9
            TracePrint "正在判断第" & index+1 &"艘舰"
            If (Form.CB_Repair_Navy_1.Value = 1) Then 
                Call LJ_FindPicByRect("入渠_维修列表_第一舰队", X, Y, 800, 480)
            End If
            If (FoundPic = 1) Then 
                TracePrint "找到第一舰队 x:" & X & " Y:" &Y
                IsRepayed = RepairFindShip(X, Y)
            End If
            If (IsRepayed = 0) Then 
                Call LJ_FindPicAndClick("入渠_维修列表_入渠开始")
                Call LJ_FindPicAndClick("入渠_维修列表_维修开始_确定维修")
                Call LJ_FindPicAndClick("入渠_维修列表_空位_详情返回")
                Call LJ_FindPicAndClick("入渠_维修列表_空位_列表返回")
            End If
        Next
    Next
    Call GoToMuGang()
End Function

Function RepairFindShip(RepairedX,RepairedY)
    RepairedYStart = RepairedY - 10
    RepairedYEnd = RepairedY + 30
    If (Form.CB_Repair_XiaoPo.Value = 1) Then 
        TracePrint"小破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_小破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_ZhongPo.Value = 1) Then 
        TracePrint"中破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_中破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_DaPo.Value = 1) Then 
        TracePrint"大破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_大破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    Call LJ_FindPicByRect("入渠_战斗状态_修复", RepairedX, RepairedYStart, 800,RepairedYEnd)
    If (FoundPic = 1) Then 
        RepairedX = RepairedX + 0
        RepairedY = RepairedY + 25
        RepairFindShip = 0
    End If
    
End Function

/**战斗**/
Function AttackNavy()
    If (AutoAttack = 0) Then 
        Exit Function
    End If
    Call LJ_FindPicByRect("提督_舰队状态_可以出击",107,579,122,594)
    If (FoundPic = 0) Then 
        TracePrint "舰队没有准备完毕"
    End If
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
	/*选择出击地图*/
    Call LJ_PointAddAndClick(AttackMapPosition, AttackMapIndex * AttackMapPositionOffset, 0)
    Delay 1000
	/*选择出击关卡*/
    Call LJ_PointAddAndClick(AttackMisstionPosition,AttackMisstionXIndex * AttackMisstionPositionOffsetX,AttackMisstionYIndex * AttackMisstionPositionOffsetY)
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPic("出击_出击_出击开始_disable")
    If (FoundPic = 0) Then 
        Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
        Call Fighting()
        Call LJ_DeleyForNet()
    End If
End Function
Function Fighting()
    FightingRound = 0
    Do
        Call LJ_FindPicAndClick("战斗_战斗中_指南针")
        Call LJ_FindPicAndClick("战斗_战斗中_阵形_复k阵")
        If (AttackNightFight = 1) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_追击")
        End If
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1
                TracePrint "当前战斗回合数：" & FightingRound & " 总攻击回合数：" & AttackFightRound
            End If
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
        	TracePrint "战斗结束，判断舰船是否大破"
            Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
            If (FoundPic = 1) Then 
            	TracePrint "检测到舰船大破，不在继续进击"
                ShipWasDestroyed = 1
                FightingRound = 999//不在继续战斗
            End If
        End If
        Call LJ_FindPicAndClick("进击_结束_评价_继续")
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function














/**********************************************************控制提督很忙**********************************************************/











Function TD_RefreshGame()
    Call setHwndByTidu()
    Call LJ_PointGetAndClick("30|840")
    Call LJ_PointGetAndClick("130|590")
    Call LJ_PointGetAndClick("770|590")
    Call LJ_FindPicAndClick("提督_设置")
    Call setHwndByGame()
End Function

Function TD_BackToMuGang()
    Call setHwndByGame()
    Call GoToMuGang()
End Function

Function TD_Supply()
    Call setHwndByGame()
    TracePrint "AutoSupply:" & AutoSupply
    Call SupplyNavy()
End Function

///*****************************入渠*****************************/
Function TD_Repair()
    Call setHwndByGame()
    TracePrint "AutoRepair:" & AutoRepair
    If (AutoRepair = 1) Then 
        Call RepairNavy()
    End If
End Function

/*****************************远征*****************************/
Function TD_Expedition()
    Call setHwndByGame()
    Call SupplyNavy()
    TracePrint "AutoExpedition:" & AutoExpedition
    Call ExpeditionNavy()
End Function

/****************************出击****************************/
Function TD_Attack()
    Call setHwndByGame()
    Call GoToMuGang()
    Call SupplyNavy()
    Call RepairNavy()
    Call AttackNavy()
End Function


/**检查远征是否就绪**/
Function TD_CheckTiDu()
    Do
        Call setHwndByTidu()
        
        Rem 远征判断
        Call LJ_FindPic("提督_综合_远征_第二舰队_准备就绪1")
        If (FoundPic = 1) Then 
            Call TD_Expedition()
            Exit Function
        End If
        Call LJ_FindPic("提督_综合_远征_第二舰队_准备就绪2")
        If (FoundPic = 1) Then 
            Call TD_Expedition()
            Exit Function
        End If
        Call LJ_FindPic("提督_综合_远征_第三舰队_准备就绪1")
        If (FoundPic = 1) Then 
            Call TD_Expedition()
            Exit Function
        End If
        Call LJ_FindPic("提督_综合_远征_第三舰队_准备就绪2")
        If (FoundPic = 1) Then 
            Call TD_Expedition()
            Exit Function
        End If
        Rem 远征结束
        
        Rem 进击判断
        If (AutoAttack = 1) Then 
            Call LJ_FindPic("提督_综合_舰队列表_HP_大破")
            If (Form.CB_Attack_When_DaPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否大破"
            Else 
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否大破：是 取消出击！"
                    Call TD_Repair()
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否大破：否"
                End If
            End If
            If (Form.CB_Attack_When_ZhongPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否中破"
            Else 
                Call LJ_FindPic("提督_综合_舰队列表_HP_中破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否中破：是 取消出击！"
                    Call TD_Repair() 
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否中破：否"
                End If
            End If
            If (Form.CB_Attack_When_XiaoPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否小破"
            Else
                Call LJ_FindPic("提督_综合_舰队列表_HP_小破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否小破：是 取消出击！"
                    Call TD_Repair()
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否小破：否"
                End If
            End If
            Call LJ_FindPic("提督_综合_舰队列表_入渠中")
            If (FoundPic = 1) Then 
                TracePrint "当前舰队有船只正在入渠"
                Goto 进击结束
            End If
            TracePrint "AutoAttack:" & AutoAttack
            If (AutoAttack = 1) Then 
                Call LJ_FindPic("提督_综合_舰队列表_可以出击")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_疲劳回复完毕")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_6只疲劳49")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_6只疲劳40以上")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
            End If
        End If
        Rem 进击结束
        TracePrint "进击结束"
        
        Delay 5000
    loop While (True)
End Function













/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(HwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    HwndGame = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    Call setHwndByGame()
    If (Hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
    Call Plugin.Window.SetClientSize(HwndTidu, 800, 1000)
    TracePrint "HwndTidu:" & HwndTidu
    TracePrint "HwndGame:" & HwndGame
    TracePrint "Hwnd:" & Hwnd
End Function
Function setHwndByGame()
    Hwnd = HwndGame
    TracePrint "Hwnd Game Hwnd:" & Hwnd
    ScreenHeight = 480
    ScreenWidth = 800
    PicDefinition = 0.9
End Function
Function setHwndByTidu()
    TracePrint "Hwnd Tidu Hwnd:" & Hwnd
    Hwnd = HwndTidu
    ScreenHeight = 1000
    ScreenWidth = 800
    PicDefinition = 1.0
End Function

/**第三方库查找图片**/
Function Lib_FindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, 0, 0, ScreenWidth, ScreenHeight, resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function
Function Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call Lib_FindPic(picName)
    If X > - 1  Then //找到了
        TracePrint "LJ_FindPic:" & picName & " FoundPic = true"
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            //            TracePrint "LJ_FindPic:" & picName & " FoundPic = false"
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    If X <= - 1  Then 
        Exit Function
    End If
    TracePrint "LJ_LeftClickOnXY x:" & X & " Y :" & Y
    If (Y < 800) Then 
        Call Plugin.Bkgnd.LeftClick(Hwnd, X, Y)
    Else 
        Call Plugin.Bkgnd.LeftClick(HwndTidu, X, Y)
    End If
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim ZuoBiao
    ZuoBiao = InStr(XY, "|")
    X = Clng(Left(XY, ZuoBiao - 1)) : Y = Clng(Right(XY, Len(XY) - ZuoBiao))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

Function LJ_DeleyForNet()
    Delay 5000
End Function