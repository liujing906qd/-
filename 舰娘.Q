[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=c0ac3c71-3249-4d6f-ae63-2f2425773c90
Description=舰娘
Enable=1
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Dimenv AutoSupply
Dimenv AutoRepair
Dimenv AutoExpedition
Dimenv AutoAttack

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply1.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply2.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply3.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply4.Value = Form.CB_AutoSupply.Value
End Event
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
End Event
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
End Event
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
End Event


/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"

//远征地图下标
Dim ExpeditionMapIndex
ExpeditionMapIndex = 0
//远征任务下标
Dim ExpeditionMisstionIndex
ExpeditionMisstionIndex = 4

//出击地图下标
Dim AttackMapIndex
AttackMapIndex = 1
//出击任务下标X
Dim AttackMisstionXIndex
AttackMisstionXIndex = 1
//出击任务下标Y
Dim AttackMisstionYIndex
AttackMisstionYIndex = 0
Dim AttackNightFight
AttackNightFight = 1
Dim AttackFightRound
AttackFightRound = 0

//补给舰队下标最大值
Dim SupplyNavyMax
SupplyNavyMax = 1
/*****************************设置常量*****************************/
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMisstionPosition = "160|170"
Const ExpeditionMisstionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//入渠类型坐标
Const RepairTypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMisstionPosition = "280|200"
Const AttackMisstionPositionOffsetX = 350
Const AttackMisstionPositionOffsetY = 150
/**********************************************************初始化变量**********************************************************/
Dim X, Y
X = -1 
Y = - 1 
Dim ShipWasDestroyed
ShipWasDestroyed = 0





//**********************************************************逻辑**********************************************************/
/****************************初始化****************************/
Call GetHwndForGame()
/****************************远征结束*****************************/
Call GoToMuGang()
Call LJ_FindPic("远征_结束_开始")
If (FoundPic = 1) Then 
    Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
    Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
    Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
End If
/*****************************补给*****************************/
If (AutoSupply = 1) Then 
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
If (AutoRepair = 1) Then 
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    Call RepairNavy()
End If
/*****************************远征*****************************/
If (AutoExpedition = 1) Then 
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    Call SelectExpeditionMap()
    Call SelectExpeditionMisstion()
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
    Call GoToMuGang()
End If
/****************************出击****************************/
If (AutoAttack = 1) Then 
    If (ShipWasDestroyed = 1) Then 
        MessageBox "舰船大破无法出击，脚本中止。请修理后在启动脚本"
        EndScript
    End If
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
    Call SelectAttackMap()
    Call SelectAttackMisstion()
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
    Call Fighting()
    Call LJ_DeleyForNet()
End If
/*****************************补给*****************************/
If (AutoSupply = 1) Then 
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
If (AutoRepair = 1) Then 
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    Call RepairNavy()
End If
/*****************************结束*****************************/
Delay 600000










/**********************************************************函数**********************************************************/
/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
End Function
Function GoToScene(SceneName)
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*选择远征地图*/
Function SelectExpeditionMap()
    Call LJ_PointAdd(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
    Call LJ_LeftClickOnXY()
End Function
/*选择远征关卡*/
Function SelectExpeditionMisstion()
    Call LJ_PointAdd(ExpeditionMisstionPosition,0,ExpeditionMisstionIndex * ExpeditionMisstionPositionOffset)
    Call LJ_LeftClickOnXY()
End Function

/*选择补给舰队*/
Function SupplyNavy()
    For index = 0 To SupplyNavyMax
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
        Call LJ_FindPicAndClick("补给_补给列表_确定补给")
        Call LJ_DeleyForNet()
    Next
End Function

/*入渠*/
Function RepairNavy()
    Dim FlagShipIsRepayed
    FlagShipIsRepayed = 0
    Dim RepairedX, RepairedY
    RepairedX = 0
    RepairedY = 0
    For index = 0 To 3
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_空位")
        
        //        Dim Timeout
        //        Timeout = 0
        //        Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //        Do While (FoundPic = 0)
        //            Call LJ_PointGetAndClick(RepairTypePosition)
        //            Delay 100
        //            Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //            Delay 100
        //            Timeout = Timeout + 100
        //            If (Timeout >= 5000) Then 
        //                Exit Function
        //            End If
        //        Loop
        //确定船只
        For index = 0 To 9
//            Call LJ_FindPicByRect("入渠_维修列表_第一舰队附舰",RepairedX,RepairedY,800,480)
//            If (FoundPic = 1) Then 
                RepairedX = X
                RepairedY = Y
                Call LJ_FindPicByRect("入渠_战斗状态_小破", RepairedX, RepairedY, 800,480)
                Call LJ_LeftClickOnXY()
                Call LJ_FindPicByRect("入渠_战斗状态_中破", RepairedX, RepairedY, 800,480)
                Call LJ_LeftClickOnXY()
                Call LJ_FindPicByRect("入渠_战斗状态_大破", RepairedX, RepairedY, 800,480)
                Call LJ_LeftClickOnXY()
                Call LJ_FindPicByRect("入渠_战斗状态_修复", RepairedX, RepairedY, 800,480)
                If (FoundPic = 1) Then 
                    RepairedX = RepairedX + 0
                    RepairedY = RepairedY + 25
                    Goto IsRepayed
                End If
//            End If
            Call LJ_FindPicAndClick("入渠_维修列表_入渠开始")
            Call LJ_FindPicAndClick("入渠_维修列表_维修开始_确定维修")
            Call LJ_FindPicAndClick("入渠_维修列表_空位_详情返回")
            Call LJ_FindPicAndClick("入渠_维修列表_空位_列表返回")
            Rem IsRepayed
        Next
    Next
    Call GoToMuGang()
End Function

/*选择出击地图*/
Function SelectAttackMap()
    Call LJ_PointAdd(AttackMapPosition,AttackMapIndex * AttackMapPositionOffset,0)
    Call LJ_LeftClickOnXY()
End Function
/*选择出击关卡*/
Function SelectAttackMisstion()
    Call LJ_PointAdd(AttackMisstionPosition,AttackMisstionXIndex * AttackMisstionPositionOffsetX,AttackMisstionYIndex * AttackMisstionPositionOffsetY)
    Call LJ_LeftClickOnXY()
End Function

Function Fighting()
    FightingRound = 0
    Do
        Call LJ_FindPicAndClick ("战斗_战斗中_指南针")
        Call LJ_FindPicAndClick ("战斗_战斗中_阵形_复k阵")
        Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1	
            End If
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
            Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
            If (FoundPic = 1) Then 
                ShipWasDestroyed = 1
                FightingRound = 999//不在继续战斗
            End If
        End If
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function










/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndTidu,HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(hwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    hwnd = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    If (hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
End Function
/**第三方库查找图片**/
Function LiebFindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(hwnd, 0, 0, 800, 480, resourceFolder & picName & ".bmp", 50, 0.9, X, Y)
End Function
Function LiebFindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, 0.9, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call LiebFindPic(picName)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call LiebFindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call LiebFindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call LiebFindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    If X <= - 1  Then 
        Exit Function
    End If
    Call Plugin.Bkgnd.LeftClick(hwnd, X, Y)
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim zb
    ZB = InStr(XY, "|")
    X = Clng(Left(XY, ZB - 1)) : Y = Clng(Right(XY, Len(XY) - ZB))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

Function LJ_DeleyForNet()
    Delay 5000
End Function
