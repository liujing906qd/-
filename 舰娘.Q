[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=c0ac3c71-3249-4d6f-ae63-2f2425773c90
Description=舰娘
Enable=0
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
UEsDBBQAAgAIAHi8PEbpcR68xRUAAAhOAQAJABEAVUlQYWNrYWdlVVQNAAcwcslUMHLJVDByyVTtXQl4FdUVPhO2sIVNKCBLWFRAQcjCDpqEIIGExCQgixBCCBAJSUzCqiCigIrIorgrqLjWulSlrrW2Vm2trXWldtO2tla7oK1LF6DnvJlnJiSp79x7Xk5efJfv/yYJb+6Z8+bOmf8/596ZFuC2V3/W5d3bHu79HhzXJkMLOHqsLbT2/S0G4QR/6ez+3hJx9NixY8E/b0Ici7aIaUcQdA6TEHSuWyHaINohYhFtEe0RHREdEHHuqYdOiC6IrohuiO6IExA9ED0R30D0QpyI6I3og+iH6IvojxiAiEcMRAxGDEKchDgFcTJiCOJUxFDEMMRpiBGI4YjTEaMQIxEJiGREImI0YjliLGIMYhxiAmI8YmJgTANMQpyBSEGciUhFpCPSEFMQUxHTEGchMhAzENMRmYiZiCxENuJsRA4iFzELkYfIR8xGzEGcg5iLmI+YhzgXsRCxAFGAKEQsQixGFCOKEEsQSxEliGWI8xA3I0oRKxArEeWIMkQFogpxPqISUY1YjViFWINYh1iLWI+4EHEBYgPiIsRGxMWISwLHX47/qvFcpGO/1djXOuC0HjhigmPJ+YrP7v/kmX1tJrzqtKA4Uez+bRZ+yyPBvMWC4wTtr23gM5sOuHaD9v3/l4ZnLdPiCNr57Lf6CvvBrf//8vH7rsARMBNHxEooZtvvCjEB+528uBvqfi29LcVuLcR7cWCgd/0P9mKA5jF93TC1vHKlxeUHtvs7YNds97dtjz70k/dHKdo/fPiw1f6mcacm/sXU4nuhnrNg/KG7TiHeBUsNjyEO4x/xkzaM+Bfjsz8b77ZVCNMj6Iz2O0AN5w1lnxY++7lotRDv/Nn4PZQy773B+N8aXL4Wqv2WPvv5aH9tgD0Yn3+He/5beaCWhuyjFFFpeCQnGNhv7fO/xn4qnoeiAM9i2g+cz7aM77/Ncee/yPL7J24ey7AfCy6H97cFeFF8DJHXPqvf58BtISsvPq+wrCo+r7iyZGmY7OcXLk4rL6uuLC813r8grbzSOADb3v/mYeSpxPhTHFAR/BZnEP/b+sZ/Jl57/Kuu9viP8/oL1X47n/2paL/M7vpj+0/3q4nezykYfUpQ7ZUF7sJlJvGPbb9DrfhH+meUhf+OQ/dT4u3dGvhMUPfsejk8+qcf8O6/Hb0xQE2D/9B4jfV+luA/lGfpyRj/nUCW//Rmfv+dQZb/UN6pC8P/LiDKf9jn358vleI/gxj+d/X5r62fbJut/qFGOVDiP58a7KutX235jwT/pdxvf8b46way/JdyzH0Z9k+AGv6rwX+6gyz/6eNd06Ha7wG6/IdqA0H+k4G2i/EOXGVovwP6T/4MYPjf03f+89B6qTcGiwMZeF7rauB/L/Dff+juH7z2aq7GUFtv9J++z8EM/3v77MdA7JMvv/r8s4feeqHlGwff/BwaudnGb4n4r9m6Wu5PY7lTWmpBVkZeXkb2zMz02emZgWsc/5aSn5KfNqPOf7VNm5aeNiM1e87oL8dflfEI7GMw/k/0jb88vO7WGbPfwPXPtt+nzvVXFbgLlHgKrBBREoiLX93iDez3rcf+NLRNOnA5Mxb3MLDfD2rnv1yfS3BLEZAXkfth/IkHt4YTqn3iCludoH3SnwnG499ffxvSwGeCujNc+pNsJzP8p/p2UP9p6E+qsXcM/vJlNBhT67ekWr8lB1z1hZSUnLrhJHASu9CHZuVnp8/JSZ+SkY9xp9ZnEmv9Fkg7tM5MSU3PDNhrhzvnzcrJyZw7qvavCbV/Taz9a1JNN4k1Pwb26egdTm56TkpGrv8vKfn5KWlU3Yf2FD59DgU/4XZOf4kLdFi/12Pt4nfa8uKiFanla433x2NdVV2et6qionSdwf4S+QealzGMMf6HgGj+gT3+h4Js/oFG2nCG/8NAvv6SxLBP82raej9Hev317TcOPvjtJx7/YrySfVv+SdqFrh8KAFMM9o+xPH6p/FMiY/ydBrL1t5O9PkO1Pxxk8w8jvWsqVPsjQDf/cDrI5h/oZn0Kw/+RoJt/oOOd+OX4Wx4YASuM1L+b/6bvcyjD/wSoG/9zjdi/Wf0nEeTyv9r110jPXwvxv5Tq6sIik6tYQ38n+cafRv0zGY6vfyZaxB/HoVhOc37HNfCZxtCfUxnxh/I+mvqTlGZQf0roD5rPPYHh/1jQ1R/jQFZ/0Nz1yQz/x4Nc/G8K/P+Rz576XMu+BP+/F1z+/6zC8Uvpz3TG+Jvgiz9S+mMKw/5EkNUfFM8mMexPAln9keL5FKr9yaCrP84AWf1Ba3jGMvw/E3T1R/B8uePPXn+QP+MZ/qdClP83lSbE/3OLKwpLTK5gDf2ZBrr1vymgqz/S4Xj9kWQRf2rqX9Mb+Exj6I9zGPGHtIqm/qC1nZL6g9aBZjL8nwa6+iMDmhf/f+mjF49q2Zfg/3Tt0A3AZCFdC8vjl9CftO45mzH+p4N8/Ws2w/4MkNcfsxj2M0FWf1A8mcmwnwWy+iPX6zNU+zNBV39kg6z+oLX/GQz/c0BXf9CzC4L6I8r/dVtm4eLiUtv9C7IKKzKLV5t0JKE/aTzNYIz/XNCtf+WBrv7IB139MQuO1x/JFvHHcYhP03NX5jfwmcbQH8WM8UdcIbj+WEN/EN+L836W0B/0LJkFDP/nQPPh/48deuXpO57Us2/L/+m+uA2xE3Gtwf5dLI9fYv0fPcNoGWP8zQXZ+hc9W2kRw/480H3+AcXJ4HPVpPTHUob/54Ks/qDzWcCwvwBk9Qc9O2shw/5C0NUfBSCrP5Z4YzpU+4ug+eT/tZsIfzdf/mB9/jT0J/EVzecfLAZ//K/E4ynDe2AFbivZx9DTwH4R+Pn/KrRXjjqkBNab8V+2/SVwPP8fbXH+a+oPDUWxxuD/qxjxj6xo8n+KhcH7vwT/p2dArmT4vwxkn/9Ad841DPvLQZb/UfytYNgvAV3+dx7I87/VDP9XQNN5/sMTh569J5L1G83ZIv32AZjpt+6Wx297/iT4P11P5YzxVwqy/J9WqpYx7K8EXf5fBrL8v9qLKaHaLwfd+gPFak3+dz7o8r9K0OV/VT77Uf0moN/Mlw+o519d/j/G4vp3HFIP/wb3GeP1tcbg/1sY8Y+ub03+T1pFkv/Ts9w3MPxfDbL8fzO4HChU+2tAlv/T8+03MeyvBV3+vw7k+f9Whv/rff7btuZQf3kI3PqLyfqLXpbH3xye/0bj+SLG+LsAZPk/vcdiI8P+haDL/zeALP+/1LumQ7W/EXT5P40VTf6/CXT5/8Wgy/83Q9N4/0cU+oAIb9brZ7z9TZ+AHenzZ1z9Z/4QK3/9Z3sDn2kM/Xc94/5HfEFz/Qndr4PPX5LQf7txu4Ph/xbQXX+yFWT1314aYwz/t4G8/ruOYf8ykF9/cC3D/uU+/x9757Wnnrn94Ota8cdWv/XDaHI3bqsdM/3WzvL4I33+jIT+o/G0kzH+rgBZ/Xc1bq9i2N8OuvrvSpDVf9d432mo9neArv6jcyW5/n2P952Gan8n6K4/2AW66w92Q/N5/4NI/cZ8+XXE83+N/MseOH7+2TiL+OM4xKfoGTo3N3S9NYL+uIsRf+h+pVl/ovuFZP3pdtzeyvB/L8jWn+7A7T0M+9eCrP64Bbe3MexfB7r1p+t95785zL+i+s0HYMb/+1oef/Ph/3b6827G+L8BZNef3Ijb/Qz7N4Ks/jiA230M+zeBrv64GWT1x52eT6HavwV09QfdqzTrT/tAt/60H+Tq/9bxR+b5V+lrK4qXlFSXlJcx928Oz7+xeW+TRv3xNqj7/tGRhsffwVd/uL+BzzQG/3+CEf+IL2vWH4gvB9cNS/D/b+P2AYb/B0C3/nAnyPL/g7h9mOH/XSDP/x9n2L8b5OsP32HYvwdk+d994GqAUO3fC7L871HcPsiwfx/o8r9vgtz9X+L5Z5vAnZNpsn4m0t+/CsrHL8H/H/PGVKjj737Q5f/fAtn6wyNen6HafwB06w8Pgm794SHQff7Rw1CXf44y9t9xKJ/xDuKZBj7TGPzzx4zxR3wtFppGk5q/ZboEJ+Kff/TOS0ds5m9o6A+Kl5Lzn34Abu43VPuPgq7+eAxk9ceLuP0+w/+DIK8/fsSw/x2Q1x8vMew/DrL64yncPsew/wTI6o8f4vZ7DPtPQo3+sG22/P9xb/5WXIxZ/aaD5fF/3fm/hv58CmTrDy/g9mnG+H8adPUH8URJ/fE8br/L8P+7oKs/ngVd/fE90NUfz0Fd/ZFg7H9N/vunDXzm/+kP7ZZWvnJxuWX9p7qwumhFQVZJVVVJeRnzOciRzv9tm4T+/IUXe0Id/8RVNesfpBd6eD9L6I83cPsqhB5/nwfZ+U9vMr//H4Ks/vgZbl9n+P8CyOuPQwz7/nVvUvqD8/2/CLL64ye4fY3h/0s++7ZLAD8Et54RZ7j+ordl/NLm763AGeUkOIlOkmP0EPVjlifANn8moT/fwu3PGb78CHTrXz8GWf3xNm5fYfj/MujqD4oXQf2RgbaL8Q5cZWjfhH+/AjW6PQ+tl3pj0EQBmcw/+SnU5d+Jxv47Dp3PjxC/buAzjZH//5Ax/uh+rcm/iCtJ5n9/j9vfMvz/Oejmf18DWf71J9z+juH/6/7x790/TPVn5NdPDh6N5PWvK7z86XOG/EuKf/+ZMf7eAPn8/wcM+2+CLP/+JW7fY9h/C2Tz/+/j9l2G/bdBl38dAln+9Ufc/orh/y9Al3/RXAHJ/O8fcPsbhv+/9Pnf3jJ+Rd8fp9ts86ca+f9fgW7+/9egm///DdTVH0nG/tfk///WwGfCrT/+Bbz8I3F1Tf3xLqKT97OE/vgnbg9D6PH3PZDN/37K/P5/5x9/qYaFE6H4GenxVyJ/Ss8DpPypyfznrpbHL6E//47bfzDG/+9BPv//BURO/v8PIKs//oLbTxj+vw+y+uMz3H7MsP9H0NUffwJZ/UGL7/7K8P8D0NUfpNWbyvuf1esncvMPjN7BrH3/1Mj/fwi6+f+PoC7/Tjb23wnMpxyPJ+JIA58JN/+OdXj8j+4Xmvz7r1DDWyT4dwvynxEL/gay/Lsl8/v/O8jm/4/iNsYJ3f/D0HTW/9vyZ3qWHM0/oDUtJvnvHpbHr33/bO27fzoGr3GU4t9tnMjh3x+DLP/+D50whv+fgCz/buW4IyZU+/8AXf79T5Dl363R9/9C6P5/Crr8m/SS5vyLzwPnzW0a/OsLqMu/Rhv7X5P/7NBAMA7yrv2fhG/+RS/G9Uf5Uk3+Re/qCs6/0J5/FtzfNP8d+fMPXn5ec/6BBP/u6rj5y1DH0n9Ad/7Nf0GWf/dA37sw/D8C8vnPnhz+BfLzL77BsH8MZPlXO7TdmWGfLnpJ/nUC9teJYZ+4oib/inGi7/+JwoXt/LNWMe78s/mG63c7Wt6/ovNP7JqE/uqOTrRnxL8Wjq7+onyd5PyrbthfR4b/rRzd9betHd35N20c3fk3sU5d/TnG2H/HaYv9DUX0beBiDurOcOnPIcz8Mx2v1PN/BOpnZoUzofj5dZ9/opF/IL4enHcqoT8HYX/9GfG3vSNb/xnMvP46OLL6k96BNZDhf0dHXn+eEkH5/zhHVn+eiP0NYPjfSVh/noT9xTPsd/bpT6qf0fwzqp+ZzD+Ls4xfkV4/ayr5U9P5Cxr5hy6ObP3nZOyvD2P8d1XWH90c3foP5as06z/d6+HfY439r6n/nKbEv8n2OMb46+Ho1n8oVyu5/jYB+xvB8L+no5v/7yXMv0Zjf6MY/vcOA/8ay7B/om/8RX79LPLfX7sR3PfXmvCvfpbHL8W/xzDGXx9h/j0M+xvJsN9XmH8nYX+nM+z3U67/9BfmX8nY36kM/+OV+dcA4fxvIvY3nOH/QOX87yBH7v2v0fW7dk1K/5nOn9LI/w9Wzv+fVI/+GGfsv+MQnzsXMUlRf0xnxJ+TlfXHKcL6Iw37O4Ph/xBl/TFUWH+chf2lMvwfJhj/I/39B7ZN4vnnxP/p+ecm/D/e8vil9GcGY/yd6sjPP5vGsH+asP6YgP2lMOwPF9Yf6djfmQz7I5T1x+nC+mMq8XmG/yOV9ccoYf0xBfubzPA/Icr/m0yT4v+m81c09Gei8vyjJGX9kVxHfySIvP92pqL+mM+IP6OV9ccYYf2Rj/3lMPwfq6w/xjUr/h/5z+8k/v+cYf6/v+XxH8Exsxm3lyK2IrYgtiEuR1yGuAKxA7EdcSW480V2IXYidiOuRuxBXAPu8e9FXIegdyJej7gRcQviJsSt4M792Y/bfeC+B5zeRU3vwz7g/d+d3jbaGqdJ5B/m4NjNY8S/8WGof85j2J8QBv05l2F/orD+zMT+chn2Jwnrz9nY39kM+5OV9ecZwvrzHOwvi+H/mcr6M8VpOs9/sm1R/efubzp/SiL/MAtPQjZj/Kcq1z/TlPXnFGX9mV6P/rR5//UM4rCIAkX9WcoYf1OV9edZwvqzGPsrZPg/rVnpP93nJ0isnyX9N9+w/jPA8vg18g8ZwvXPEuxvCWP8Tw+D/ljBsD8jDPrjPIb9TGH9sQD7K2LYzxLWH8uwv8UM+zOV9Ue2sP5Yjv0tZPifE63/NJlmzf9TC/JWVVSUrjMkcBr682zh+udS7G8RY/znKuuPPGX9ka+sP2bVoz8k3n9doag/NjDG32xl/UH5qnbezxL6YzX2V8nwf45y/WuuMP9cj/2tYvg/Lwz880KG/fnR9T9izVb/ES8agXga6F7MbwMtj19Kf1zAGH/nCuuPMsddPxWq/QXC+mMt9lfFsL9QWX8UCOuPddhfOcP/Rcr1j0Jh/rkG+zuf4f9iZf5ZFNV/TaaJ6T/DF1hr6I8lyvqjuB79YfH+b1iJ/e1EXKyoP65ixJ+lyvpjmbD+2Ib9XcLwf7my/igR1h/bsb+tDP/Pi67/EWu2/J++QOL/lBMw4f+DLY9fSn/uYIy/FWGof1zJsF8qrD8uwv62MOyvFNYfl2N/lzLslynrj3Jh/XEF9reJ4X+Fsv44X1h/XIb9bWb4Xxnl/02mifF/wwS6hv6sUq5/VCvrj1X16A/b93/vxz73KOqPfYz4s1pZf6wR1h/XY3/XMPxfq6w/1kXX/4g1W/7/CLj8v60h/x9kefwS+vNmPPbrGON/fRjqX7cy7F8QBv1xC8P+hcL6YxetHWPY3yCsP27E/vYy7G9U1h8XCeuPm7C/3Qz/Nynrj4t9+iNc75WJtshoUf2n28T0n6GAkMg/3IAn4WpG/NusXP+8RFl/XqqsP7fUoz+Tjf13vrR/h6L+fIgx/rYq689twvrzXuzvTob/l0XX/4g1W/2X5dV/7jDUfydZHr9G/uFy4frnt7C/exjj/4ow6M8HGfa3h0F/PsCwf6Ww/rwN+7ubYX+HsP78JvZ3F8P+Vcr6c6ew/rwf+7ud4f+uaP0n2rymkX/YLVz/vA/7O8AY/3uU9cfVyvrjGmX9sddnX6Jx7Uu3SLb/P1BLAQIXCxQAAgAIAHi8PEbpcR68xRUAAAhOAQAJAAkAAAAAAAAAAAAAgAAAAABVSVBhY2thZ2VVVAUABzByyVRQSwUGAAAAAAEAAQBAAAAA/RUAAAAA


[Script]
Dimenv AutoSupply
Dimenv AutoRepair
Dimenv AutoExpedition
Dimenv AutoAttack

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
End Event
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
End Event
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
End Event
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
End Event

Event Form.CB_Supply1.Click
	 
End Event
Event Form.CB_Supply2.Click

End Event
Event Form.CB_Supply3.Click

End Event
Event Form.CB_Supply4.Click

End Event


/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"

//远征地图下标
Dim ExpeditionMapIndex
ExpeditionMapIndex = 0
//远征任务下标
Dim ExpeditionMisstionIndex
ExpeditionMisstionIndex = 4

//出击地图下标
Dim AttackMapIndex
AttackMapIndex = 0
//出击任务下标X
Dim AttackMisstionXIndex
AttackMisstionXIndex = 0
//出击任务下标Y
Dim AttackMisstionYIndex
AttackMisstionYIndex = 0

//补给舰队下标最大值
Dim SupplyNavyMax
SupplyNavyMax = 1
/*****************************设置常量*****************************/
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMisstionPosition = "160|170"
Const ExpeditionMisstionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//入渠类型坐标
Const RepairTypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMisstionPosition = "280|200"
Const AttackMisstionPositionOffsetX = 350
Const AttackMisstionPositionOffsetY = 150
/**********************************************************初始化变量**********************************************************/
Dim X, Y
X = -1 
Y = -1
//**********************************************************逻辑**********************************************************/
/****************************初始化****************************/
Call GetHwndForGame()
/****************************远征结束*****************************/
Call GoToMuGang()
Call LJ_FindPic("远征_结束_开始")
If (FoundPic = 1) Then 
    Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
    Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
    Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
End If
/*****************************补给*****************************/
If (AutoSupply = 1) Then 
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    Call SupplyNavy()
End If
/*****************************入渠*****************************/
If (AutoRepair = 1) Then 
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    Call RepairNavy()
End If
/*****************************远征*****************************/
If (AutoExpedition = 1) Then 
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    Call SelectExpeditionMap()
    Delay 1000
    Call SelectExpeditionMisstion()
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call GoToMuGang()
    Call LJ_DeleyForNet()
End If
/****************************出击****************************/
If (AutoAttack = 1) Then 
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
    Call SelectAttackMap()
    Call SelectAttackMisstion()
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
    Call Fighting()
    Call LJ_DeleyForNet()
End If
/*****************************结束*****************************/
Delay 600000
/**********************************************************函数**********************************************************/
/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
End Function
Function GoToScene(SceneName)
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*选择远征地图*/
Function SelectExpeditionMap()
    Call LJ_PointAdd(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
    Call LJ_LeftClickOnXY()
End Function
/*选择远征关卡*/
Function SelectExpeditionMisstion()
    Call LJ_PointAdd(ExpeditionMisstionPosition,0,ExpeditionMisstionIndex * ExpeditionMisstionPositionOffset)
    Call LJ_LeftClickOnXY()
End Function

/*选择补给舰队*/
Function SupplyNavy()
    For index = 0 To SupplyNavyMax
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
        Call LJ_FindPicUntilFoundThenClick("补给_补给列表_确定补给")
        Call LJ_DeleyForNet()
    Next
End Function

/*入渠*/
Function RepairNavy()
    For index = 0 To 3
        Call LJ_PointAddAndClick(RepairEmptyPosition, 0, index * RepairEmptyPositionOffset)
        
        Dim Timeout
        Timeout = 0
        Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        Do While (FoundPic = 0)
            Call LJ_PointGetAndClick(RepairTypePosition)
            Delay 100
            Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
            Delay 100
            Timeout = Timeout + 100
            If (Timeout >= 20000) Then 
                Exit Function
            End If
        Loop
        //确定船只
        Call LJ_PointAdd(RepairNavyPosition,0,index * RepairNavyPositionOffset)
        Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_入渠开始")
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_维修开始_确定维修")
    Next
End Function

/*选择出击地图*/
Function SelectAttackMap()
    Call LJ_PointAdd(AttackMapPosition,AttackMapIndex * AttackMapPositionOffset,0)
    Call LJ_LeftClickOnXY()
End Function
/*选择出击关卡*/
Function SelectAttackMisstion()
    Call LJ_PointAdd(AttackMisstionPosition,AttackMisstionXIndex * AttackMisstionPositionOffsetX,AttackMisstionYIndex * AttackMisstionPositionOffsetY)
    Call LJ_LeftClickOnXY()
End Function

Function Fighting()
    Do
        Call LJ_FindPicAndClick ("战斗_战斗中_指南针")
        Call LJ_FindPicAndClick ("战斗_战斗中_阵形_复k阵")
        Call LJ_FindPicAndClick ("战斗_战斗中_脱离判定_夜战")
        Call LJ_FindPicAndClick ("战斗_战斗中_回合结束_撤退")
        Call LJ_FindPicAndClick ("战斗_结束_评价_战果报告")
        Call LJ_FindPicAndClick ("出击_结束_评价_旗舰大破")
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function
/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndTidu,HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(hwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    hwnd = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    If (hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
End Function
/**第三方库查找图片**/
Function LiebFindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(hwnd, 0, 0, 800, 480, resourceFolder & picName & ".bmp", 50, 0.9, X, Y)
End Function
/**查找图片**/
Function LJ_FindPic(picName)
    Call LiebFindPic(picName)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call LiebFindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    Call Plugin.Bkgnd.LeftClick(hwnd, X, Y)
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim zb
    ZB = InStr(XY, "|")
    X = Clng(Left(XY, ZB - 1)) : Y = Clng(Right(XY, Len(XY) - ZB))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

Function LJ_DeleyForNet()
    Delay 5000
End Function