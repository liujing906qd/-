[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=95e24638-ebe4-4b30-a8c2-108fa17c7b07
Description=舰娘
Enable=0
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]
记得停止睡眠模式

[UIPackage]
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


[Script]
//开关
Dimenv AutoSupply,AutoRepair,AutoExpedition,AutoAttack,AutoChangeShip

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

//远征舰队
Dimenv Expedition_Navy2_Enable, Expedition_Navy3_Enable, Expedition_Navy4_Enable
//远征舰队对应任务ID
DimEnv ExpeditionMissionID_Navy2, ExpeditionMissionID_Navy3, ExpeditionMissionID_Navy4

//出击状态
DimEnv AttackNightFight,AttackFightRound

//换船
Dimenv ChangeShipPageCount, ChangeShipLineNumber


//自动补给开关
Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply_When_Attack_Before.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply_When_Expedition_Before.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply_Sort.Value = Form.CB_AutoSupply.Value
    Form.CB_Repair_WeiPo.Value = Form.CB_AutoSupply.Value
End Event
//自动入渠开关
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
    Form.CB_Repair_Dapo.Value = Form.CB_AutoRepair.Value
    Form.CB_Repair_ZhongPo.Value = 0
    Form.CB_Repair_XiaoPo.Value = 0
    Form.CB_Repair_Navy_1.Value = Form.CB_AutoRepair.Value
End Event
//自动远征开关
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
    Form.CB_Supply_CheckOil.Value = Form.CB_AutoExpedition.Value
End Event
//自动攻击开关
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
    //    Form.CB_Attack_When_DaPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_When_DaPo.Value = 0
    Form.CB_Attack_When_ZhongPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_When_XiaoPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_Suppy.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_CheckOil.Value = Form.CB_AutoAttack.Value
End Event
//结束自动换船开关
Event Form.CB_AutoChangeShip.Click
    AutoChangeShip = Form.CB_AutoChangeShip.Value
End Event


//大破出击开关
Event Form.CB_Attack_When_DaPo.Click
    If (Form.CB_Attack_When_DaPo.Value = 1) Then 
        MessageBox "警告，这极有可能导致舰船沉没！请确认了解该情况会导致的后果！"
    End If
End Event

//是否进击回合次数
Event Form.CB_AttackNightFight.Click
    AttackNightFight = Form.CB_AttackNightFight.Value
End Event
//是否夜战
Event Form.CB_AttackFightRound.SelectChange
    AttackFightRound = Form.CB_AttackFightRound.ListIndex
End Event

//设置第几舰队远征
Event Form.CB_Expedition_Navy2_Enable.Click
    Expedition_Navy2_Enable = Form.CB_Expedition_Navy2_Enable.Value
    Form.CB_Supply2.Value = Form.CB_Expedition_Navy2_Enable.Value
    Form.CB_AutoSupply.Value =1
End Event
Event Form.CB_Expedition_Navy3_Enable.Click
    Expedition_Navy3_Enable = Form.CB_Expedition_Navy3_Enable.Value
    Form.CB_Supply3.Value = Form.CB_Expedition_Navy3_Enable.Value
    Form.CB_AutoSupply.Value = 1
End Event
Event Form.CB_Expedition_Navy4_Enable.Click
    Expedition_Navy4_Enable = Form.CB_Expedition_Navy4_Enable.Value
    Form.CB_Supply4.Value = Form.CB_Expedition_Navy4_Enable.Value
    Form.CB_AutoSupply.Value = 1
End Event
//设置远征地图
Event Form.CB_Expedition_Missionevel_Navy2.SelectChange
    ExpeditionMissionID_Navy2 = Form.CB_Expedition_Missionevel_Navy2.ListIndex
End Event
Event Form.CB_Expedition_Missionevel_Navy3.SelectChange
    ExpeditionMissionID_Navy3 = Form.CB_Expedition_Missionevel_Navy3.ListIndex
End Event
Event Form.CB_Expedition_Missionevel_Navy4.SelectChange
    ExpeditionMissionID_Navy4 = Form.CB_Expedition_Missionevel_Navy4.ListIndex
End Event

//出击后强制补给
Event Form.CB_Attack_Suppy.Click
    Form.CB_Supply1.Value = Form.CB_Attack_Suppy.Value
    Form.CB_AutoSupply.Value = 1
End Event
/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"
DimEnv ChangeShipIDArrayIndex










/*****************************设置常量*****************************/
//远征舰队坐标
Const ExpeditionNavyPosition = "356|120"
Const ExpeditionNavyPositionOffset = 30
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMissionPosition = "160|170"
Const ExpeditionMissionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//列表类型坐标
Const TypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMissionPosition = "280|200"
Const AttackMissionPositionOffsetX = 350
Const AttackMissionPositionOffsetY = 150
//出击的BOSS地图坐标
Const AttackMissionPositionOfBossMap = "710|260"
//出击的BOSS地图任务2坐标
Const AttackMissionPositionOfBossMission1 = "710|260"
//出击的BOSS地图任务3坐标
Const AttackMissionPositionOfBossMission2 = "710|300"

//出击的活动地图坐标
Const AttackMissionPositionOfSpecialMap = "720|450"
//出击的活动地图任务1坐标
Const AttackMissionPositionOfSpecialMission = "720|200"
Const AttackMissionPositionOfSpecialMissionOffset = 100


//换船接触除了旗舰以外的船坐标
Const ChangeShipWithOutFlagPosition = "420|120"
Const ChangeShipPagePosition = "520|450"
Const ChangeShipPagePositionOffset = 30
Const ChangeShipListPosition = "470|170"
Const ChangeShipListPositionOffset = 30
Const ChangeShipBackToFirstPagePosition = "440|450"
Const ChangeShipJumpPageToNext5Position = "680|450"
Const ChangeShipListNavyPosition = "130|120"

/**********************************************************初始化变量**********************************************************/
X = -1 
Y = - 1 
//攻击阵形坐标数组
AttackFormationPositionArray = Array("450|185","480|185","710|185","510|345","640|345")






















//**********************************************************逻辑**********************************************************/
Do
/****************************初始化****************************/
    Call GetHwndForGame()
    Call RepairNavy()
    //Call AttackChangeNavy()
    //    result = CheckOilAndAmmoIsFull()
    //    If (CheckOilAndAmmoIsFull()) Then 
    //        TracePrint "result1:" & result
    //    Else 
    //        TracePrint "result2:" & result	
    //    End If
    //    TracePrint "result3:" & result
    
    //    Call RepairNavy()
    
    Call TD_CheckTiDu()
    ///****************************远征结束*****************************/
    //Call GoToMuGang()
    ///*****************************补给*****************************/
    //TracePrint "AutoSupply:" & AutoSupply
    //If (AutoSupply = 1) Then 
    //    Call SupplyNavy()
    //End If
    ///*****************************入渠*****************************/
    //TracePrint "AutoRepair:" & AutoRepair
    //If (AutoRepair = 1) Then 
    //    Call RepairNavy()
    //End If
    ///*****************************远征*****************************/
    //TracePrint "AutoExpedition:" & AutoExpedition
    //If (AutoExpedition = 1) Then 
    //    Call ExpeditionNavy()
    //End If
    ///****************************出击****************************/
    //TracePrint "AutoAttack:" & AutoAttack
    //If (AutoAttack = 1) Then 
    //    Call AttackNavy()
    //End If
    ///*****************************补给*****************************/
    //If (AutoSupply = 1) Then 
    //    Call SupplyNavy()
    //End If
    ///*****************************入渠*****************************/
    //If (AutoRepair = 1) Then 
    //    Call RepairNavy()
    //End If
    ///*****************************结束*****************************/
    //Call TD_CheckExpedition()
    Delay 1000
Loop While(1=1)




















/**********************************************************提督很忙**********************************************************/


















/*****************************远征*****************************/
Function TD_Expedition()
    Call setHwndByGame()
    Call GoToMuGang()
    If (Form.CB_Supply_When_Expedition_Before.Value = 1) Then 
        Call SupplyNavy()
    End If
    Call ExpeditionNavy()
End Function

/****************************出击****************************/
Function TD_Attack()
    Call setHwndByGame()
    Call GoToMuGang()
    If (Form.CB_Supply_When_Attack_Before.Value = 1) Then 
        Call SupplyNavy()
    End If
    Call AttackNavy()
End Function


/**检查远征是否就绪**/
Function TD_CheckTiDu()
    Do
        Call setHwndByTidu()
        
        Rem 远征判断
        If (Form.CB_AutoExpedition.Value = 1) Then 
        	

            Call LJ_FindPic("提督_综合_远征_第二舰队_准备就绪1")
            If (Form.CB_Expedition_Navy2_Enable.Value = 1 and FoundPic = 1) Then 
                Call TD_Expedition()
                Exit Function
            End If
            Call LJ_FindPic("提督_综合_远征_第二舰队_准备就绪2")
            If (Form.CB_Expedition_Navy2_Enable.Value = 1 and FoundPic = 1) Then 
                Call TD_Expedition()
                Exit Function
            End If
            Call LJ_FindPic("提督_综合_远征_第三舰队_准备就绪1")
            If (Form.CB_Expedition_Navy3_Enable.Value = 1 and FoundPic = 1) Then 
                Call TD_Expedition()
                Exit Function
            End If
            Call LJ_FindPic("提督_综合_远征_第三舰队_准备就绪2")
            If (Form.CB_Expedition_Navy3_Enable.Value = 1 and FoundPic = 1) Then 
                Call TD_Expedition()
                Exit Function
            End If
        Else 
            TracePrint "远征没有开启"
        End If
        Rem 远征结束
        
        Rem 入渠开始判断	
        If (Form.CB_Repair_Dapo.Value = 1) Then 
            TracePrint "按照入渠设置，检测是否大破"
            Call LJ_FindPic("提督_综合_舰队列表_HP_大破")
            If (FoundPic = 1) Then 
                TracePrint "按照出击设置，检测是否大破：是"
                Call RepairNavy()
                Call ChangeNavy()
                Goto 入渠结束判断
            Else 
                TracePrint "按照入渠设置，检测是否大破：否"
            End If
        Else 
            TracePrint "按照入渠设置，不检测是否大破"
        End If
        If (Form.CB_Repair_ZhongPo.Value = 1) Then 
            TracePrint "按照入渠设置，检测是否中破"
            Call LJ_FindPic("提督_综合_舰队列表_HP_中破")
            If (FoundPic = 1) Then 
                TracePrint "按照出击设置，检测是否中破：是"
                Call RepairNavy()
                Call ChangeNavy()
                Goto 入渠结束判断
            Else 
                TracePrint "按照出击设置，检测是否中破：否"
            End If
        Else 
            TracePrint "按照入渠设置，不检测是否中破"
        End If
            
        If (Form.CB_Repair_XiaoPo.Value = 1) Then 
            TracePrint "按照入渠设置，检测是否小破"
            Call LJ_FindPic("提督_综合_舰队列表_HP_小破")
            If (FoundPic = 1) Then 
                TracePrint "按照出击设置，检测是否小破：是！"
                Call RepairNavy()
                Call ChangeNavy()
                Goto 入渠结束判断
            Else 
                TracePrint "按照出击设置，检测是否小破：否"
            End If
        Else
            TracePrint "按照入渠设置，不检测是否小破"
        End If
        Rem 入渠结束判断
        
        Rem 进击判断
        If (AutoAttack = 1) Then 
            If (Form.CB_Attack_When_DaPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否大破"
            Else 
                Call LJ_FindPic("提督_综合_舰队列表_HP_大破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否大破：是 取消出击！"
                    Call RepairNavy()
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否大破：否"
                End If
            End If
            If (Form.CB_Attack_When_ZhongPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否中破"
            Else 
                Call LJ_FindPic("提督_综合_舰队列表_HP_中破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否中破：是 取消出击！"
                    Call RepairNavy() 
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否中破：否"
                End If
            End If
            If (Form.CB_Attack_When_XiaoPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否小破"
            Else
                Call LJ_FindPic("提督_综合_舰队列表_HP_小破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否小破：是 取消出击！"
                    Call RepairNavy()
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否小破：否"
                End If
            End If
            Call LJ_FindPic("提督_综合_舰队列表_入渠中")
            If (FoundPic = 1) Then 
                TracePrint "当前舰队有船只正在入渠"
                If (AutoChangeShip = 1) Then //如果有开启自动更换的话
                TracePrint "自动更换已经打开，更换船只"
                    Call ChangeNavy()
                    Exit Function
                Else 
                TracePrint "自动更换没有打开，在入渠界面等待入渠结束"
                    Call GoToScene("入渠")
                End If
                Goto 进击结束
            End If
            TracePrint "AutoAttack:" & AutoAttack
            If (AutoAttack = 1) Then 
                If (Form.CB_Attack_CheckCondition.Value = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_可以出击")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_疲劳回复好了")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_疲劳回复时间到了")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_6只疲劳49")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_6只疲劳40以上")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPicByRect("提督_综合_舰队列表_舰队状态_可以出击",103,572,130,604)
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
            End If
        End If
        Rem 进击结束
        TracePrint "进击结束"
        Delay 5000
    loop While (True)
End Function

Function TD_RefreshGame()
    Call setHwndByTidu()
    Call LJ_PointGetAndClick("30|840")
    Call LJ_PointGetAndClick("130|590")
    Call LJ_PointGetAndClick("770|590")
    Call LJ_FindPicAndClick("提督_设置")
    Call setHwndByGame()
End Function
































/**********************************************************函数**********************************************************/





























/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    Call setHwndByGame()
    //回到母港
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_DeleyForNet()
        Call LJ_FindPicUntilFound("母港_出击")
    End If
    
    Do While(FoundPic = 1)
        //每次回港都直接检查远征
        Call LJ_FindPic("远征_结束_开始")
        If (FoundPic = 1) Then 
            TracePrint "发现远征结束舰队"
            Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价")
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPic("远征_结束_开始")
            isExpeditionFinish = True
        End If
    Loop
    If (isExpeditionFinish) Then 
        isExpeditionFinish = False
        Call SupplyNavy()
    End If
End Function
Function GoToScene(SceneName)
    Call setHwndByGame()
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*远征主逻辑*/
Function ExpeditionNavy()
    TracePrint "AutoExpedition:" & AutoExpedition
    Call setHwndByGame()
    If (AutoExpedition = 0) Then 
        Exit Function
    End If
    
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    
    If (Expedition_Navy2_Enable = 1) Then 
        Call ExpeditionSelectMapByMissionID(ExpeditionMissionID_Navy2,1)	
    End If
    If (Expedition_Navy3_Enable = 1) Then 
        Call ExpeditionSelectMapByMissionID(ExpeditionMissionID_Navy3,2)	
    End If
    If (Expedition_Navy4_Enable = 1) Then 
        Call ExpeditionSelectMapByMissionID(ExpeditionMissionID_Navy4,3)	
    End If
    
    If (Form.CB_Supply_CheckOil.Value = 1) Then 
        If (CheckOilAndAmmoIsFull() = false) Then 
            TracePrint NavyNumber & "舰队在执行任务" & ExpeditionMissionID + 1  & "时缺油或弹药"
            Call SupplyNavy()
            Exit Function
        End If
    End If
    
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
    
    //    Call GoToMuGang()
End Function

/*选择远征地图*/
Function ExpeditionSelectMapByMissionID(ExpeditionMissionID,NavyNumber)
    //远征地图下标
    ExpeditionMapIndex = ExpeditionMissionID / 8
    TracePrint "ExpeditionMapIndex:" & ExpeditionMapIndex
    //远征任务下标
    ExpeditionMissionIndex = ExpeditionMissionID mod 8
    TracePrint "ExpeditionMissionIndex:" & ExpeditionMissionIndex
    
    /*选择远征地图*/
    Call LJ_PointAddAndClick(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
	/*选择远征关卡*/
    Call LJ_PointAddAndClick(ExpeditionMissionPosition,0,ExpeditionMissionIndex * ExpeditionMissionPositionOffset)

    Call LJ_FindPic("出击_远征_远征中止")
    If (FoundPic = 1) Then //如果远征正在执行，则退出
        TracePrint "第" & NavyNumber + 1 & "舰队已经在执行远征任务"
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_PointAddAndClick(ExpeditionNavyPosition, NavyNumber * ExpeditionNavyPositionOffset, 0)
    
    If (Form.CB_Attack_CheckOil.Value = 1) Then 
        If (CheckOilAndAmmoIsFull() = false) Then 
            TracePrint NavyNumber & "舰队在执行任务" & ExpeditionMissionID + 1  & "时缺油或弹药"
            Call SupplyNavy()
            Exit Function
        End If
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
End Function

Function CheckOilAndAmmoIsFull()
    Call LJ_FindPic("远征_结束_舰队_缺油")
    If (FoundPic = 1) Then 
        CheckOilAndAmmoIsFull = False
        Exit Function
    End If
    
    Call LJ_FindPic("远征_结束_舰队_极度缺油")
    If (FoundPic = 1) Then 
        CheckOilAndAmmoIsFull = False
        Exit Function
    End If
    
    Call LJ_FindPic("远征_结束_舰队_缺弹药")
    If (FoundPic = 1) Then 
        CheckOilAndAmmoIsFull = False
        Exit Function
    End If
    CheckOilAndAmmoIsFull = True
End Function

/*补给主逻辑*/
Function SupplyNavy()
    TracePrint "AutoSupply:" & AutoSupply
    Call setHwndByGame()
    If (AutoSupply = 0) Then 
        Exit Function
    End If
    Call GoToMuGang()
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    ForForm = 0
    ForTo = 3
    ForStep = 1
    If (Form.CB_Supply_Sort.Value = 1) Then 
        ForForm = 3
        ForTo = 0
        ForStep = -1
    End If
    For index = ForForm To ForTo Step ForStep
        If (index = 0) Then 
            If (Form.CB_Supply1.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 1) Then 
            If (Form.CB_Supply2.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 2) Then 
            If (Form.CB_Supply3.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 3) Then 
            If (Form.CB_Supply4.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_FindPic("补给_补给列表_全选框")
        If (FoundPic = 1) Then 
            TracePrint "补给第" & index+1 &"舰队时，使用全选框"
            Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
            Call LJ_FindPic("补给_补给列表_确定补给_disable")
            If (FoundPic = 0) Then 
                TracePrint "不能补给，第" & index+1 &"舰队"
                Call LJ_FindPicAndClick("补给_补给列表_确定补给")
                Call LJ_DeleyForNet()
            End If
        End If
        Rem 下一个补给舰队
    Next
    Call GoToMuGang()
End Function

/*入渠主逻辑*/
Function RepairNavy()
    TracePrint "AutoRepair:" & AutoRepair
    Call setHwndByGame()
    If (AutoRepair = 0) Then 
        Exit Function
    End If
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    
    Dim FlagShipIsRepayed //旗舰是否修复
    FlagShipIsRepayed = 0
    Dim RepairedX, RepairedY //扫描这行的起始坐标
    RepairedX = 360
    RepairedY = 125
    Dim HaveSomeoneOnRapired //整个扫描的页里面是否有一艘被修复的
    HaveSomeoneOnRapired = False
    Dim TheLineIsRepayed //这行是否被修复
    TheLineIsRepayed = 0
    For index = 0 To 3
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_空位")
        //确定船只
        For index = 0 To 9
            TracePrint "正在判断第" & index+1 &"艘舰"
                
            TheLineIsRepayed = RepairFindShip(RepairedX, RepairedY)
            
            If (TheLineIsRepayed = False) Then 
                Call LJ_FindPicAndClick("入渠_维修列表_入渠开始")
                Call LJ_FindPicAndClick("入渠_维修列表_维修开始_确定维修")
                Call LJ_FindPicAndClick("入渠_维修列表_空位_详情返回")
                Call LJ_FindPicAndClick("入渠_维修列表_空位_列表返回")
            End If
            RepairedY = RepairedY + 30//查找下一行
        Next
    Next
    //    Call GoToMuGang()
End Function

Function RepairFindShip(mRepairedX, mRepairedY)
    Dim IsFirstNavy//这艘舰，这是第一舰队的

    RepairedYEnd = mRepairedY + 30
    
    If (Form.CB_Repair_Navy_1.Value = 1) Then 
        Call LJ_FindPicByRect("入渠_维修列表_第一舰队", mRepairedX, mRepairedY, 800, RepairedYEnd)
        If (FoundPic = 1) Then 
            TracePrint "找到第一舰队 x:" & X & " Y:" &Y
            IsFirstNavy = True
        Else 
            TracePrint "没有找到第一舰队，如果没有找到当页最后，尝试继续查找"
            IsFirstNavy = False
            //RepairFindShip = False//当成已修复处理，跳过该舰入渠
            Exit Function
        End If
    End If
    
    If (Form.CB_Repair_XiaoPo.Value = 1) Then 
        TracePrint"小破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_小破", mRepairedX, mRepairedY, 800, RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_ZhongPo.Value = 1) Then 
        TracePrint"中破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_中破", mRepairedX, mRepairedY, 800, RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_DaPo.Value = 1) Then 
        TracePrint"大破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_大破", mRepairedX, mRepairedY, 800, RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_WeiPo.Value = 1 and HaveSomeoneOnRapired = True) Then 
        TracePrint "微破入渠被选中，并且已经有其他正在入渠的舰只 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_满血", mRepairedX, mRepairedY, 800, RepairedYEnd)
        If (FoundPic = 0) Then 
        X = mRepairedX + 150
        Y = mRepairedY + 20
        Call LJ_LeftClickOnXY()
        End If
    End If
    Call LJ_FindPicByRect("入渠_战斗状态_修复", mRepairedX, mRepairedY, 800, RepairedYEnd)
    If (FoundPic = 1) Then 
        RepairFindShip = True//用作判断本行
        HaveSomeoneOnRapired = True//用来判断全部
    End If
    
End Function

/**战斗**/
Function AttackNavy()
    Call setHwndByGame()
    TracePrint "AutoAttack:" & AutoAttack
    If (AutoAttack = 0) Then 
        Exit Function
    End If
    If (Int(Form.CB_Attack_Limit_Count.Value) = 1 and Int(Form.Label_Attack_Index.Caption) > Int(Form.IB_Attack_Limit_Count.Text)) Then 
        TracePrint "当前出击次数超过用户设置的最大次数，停止出击" & Form.Label_Attack_Index.Caption &" "& Int(Form.IB_Attack_Limit_Count.Text)
        Exit Function
    End If
    Form.Label_Attack_Index.Caption = Int(Form.Label_Attack_Index.Caption) + 1
        
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
    
    //出击地图
    AttackMapIndex = Form.CB_Attack_MapLevel.ListIndex
    //出击关卡
    AttackMissionXIndex = Form.CB_Attack_MissionLevel.ListIndex mod 2
    AttackMissionYIndex = Int(Form.CB_Attack_MissionLevel.ListIndex / 2)
	
	/*选择出击地图*/
    If (AttackMapIndex < 6) Then //正常地图
        Call LJ_PointAddAndClick(AttackMapPosition, AttackMapIndex * AttackMapPositionOffset, 0)
		/*选择出击关卡*/
        If (Form.CB_Attack_MissionLevel.ListIndex < 4) Then //如果是正常地图，就用正常关卡
            Call LJ_PointAddAndClick(AttackMissionPosition,AttackMissionXIndex * AttackMissionPositionOffsetX,AttackMissionYIndex * AttackMissionPositionOffsetY)
        Else// If(AttackMapIndex = 5)//如果是BOSS地图，就是第五地图
            Call LJ_PointGetAndClick(AttackMissionPositionOfBossMap)
            Delay 2000
            Call LJ_PointGetAndClick(AttackMissionPositionOfBossMission1)//只实现了X-5，没有实现X-6
        End If
    Else// If(AttackMapIndex = 6)//活动地图
        Call LJ_PointGetAndClick(AttackMissionPositionOfSpecialMap)
        Call LJ_PointAddAndClick(AttackMissionPositionOfSpecialMission, 0, Form.CB_Attack_MissionLevel.ListIndex * AttackMissionPositionOfSpecialMissionOffset)
        Call LJ_PointAddAndClick(AttackMissionPositionOfSpecialMission, 0, Form.CB_Attack_MissionLevel.ListIndex * AttackMissionPositionOfSpecialMissionOffset)
        Call LJ_PointAddAndClick(AttackMissionPositionOfSpecialMission, 0, Form.CB_Attack_MissionLevel.ListIndex * AttackMissionPositionOfSpecialMissionOffset)
    End If
	

    Delay 1000
	
    
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    
    
    If (Form.CB_Supply_CheckOil.Value = 1) Then 
        If (CheckOilAndAmmoIsFull() = false) Then 
            TracePrint NavyNumber & "舰队在执行任务" & ExpeditionMissionID + 1  & "时缺油或弹药"
            Call SupplyNavy()
            Exit Function
        End If
    End If
    
    Call LJ_FindPic("出击_出击_出击开始_disable")
    If (FoundPic = 0) Then 
        Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
        Call Fighting()
        Call LJ_DeleyForNet()
    End If
End Function
//战斗中
Function Fighting()
    FightingRound = 0
    Timeout = 0
    Do
        Call LJ_FindPicAndClick("战斗_战斗中_指南针")
        
        Call LJ_PointGetAndClick(AttackFormationPositionArray(Form.CB_Attack_Formation.ListIndex))
        
        If (AttackNightFight = 1) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_追击")
        End If
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1
                TracePrint "当前战斗回合数：" & FightingRound & " 总攻击回合数：" & AttackFightRound
                Delay 1000
            End If
        Else 
            TracePrint "当前战斗回合数：" & FightingRound & " 总攻击回合数：" & AttackFightRound
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
            TracePrint "战斗结束，判断舰船是否大破"
            Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
            If (FoundPic = 1) Then 
                TracePrint "检测到舰船大破，不再继续进击"
                ShipWasDestroyed = 1
                FightingRound = 999//不在继续战斗
            End If
        End If
        Call LJ_FindPicAndClick("进击_结束_评价_继续")
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
        Timeout = Timeout + 1000
        If (Timeout >= 300000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function

//换船
Function ChangeNavy()
    TracePrint "AutoChangeShip:" & AutoChangeShip
    If (AutoChangeShip = 0) Then 
        Exit Function
    End If
    //舰船更换ID
    Call ChangeNavyUpdate()
    Call GoToScene("编成")
    Call LJ_PointGetAndClick(ChangeShipListNavyPosition)
    Call LJ_PointGetAndClick(ChangeShipListNavyPosition)
    Call LJ_PointGetAndClick(ChangeShipWithOutFlagPosition)
    Call LJ_FindPicUntilFoundThenClick("编成_列表_变更")
    Call LJ_DeleyForNet()
    //更换旗舰
    Call LJ_ClickUntilChangeTo(TypePosition, "编成_列表_类型_船只")
    //初始化页数
    Call LJ_PointGetAndClick(ChangeShipBackToFirstPagePosition)
    Call LJ_PointAddAndClick(ChangeShipPagePosition, ChangeShipPagePositionOffset * 2, 0)
    For index = 0 To ChangeShipPageCount /5 - 1 
        Call LJ_PointGetAndClick(ChangeShipJumpPageToNext5Position)
    Next
    Call LJ_PointAddAndClick(ChangeShipPagePosition, ChangeShipPagePositionOffset * (ChangeShipPageCount mod 5), 0)
    Delay 1000
    Call LJ_PointAddAndClick(ChangeShipListPosition, 0, ChangeShipListPositionOffset * ChangeShipLineNumber)
    Delay 1000
    Call LJ_FindPic("编成_列表_确定变更_disable")
    If (FoundPic = 0) Then 
        Call LJ_FindPicUntilFoundThenClick("编成_列表_确定变更")
    Else 
        ChangeShipIDArrayIndex = ChangeShipIDArrayIndex + 1
        Call ChangeNavy()
    End If
End Function
Function ChangeNavyUpdate()
    ChangeShipIDArray = Split(Form.IB_ChangeShipIDs.Text, "|", - 1 , 1)
    
    Dim ShipID
    ShipID = ChangeShipIDArray(ChangeShipIDArrayIndex)
    PageCount = Int(ShipID  / 10)
    LineIndex = Int(ShipID mod 10)
    //换船页数
    ChangeShipPageCount = pageCount - 1
    //换船行数
    ChangeShipLineNumber = LineIndex
    ChangeShipIDArrayIndex = ChangeShipIDArrayIndex + 1
    TracePrint "ChangeShipIDArrayIndex:" &　ChangeShipIDArrayIndex
End Function

//工厂开发
Function FatoryExploitation()
    TracePrint "AutoChangeShip:" & AutoChangeShip
    If (AutoChangeShip = 0) Then 
        Exit Function
    End If
    Call GoToScene("工厂")
    Delay 1000
    
End Function












































/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(HwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    HwndGame = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    Call setHwndByGame()
    If (Hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
    Call Plugin.Window.SetClientSize(HwndTidu, 800, 1000)
    TracePrint "HwndTidu:" & HwndTidu
    TracePrint "HwndGame:" & HwndGame
    TracePrint "Hwnd:" & Hwnd
End Function
Function setHwndByGame()
    Hwnd = HwndGame
    TracePrint "Hwnd Game Hwnd:" & Hwnd
    ScreenHeight = 480
    ScreenWidth = 800
    PicDefinition = 0.9
End Function
Function setHwndByTidu()
    TracePrint "Hwnd Tidu Hwnd:" & Hwnd
    Hwnd = HwndTidu
    ScreenHeight = 1000
    ScreenWidth = 800
    PicDefinition = 1.0
End Function

/**第三方库查找图片**/
Function Lib_FindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, 0, 0, ScreenWidth, ScreenHeight, resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function
Function Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function

Function Lib_FindPicByRectAndDefinition(picName,StartX,StartY,EndX,EndY,mPicDefinition)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, mPicDefinition, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call Lib_FindPic(picName)
    If X > - 1  Then //找到了
        TracePrint "LJ_FindPic:" & picName & " FoundPic = true"
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            TracePrint "LJ_FindPic:" & picName & " FoundPic = false"
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPicByRect(picName & "_touched",StartX,StartY,EndX,EndY)
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

Function LJ_FindPicByRectAndDefinition(picName,StartX,StartY,EndX,EndY,mPicDefinition)
    Call Lib_FindPicByRectAndDefinition(picName,StartX,StartY,EndX,EndY,mPicDefinition)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPicByRectAndDefinition(picName & "_touched",StartX,StartY,EndX,EndY,mPicDefinition)
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    If X <= - 1  Then 
        Exit Function
    End If
    TracePrint "LJ_LeftClickOnXY x:" & X & " Y :" & Y
    If (Y < 800) Then 
        Call Plugin.Bkgnd.LeftClick(Hwnd, X, Y)
    Else 
        Call Plugin.Bkgnd.LeftClick(HwndTidu, X, Y)
    End If
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim ZuoBiao
    ZuoBiao = InStr(XY, "|")
    X = Clng(Left(XY, ZuoBiao - 1)) : Y = Clng(Right(XY, Len(XY) - ZuoBiao))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

/**点击坐标，直到出现图片**/
Function LJ_ClickUntilChangeTo(Position,PicName)
    Dim Timeout
    Timeout = 0
    Call LJ_FindPic(PicName)
    Do While (FoundPic = 0)
        Call LJ_PointGetAndClick(Position)
        Delay 100
        Call LJ_FindPic(PicName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop
End Function

Function LJ_DeleyForNet()
    TracePrint "网络等待"
    Delay 1000
    nTime = Plugin.Sys.GetTime()
    Do
        Call LJ_FindPicByRectAndDefinition("全局_载入中", 770, 450, 800, 480, 0.7)
        If (FoundPic = 1) Then 
            TracePrint "仍在获取网络数据"
            nTime = nTime + 1500
        End If
    Loop While (nTime > Plugin.Sys.GetTime())
    TracePrint "获取网络数据完毕"
End Function
