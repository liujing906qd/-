[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=2a66429a-f8d4-4300-b6ee-02f792c0369c
Description=舰娘
Enable=1
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]
记得停止睡眠模式

[UIPackage]
UEsDBBQAAgAIAPhQQ0a+eToh7RkAAAiQAQAJABEAVUlQYWNrYWdlVVQNAAfQndBU0J3QVNCd0FTtXQd4FdUSng1FepWICAiKqNhIQhfFkASJJBCTUAQ1BggSCUlMAoIVO3asWLAg9q4gCig2BBQLKiJi7wX1WdGnT3gz9+7NXVJ055y5mSTc4zff3uDe+Xfunp39/zN79jSAYFv/etuPFz7a6ROo0A6HBrBte1No7Pm3GDQn9Eeb4N8N0bZt37499M9z0LZHW51pf6PROUxAo3PdCG0XtGZoTdCaojVHa4nWAq1V8NRDa7R2aG3RdkVrj9YBbTe0WLSOaJ3QdkfbA60rWme0Lmh7onVH64a2F1oPtL3R9kHbF60n2n5ovdD2RzsA7SC0A9EORuuNdghaHFoftHi0vmgnog1A64fWH20g2qFog9AGB/o0wGFoQ9AS0Y5AG4qWjJaEloJ2JNowtOFoR6Gloo1AG4mWhpaONgrtaLQMtEy0bLQstNFoY9HGoI1Dm4B2DNp4tGPRjkc7Di0HLRftBLSJaJPRJqHloU1Fm4KWj3YT2jS0k9AK0IrQpqMVohWjlaCdjFaKNgOtDG0m2iy0U9Bmo52Gdira6Whnop2BdhbaOWhnB46/CP8rw3ORgn7L0Ods4LRY7DGhvuT8y77zVrZdmT5kvdMA3AML/GapgfNp2pqA44TwZ1Wzz5z5QdwQvvf/JeHZS7M4gmYe/Eb/gh/aev9fNv7exXjmR2KPmB7oAbzWDmIC+K3dvOv3ew3dLeVuLevm5oG93Ou/h5sDerp5QPPYdhYbVlQy3eLyA9vvO2DXbL9v25Y88soXcYr4P/74o9X3TfNOOP/F7MD3/J6zUP6hu04u3gULDI+hFeY/4ie7MPJfjAd/DN5pS9FMj6AN4reAMOf1850GHvxMRM1FBjAKf4cC5r03lP8bQ5Cv+cVv6MHPRvxZAeZgfP4d7vlv5Bq1JGQfBWglhkeyqwF+Y0/8YfyheB4mBfgWEz9wPpsyfv9dKpz/SZa/P3HzJgz8JhDk8N52HF4UP0Hda1urjjlwW0jP6paVW1jaLSuvJH9KhPCzcycmFRWWlRQVGH8/J6moxDgB297/xmPmKcH8kxdQE/zWyiD/N/X0/zS89vhX3Y79v5Xrzy9+Mw/+MMQvtLv+2PHT/Wqw+zkRs08+KtfCwF240CT/sfFb7JD/SP/EWcTvOHQ/Jd7evpp9Iq1/ugLv/tvS7QPUNPgP9dcm7mcJ/kNjLB0Z/b81yPKfTszfvw3I8h8af2rLiL8tiPIf9vn3jpdK8Z+9GfG388SvrZ9sm63+oUZjoMR/fjP4rrZ+teU/EvyXxn33ZPS/9iDLf2l8uQsDf1cI818N/tMBZPlPZ/ea9osfC7r8h2oEIf6Tith5eAcuNcRvgfFTPN0Z8Xf0nP8sRC9w+2BeYCSe19oZxL87eO8/dPcPXXvhq9Fv64Tx0+/ZgxF/Jw9+DDRZvm79qmc2bVzdcMPSt3+HGm62+Vsi/2u2dpbfp7zXNmloTmZKRmJqZs744aNGHplBBSpojf+anpqVlTpqZFrKmJS0wJWP/5aYnZidNCL0v4L9r9S4B3Y26P97ePpfFl53s43Zb+D6Z+N3rnT9lQbuAvmuAstFyw/kxX9v3Qzwu1SBPxyxSQdOZebiWAP8rrDj+Fcw5nzcUgbkZeSumH+6QbCG4xefuEKPmBA+6c944/7vrb/tV80+NVF/68uIn44zpP809CfV1Fu6n8tTA6WLlHEZKcmp2ZgWcgIjAm3CiWVcauKoYF5pHsgh2YmYQ6j4Du3Df48dnjIyJzkxnH88DgP7tgo7DO0WW+HrngxGeS1xdPaosBf618ZpiUNT0gLumuEOWaMzMtKOidvxz/gd/0zY8c8+YTfxFSIK7NmhwiFVGXvgmy3dIwzGVGGPOO8ewX8L7ZGemFHdDx9f4YcfmTjmmB1dBYMI/JyBGP7JW8K/9YWkqXmTpg0tmmXa/+iYZpQVZc0oLi6YbfD9ul7/e2fD0ocfW/bkH4OU8G35j8T4Ez2T04uR/3qB6PgTO/8dALLjT3TJHsSI/0CQr7/1YeDTsTYNXb9C408JDPyDQbb+1tP9Tf3iHwKy4w+93T7lF7836I4/xHnij3XPB90Akg3wYyzzl/b4Fygfv3aTGH+i/rQvo//Hg+74E+WqweX5Z2ogA0wzGv0J1j8on+zPiL8PVM7/mUbqz6z+1xd09Xc/D75G/bM/VKx/JoBpI/1JuZye9x1YzT41oT+HMfofPSMd0p9C/D+xrCx3kkkWqQ/8f/HWFb9r4dfF5//oOgmNP0joD3qe/1BG/x8EuvrjUJDVHzR34XBG/INBXn+kMPAP8+YfIf2RzMA/HGT1R383Jr/4Q0BWfyS659Qv/hEQ1h/E/++FIP9/RiF/Rfm/btPQn4kgW/+mOVwDGP1/KOjqjySQ1R90PQ9ixJ8MuvojBXT1xzDQ1R9HQkX90cei/4XrX0dVs09N6I+xjP5Hcys16180p1OSf2ZAcG6oX/yjQJd/jvD2Pxn9l5lXnJtvcgepD/pv7ZY127TwbfWfhP6g+c+jGP0/DeT1xxgGfjrI64/RDPyRIKs/hrs+/eKPAln9ken+pn7xM0C3/nE0yPJPmvufyog/E3T5Jx1viH+S/qN7N90ATCbyNrDMX1H9p9sk9AddTyMY/T8bdPXHaNDVH2NAV3+MhYr6o69F/nEc0jP03pIJ1exTE/ojj9H/qFYTmn+soT/o2a1W7mcJ/UHvkjmOEf94z/lPy52YVwDmLfD9nPTc4rS8mVaODJt2/n1806tPLVquh2/L/yXm/9E7jE5k9L8JIFv/oHcrncDAPxZ0339A12rovWpS+mMKI/7jQVZ/UD7LYeDngKz+mOTG5Bf/BNDVH7kgqz8mQzCn+8Wf6MGnfnMh2hVo1xngt7XMX3Wd/2s32/u3hv6k61Xz/QeTwZv/S/B6LMR7YDFuS9jH0NEAPw+8/H8G4hWhDsmHU834Lxt/ClTk//0szn+4/lBdFqsJ/j+Dkf+Iq2jyf9JKofu/BP+nd0BOZ8SfDxX4v/n0K+umzd+XbXrmnrrM3+mZDbp/fw1m928J/k/M6RRG/zsJZPk/3f+KGfjTQJf/F4A8/5/JiH86yPJ/yidFDPxCkOX/pa5Pv/hFoMv/i0GW/5e515Rf/JM9+B0s81eUv9s1ifp74NnrHLN3eGnwf7rSNPl/Kejy/zLQ5f8zoCL/729x/h2H1MNfUP5K70qtJvj/XEb+o3ul5vNHxJWau58l+D+9x/0MRvyzPOfftqmPv29+c8XTty99Swvflr93xR/wbsoJjtnz180sj1/j+bPZIMv/z4fwuiN+vnMqyPP/Cxn4p4H880cXMPBPB1n+T2ftLAb+GSDL/8+F4NoWfvHPBF3+fxbI8v/z3D7tF38O1I71H6Kmb9Hnr3SbyPMX5tMHVPQf8VXJ+S/nuPc0v/jngO7zZ+eC7vNn54Hu82fnQ0X9OcCi/4XrT5dWd7+rAf15HaP/EVfTrD8RV5WsP12F28sZ8c8F2fePX43b6xn4F4Gs/rgMt1cy8C8G3frDJRDWH7atNtTvUpP1Kni2+p940SNu/zXR/10sj19Kf85n9P9LQVZ/0vU0j4F/Gcjqz2sg+PyUX/zLQVd/XgGy+vNaN6f4xZ8HuvNfKFdr1h+uAt36w9Ugt/5DtH4nMn82ZVZx3uT8svyiQub3bc+fRv3pGqjI/wdaXP+OQ3zuPrQF1exTE/z/Xkb+o3ypWX8irRJ6bleC/9+O21sY8c8H3fnv14Ms/78LtwsZ8d8A8vz/Hgb+jZ7+Vxvmz2usOxFqtvyd5s/OgWBN1eT5O+33H0jx/7sZ/e8mkOX/1J9vY+AvAFn+fwdub2Xg3wy6/P8WkOX/d7rn1C/+raDL/6mvSI4/L3LPqV/8haA7/ny7Bz9av7HMn2LP7yWoHL9G/WER6NYf7oDK65/2No4/XH94sJp9akJ/LGfkH8rXmvqD+LLk82+LcfswI/67QVd/3AOy+uMJ3D7GiP9eqD3rfz6+ee3fdfn5vSfd5/daxZiN37ewPH7b8yelP5cx+t99IP/825MM/PtBVn+Qv0cZ+A+ArP54HII1JL/4D4Ku/ngIZPXHUvc39Yv/MOjqDzpXkvpjifub+sV/FKL8X6olFU2fWGTL/3PLkP+n55eW5hcV1vB7dDT052Og+/zTYtDVH0ugsv6IM47fcWg8+T20ldXsE2n98ZKbe/zGT/crTf1B94tY97OE/liF22fBf/59AmSff3qR+fs/CbWH/9s2nyFX226DIB99H8z4eyfL49euv0voT/rdXmD0/2UgX/9ay8Df5tlPSn9wrr/lIKs/nsLt84z4V4Cs/liN2+cY+E+Brv54GmT1xxrXp1/8laCrP+h6DekP3mrflZsJ/3oWwuveZyF6gdsHTRSQyfMnz0Fl/hVvHH94/PfVavapifHfzYz+R7kixL+agBPnxDsJTh+nr9PP6e8wH8XfbnkDlquf6LzESH/8dOk2m/FTDf5NXEFy/J+Cf53RF1eB7vj/iyA7/v8Obt9kxL8a5PnXuwz8NSA//ruJgb8WZPnXOty+wcB/CWT519u4Xc/AfxnC/Mu22dZPprn1k+cM33/Q3PL4d/b5rxr8ex3I8u+NuH2F0f9fAV3+TTxRcvx/A25fY8T/Gug+f/Q66I7/rgfd8d83oLL+SDCO33Eon3+L9mE1+/yT/tBuAvUTncKJ2+r6+KmE/vwGeOPPxFU1x/9JL7R2P0voj89x+zH4z78bQHb8/wvm7/82yOqPj3D7GSP+jSCvP76GujP++w7I6g+qXXzKiH+TB9+2fkL3HXqfRyvHbP5DO8v8pc3fG3nGz0zwtcfPJPTnl7j9hBHLu6A7/r8ZZPXHV7j9gBH/e6CrPyhfaI7/fwDh5x41xv8/hMr8u49x/OHx/++r2SfEu+etjNz4/5+M/kf3a03+9THIjv/+gtv/MOL/BHTHfz8FWf5Fkyd/ZsT/mbf/l9dPLF4iZtH06yfrVtXl588bxQTHTycYPn8uxb//y+h/n4P8+P8fDPwvQJZ/b8HtTwz8L0F2/P836kcM/K9Al399DbL8aytuv2PE/w3o8i/STJLjv7/i9gdG/Fs88be0zF/R94fqNtvxU43x/+9Ad/z/e9Ad//8BKuuPvsbxO4Hn+Q7Djrytmn1CuiNS+qOpwxt/JK6uqT/oXimpPxo6wUTiF/8nkB3/bcT8/X+GHfi/3uLNEH3+nN5FR+OnNCfCZPy0leXxS+hP+gUaMPr/LyA//t/EqTvj/7+CrP74H25jGPH/BrL6ozFiOwz8raCrP34HWf2xC8b+N/iP/w/Q1R+k1UP6Q5u/N97h+WM+fi14/jj87sacOKjpZnv+NMb//4TwfUtj/P8vqMy/+xnHHx7/b1nNyYg0/ybsToz8S/cLTf5NuVLy+Yv2GHtrzv0fdMf/t4Ps+P9uGHs7RvyUNKLr/0Rtm614gfqx/h6tB1Zm+PxKV8vj1+ZfUvprd0b+Ia0gXf/pyMCPcWT1V3P015aB38CR1V8d0F8bBj6NV2nqr0aOrP6KRX8tGPE3dnT1F+lFyfrPrk7w+Tu/+E2c+rP+q22T1X81/w5Pqfe/1WT9p6mjW/9p5ujWf5o7lfVnf+P4HYfiOdAJcpmqWk3ozwMY+aeFo6s/SadL6s8e6K8bI/5Wjq7+bO3I6s/90N/ejPjbOPLj/70Y+G0jwD/3Z+C3E+afndHfXgz89oL3//rw/lbSf/T+VhP9183y+GvD+59s9UdPROvO6H+7KuuPDsL6Y1/014URf6yy/thNWH/sg/72ZMTf0dGdf7y7Mv/spMw/94jqv/Imq/9q/h1E9uv/BPWH6QrM3vrXIYr6YzAj/3RW1h9dhPVHX/QXx4i/q7L+2FNYfwxEf30Y8XeLgP44lIHfPQL6YxADfy9R/m/3/jHbJvH+IeL/zxnWf/a0PH5t/i+hPw9CtARG/9tbuP7RH/3FM/B7KOuPfYT1xwD0dzAj/p7K+mNfYf3RD/31ZsS/n7L+2F9Zf/SK8v9w/hPl/zU/h9Z+/eea158HVFH/MF0BmvQH6dmz0Y5Q1B/pjPxzoLL+OEhYfwxDf0MZ8R+srD8OEdYfR6G/FEb8vSOgP9IY+HGe/mfb6sP8eeL/EwzH/7tbHn/t4f92+nMEo//FC9e/Dkd/yQz8BGH9MRz9JTHw+yjrj77C+iMV/Q1hxN9PWX/0F9YfR6K/REb8A5T1x8Ao/w/nP3v+nzWjuLhgtuHUH9vfz/b7GvpzkHL969BK+iNeZP3noxX1x/GM/DPYw//+xu+ci9vz0c5DuwDtIrQL0eaiXYx2KdolaJehXYF2OcWEdhUE5y9fjXYt2jUQ5FDXo81Ho3XpFqDdiHYzBOea3IrbWyC47hatA74QguvR05rctC40rU1N7zOiNYppnWRam4vW9qQ1VmndUlq7k9a6pDU0aR1BWsuS1vOj+dO0rh6t7Ubrm9Eaa7TOFK01ROst0TsSaI0eekcSrb/zLATXQaG1YGg9ClqTgdaFWA3hOTE7Q9PQn/SuimbuZwn9ORb9ZTH6/+HK+nOIsP6cgP7GMOI/QrT+U7fn/5AuOtjNE8MMvr+X5fHXl/k/xzH6X2IE6p/HMvCHCuvPUehvNAM/SVh/HoP+shn4ycr6M0VYf45HfxmM+Icp688jhfXnOPSXyYh/eFT/ha9FKf1nOPVHW/9pjD+kKtc/j1LWnyOq0J8263+PRH/FaBMV9WcRI/+kKde/0oX1x1T0N5kR/0hl/TFKWH8UoL8TGfFnRKD+VcjAPzoC/HM6Az9TmH+egP6mMPCzovN/ws0J6j/Szyb6rwdYw1u12jD/5yREy2P0v2xl/TFaWH/QM6S5jPjHKOuPscL6Ix/9TWLEP065/nWMMv8cr8w/J0T1X3kT03+GU3+09V9If5jOXPLWv0oV9cccRv45Vll/HCesP2ajvxmM+I9X1h85wvrjDPQ3ixH/CRHQH2cx8HMjoD/OZOBPjM7/KW9UOyb+39SQ/+9tefz1Yf7PyYh2CqP/TRKuf5yG/mYy8Ccr6488Yf1xOvorYcQ/RVl/nCisP051gu9v9Is/VVl/5Cvrj5Oi/D+c/6T4v+HUH23+r6E/p1VR/zB9cx6tf0N8chHaeYr640pG/ilQ1h/ThfXHxejvAkb8hcr6o0hYf1yO/i5ixF8cAf0xj4F/cnT+T3lLd8f/Fxny/30sj7++zP+5gtH/SoTrX+egv7kM/FJh/XEp+ruQgV+mrD9mCOuPy9DfuYz4Zyrrj1OE9ccl6O98RvyzlPXH7Cj/D+c/e/6fmVecm1+Sk5xbXFTzv19dnP9zqnL967Qq9Ecf4/jD9Y9rFfXH7Yz8c7qy/qDx+tD6TxL64yb0N58R/5nK+uMsYf1xK/q7kRH/nOj6P3XWpJvt/XPJL6tXr92yZhsoNYn5P2PR1qJNN/h+T8vjry/zfxYy8s/ZEah/3sbAP0dYf16N/m5g4J8rrD9vRn/XM/DPU9af5wvrz1vQ3zWM+C9Q1p8XCuvPBfTuSkb8c6P6r7zJ6b/xU4sKT8zgSsCdcf7PRcr1z4uV9eclVejPvsbxO85V6O9FtLsU9ediRv65VFl/0nhlW/ezhP58AP3dw4j/cmX9eYWw/nwE/d3PiH9eBOpfjzHwr4wA/3yUgX+VMP+8A/3dx8C/WvD+v3F93dZ/9Pwf6T9aE8ZE/+1refz1Yf7PQ4h2L6P/XaOsP64V1h8Po787GfFfp6w/5gvrjwfR392M+K9Xrn/doMw/b1TmnzdF9V95k9N/4/Jzi9jyr9bM/+ln3P/D9a8nFPXHKkb+WaCsP2723P8k9MfT6G8ZI/5blPXHrcL6g9ZueYoR/20R0B8vMPAXRkB/PM/Av10w/69fWLf5PyVQ4v8TDfn/fmANb9Vqw/yfxxFtBaP/LRKufzyD/pYz8O9Q1h93CuuPZ9HfUkb8dynrj7uF9cdKJ7iOr1/8e5T1x73K+uO+KP8P5z8x/j8yd+bsHPZrvHbG+T/3V1H/6G/c/x1Ygv6+QlurqD/eZuSfB5T1x4PC+uM19PcyI/6HlPXHw8L640309yoj/kcioD82MPAf9Tx/ads2rnjtgfUf6r0F2pb/L3D5f7MYM/7fy/L468v8n7cY/e8x4frXavT3CgN/sbD+oDvKOgb+EmX98biw/ngD/a1hxL9UWX88Iaw/Xkd/LzHif1JZfyyL8v9w/rPn/4llZbmTpuWMnZpXmJOcyywB7Izzf5Yr179WVKE/BhjH75Tjv6uoP75k5J+nlPUH1Svau58l9MdH6O89RvwrlfXHM8L64zP09yEj/mcF8z/N/1i8dcXvoNQk5n+8CsH5H58ZfP8Ay+OvL/M/vmD0v+ciUP/6nIH/vLD+eAf9fcDAf0FYf3yC/t5n4K9S1h8vCuuPT9HfJkb8q5X1xxph/fEx+tvMiH9tlP+XN2H+z54EsjPO/3hJuf71srL+WFeF/hhoHL/jbER/f6B9q6g/fmfkn1eU9QeN1ce6nyX0x4/o7ztG/K8p64/XhfXHr+jvP4z410eg/rGVgf9GBPjnbwz8N4X559fo7wcG/lvC8z/qsv6jtYBJ/3VzzPTfgZbHXx/mf/yMaN8z+t8GZf3xtrD++AX9fcOIf6Oy/nhHWH/8hP62MOLfpFz/eFeZf25W5p/vRfVfeRPWf+xJILVj/kcC9Dbu/+H6x1+K+qNJjP/8876y/qCxwg7uZwn94WDsfzPy74fK+uMjYf3RCOMHxvn/OAL6YxcG/icR0B+NGfifCs//qMv8P9YJ8v9Zhvz/IMvjrw/zP/5LuYeRfz4Trn80wL6/jYH/ubL++EJYfzTE+P9kxP+lsv74Slh/xGD8/2PE/7Wy/vhGWX98G+X/0eY2Df25RbD/UZN8n+nOhv9/UEsBAhcLFAACAAgA+FBDRr55OiHtGQAACJABAAkACQAAAAAAAAAAAACAAAAAAFVJUGFja2FnZVVUBQAH0J3QVFBLBQYAAAAAAQABAEAAAAAlGgAAAAA=


[Script]
Dimenv AutoSupply
Dimenv AutoRepair
Dimenv AutoExpedition
Dimenv AutoAttack

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply1.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply2.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply3.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply4.Value = Form.CB_AutoSupply.Value
End Event
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
    Form.CB_Repair_Dapo.Value = Form.CB_AutoRepair.Value
    Form.CB_Repair_ZhongPo.Value = 0
    Form.CB_Repair_XiaoPo.Value = 0
End Event
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
End Event
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
    //    Form.CB_Attack_When_DaPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_When_DaPo.Value = 0
    Form.CB_Attack_When_ZhongPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_When_XiaoPo.Value = Form.CB_AutoAttack.Value
End Event

Event Form.CB_Attack_When_DaPo.Click
    If (Form.CB_Attack_When_DaPo.Value = 1) Then 
        MessageBox "警告，这极有可能导致舰船沉没！请确认了解该情况会导致的后果！"
    End If
End Event

Event Form.CB_MapLevel.SelectChange
    AttackMapIndex = Form.CB_MapLevel.ListIndex
End Event
Event Form.CB_MissionLevel.SelectChange
    //	= Form.CB_MissionLevel.ListIndex
End Event
Event Form.CB_Atatck_MissionLevel.SelectChange

End Event



/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"

ExpeditionNavyMisstion1ID = 2
ExpeditionNavyMisstion2ID = 4

//出击地图下标
AttackMapIndex = 1
//出击任务下标X
AttackMisstionXIndex = 1
//出击任务下标Y
AttackMisstionYIndex = 1
AttackNightFight = 0
AttackFightRound = 0

//补给舰队下标最大值
SupplyNavyMax = 2
/*****************************设置常量*****************************/
//远征舰队坐标
Const ExpeditionNavyPosition = "356|120"
Const ExpeditionNavyPositionOffset = 30
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMisstionPosition = "160|170"
Const ExpeditionMisstionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//入渠类型坐标
Const RepairTypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMisstionPosition = "280|200"
Const AttackMisstionPositionOffsetX = 350
Const AttackMisstionPositionOffsetY = 150
/**********************************************************初始化变量**********************************************************/
X = -1 
Y = - 1 

ShipWasDestroyed = 0














//**********************************************************逻辑**********************************************************/

/****************************初始化****************************/
Call GetHwndForGame()
TracePrint "Form.CB_Supply1.Value:" & Form.CB_Supply1.Value
Call TD_CheckTiDu()
///****************************远征结束*****************************/
//Call GoToMuGang()
///*****************************补给*****************************/
//TracePrint "AutoSupply:" & AutoSupply
//If (AutoSupply = 1) Then 
//    Call SupplyNavy()
//End If
///*****************************入渠*****************************/
//TracePrint "AutoRepair:" & AutoRepair
//If (AutoRepair = 1) Then 
//    Call RepairNavy()
//End If
///*****************************远征*****************************/
//TracePrint "AutoExpedition:" & AutoExpedition
//If (AutoExpedition = 1) Then 
//    Call ExpeditionNavy()
//End If
///****************************出击****************************/
//TracePrint "AutoAttack:" & AutoAttack
//If (AutoAttack = 1) Then 
//    Call AttackNavy()
//End If
///*****************************补给*****************************/
//If (AutoSupply = 1) Then 
//    Call SupplyNavy()
//End If
///*****************************入渠*****************************/
//If (AutoRepair = 1) Then 
//    Call RepairNavy()
//End If
///*****************************结束*****************************/
//Call TD_CheckExpedition()
























/**********************************************************函数**********************************************************/








/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    //回到母港
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
    
    Do While(FoundPic = 1)
        //每次回港都直接检查远征
        Call LJ_FindPic("远征_结束_开始")
        If (FoundPic = 1) Then 
            TracePrint "发现远征结束舰队"
            Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
            Call LJ_DeleyForNet()
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPic("远征_结束_开始")
            isExpeditionFinish = True
        End If
    Loop
    If (isExpeditionFinish) Then 
    	isExpeditionFinish = False
    	Call SupplyNavy()
    End If
End Function
Function GoToScene(SceneName)
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*远征主逻辑*/
Function ExpeditionNavy()
    TracePrint "AutoExpedition:" & AutoExpedition
    If (AutoExpedition = 0) Then 
        Exit Function
    End If
    
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    
    Call ExpeditionSelectMapByMisstionID(ExpeditionNavyMisstion1ID,1)
    Call ExpeditionSelectMapByMisstionID(ExpeditionNavyMisstion2ID,2)
    
    Call LJ_DeleyForNet()
    
    Call GoToMuGang()
End Function

/*选择远征地图*/
Function ExpeditionSelectMapByMisstionID(ExpeditionMisstionID,NavyNumber)
    //远征地图下标
    ExpeditionMapIndex = ExpeditionMisstionID / 8
    TracePrint "ExpeditionMapIndex:" & ExpeditionMapIndex
    //远征任务下标
    ExpeditionMisstionIndex = ExpeditionMisstionID mod 8
    TracePrint "ExpeditionMisstionIndex:" & ExpeditionMisstionIndex
    
    /*选择远征地图*/
    Call LJ_PointAddAndClick(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
	/*选择远征关卡*/
    Call LJ_PointAddAndClick(ExpeditionMisstionPosition,0,ExpeditionMisstionIndex * ExpeditionMisstionPositionOffset)

    Call LJ_FindPic("出击_远征_远征中止")
    If (FoundPic = 1) Then //如果远征正在执行，则退出
        TracePrint "第" & NavyNumber & "舰队已经在执行远征任务"
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_PointAddAndClick(ExpeditionNavyPosition, NavyNumber * ExpeditionNavyPositionOffset, 0)
    Call LJ_FindPic("远征_结束_舰队_缺油")
    If (FoundPic = 1) Then 
        TracePrint NavyNumber & "舰队在执行任务" & ExpeditionMisstionID + 1  & "时缺油"
        Call SupplyNavy()
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
End Function

/*补给主逻辑*/
Function SupplyNavy()
    TracePrint "AutoSupply:" & AutoSupply
    If (AutoSupply = 0) Then 
        Exit Function
    End If
    Call GoToMuGang()
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    For index = 0 To SupplyNavyMax
        If (index = 0) Then 
            If (Form.CB_Supply1.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 1) Then 
            If (Form.CB_Supply2.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 2) Then 
            If (Form.CB_Supply3.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 3) Then 
            If (Form.CB_Supply4.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_FindPic("补给_补给列表_全选框")
        If (FoundPic = 1) Then 
            TracePrint "补给第" & index+1 &"舰队时，使用全选框"
            Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
            Call LJ_FindPic("补给_补给列表_确定补给_disable")
            If (FoundPic = 0) Then 
                TracePrint "不能补给，第" & index+1 &"舰队"
                Call LJ_FindPicAndClick("补给_补给列表_确定补给")
                Call LJ_DeleyForNet()
            End If
        End If
        Rem 下一个补给舰队
    Next
End Function

/*入渠主逻辑*/
Function RepairNavy()
    TracePrint "AutoRepair:" & AutoRepair
    If (AutoRepair = 0) Then 
        Exit Function
    End If
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    
    Dim FlagShipIsRepayed
    FlagShipIsRepayed = 0
    Dim RepairedX, RepairedY
    RepairedX = 0
    RepairedY = 0
    IsRepayed = 0
    For index = 0 To 3
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_空位")
        
        //        Dim Timeout
        //        Timeout = 0
        //        Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //        Do While (FoundPic = 0)
        //            Call LJ_PointGetAndClick(RepairTypePosition)
        //            Delay 100
        //            Call LJ_FindPic("入渠_维修列表_类型_损坏程度")
        //            Delay 100
        //            Timeout = Timeout + 100
        //            If (Timeout >= 5000) Then 
        //                Exit Function
        //            End If
        //        Loop
        //确定船只
        For index = 0 To 9
            TracePrint "正在判断第" & index+1 &"艘舰"
            If (Form.CB_Repair_Navy_1.Value = 1) Then 
                Call LJ_FindPicByRect("入渠_维修列表_第一舰队", X, Y, 800, 480)
            End If
            If (FoundPic = 1) Then 
                TracePrint "找到第一舰队 x:" & X & " Y:" &Y
                IsRepayed = RepairFindShip(X, Y)
            End If
            If (IsRepayed = 0) Then 
                Call LJ_FindPicAndClick("入渠_维修列表_入渠开始")
                Call LJ_FindPicAndClick("入渠_维修列表_维修开始_确定维修")
                Call LJ_FindPicAndClick("入渠_维修列表_空位_详情返回")
                Call LJ_FindPicAndClick("入渠_维修列表_空位_列表返回")
            End If
        Next
    Next
    Call GoToMuGang()
End Function

Function RepairFindShip(RepairedX,RepairedY)
    RepairedYStart = RepairedY - 10
    RepairedYEnd = RepairedY + 30
    If (Form.CB_Repair_XiaoPo.Value = 1) Then 
        TracePrint"小破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_小破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_ZhongPo.Value = 1) Then 
        TracePrint"中破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_中破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_DaPo.Value = 1) Then 
        TracePrint"大破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_大破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    Call LJ_FindPicByRect("入渠_战斗状态_修复", RepairedX, RepairedYStart, 800,RepairedYEnd)
    If (FoundPic = 1) Then 
        RepairedX = RepairedX + 0
        RepairedY = RepairedY + 25
        RepairFindShip = 0
    End If
    
End Function

/**战斗**/
Function AttackNavy()
    If (AutoAttack = 0) Then 
        Exit Function
    End If
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
	/*选择出击地图*/
    Call LJ_PointAddAndClick(AttackMapPosition, AttackMapIndex * AttackMapPositionOffset, 0)
    Delay 1000
	/*选择出击关卡*/
    Call LJ_PointAddAndClick(AttackMisstionPosition,AttackMisstionXIndex * AttackMisstionPositionOffsetX,AttackMisstionYIndex * AttackMisstionPositionOffsetY)
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_FindPic("出击_出击_出击开始_disable")
    If (FoundPic = 0) Then 
        Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
        Call Fighting()
        Call LJ_DeleyForNet()
    End If
End Function
Function Fighting()
    FightingRound = 0
    Do
        Call LJ_FindPicAndClick("战斗_战斗中_指南针")
        Call LJ_FindPicAndClick("战斗_战斗中_阵形_复k阵")
        If (AttackNightFight = 1) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_追击")
        End If
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1
                TracePrint "当前战斗回合数：" & FightingRound & " 总攻击回合数：" & AttackFightRound
            End If
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
            TracePrint "战斗结束，判断舰船是否大破"
            Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
            If (FoundPic = 1) Then 
                TracePrint "检测到舰船大破，不在继续进击"
                ShipWasDestroyed = 1
                FightingRound = 999//不在继续战斗
            End If
        End If
        Call LJ_FindPicAndClick("进击_结束_评价_继续")
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function














/**********************************************************控制提督很忙**********************************************************/











Function TD_RefreshGame()
    Call setHwndByTidu()
    Call LJ_PointGetAndClick("30|840")
    Call LJ_PointGetAndClick("130|590")
    Call LJ_PointGetAndClick("770|590")
    Call LJ_FindPicAndClick("提督_设置")
    Call setHwndByGame()
End Function

Function TD_BackToMuGang()
    Call setHwndByGame()
    Call GoToMuGang()
End Function

Function TD_Supply()
    Call setHwndByGame()
    TracePrint "AutoSupply:" & AutoSupply
    Call SupplyNavy()
End Function

///*****************************入渠*****************************/
Function TD_Repair()
    Call setHwndByGame()
    TracePrint "AutoRepair:" & AutoRepair
    If (AutoRepair = 1) Then 
        Call RepairNavy()
    End If
End Function

/*****************************远征*****************************/
Function TD_Expedition()
    Call setHwndByGame()
    Call GoToMuGang()
    Call SupplyNavy()
    TracePrint "AutoExpedition:" & AutoExpedition
    Call ExpeditionNavy()
End Function

/****************************出击****************************/
Function TD_Attack()
    Call setHwndByGame()
    Call GoToMuGang()
    Call SupplyNavy()
    Call RepairNavy()
    Call AttackNavy()
End Function


/**检查远征是否就绪**/
Function TD_CheckTiDu()
    Do
        Call setHwndByTidu()
        
        Rem 远征判断
        Call LJ_FindPic("提督_综合_远征_第二舰队_准备就绪1")
        If (FoundPic = 1) Then 
            Call TD_Expedition()
            Exit Function
        End If
        Call LJ_FindPic("提督_综合_远征_第二舰队_准备就绪2")
        If (FoundPic = 1) Then 
            Call TD_Expedition()
            Exit Function
        End If
        Call LJ_FindPic("提督_综合_远征_第三舰队_准备就绪1")
        If (FoundPic = 1) Then 
            Call TD_Expedition()
            Exit Function
        End If
        Call LJ_FindPic("提督_综合_远征_第三舰队_准备就绪2")
        If (FoundPic = 1) Then 
            Call TD_Expedition()
            Exit Function
        End If
        Rem 远征结束
        
        Rem 进击判断
        If (AutoAttack = 1) Then 
            Call LJ_FindPic("提督_综合_舰队列表_HP_大破")
            If (Form.CB_Attack_When_DaPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否大破"
            Else 
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否大破：是 取消出击！"
                    Call TD_Repair()
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否大破：否"
                End If
            End If
            If (Form.CB_Attack_When_ZhongPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否中破"
            Else 
                Call LJ_FindPic("提督_综合_舰队列表_HP_中破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否中破：是 取消出击！"
                    Call TD_Repair() 
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否中破：否"
                End If
            End If
            If (Form.CB_Attack_When_XiaoPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否小破"
            Else
                Call LJ_FindPic("提督_综合_舰队列表_HP_小破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否小破：是 取消出击！"
                    Call TD_Repair()
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否小破：否"
                End If
            End If
            Call LJ_FindPic("提督_综合_舰队列表_入渠中")
            If (FoundPic = 1) Then 
                TracePrint "当前舰队有船只正在入渠"
                Goto 进击结束
            End If
            TracePrint "AutoAttack:" & AutoAttack
            If (AutoAttack = 1) Then 
                Call LJ_FindPic("提督_综合_舰队列表_可以出击")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_疲劳回复完毕")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_6只疲劳49")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_6只疲劳40以上")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPicByRect("提督_综合_舰队列表_舰队状态_可以出击",103,572,130,604)
                If (FoundPic = 1) Then 
                   	Call TD_Attack()
                    Exit Function
                End If
            End If
        End If
        Rem 进击结束
        TracePrint "进击结束"
        
        Delay 5000
    loop While (True)
End Function













/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(HwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    HwndGame = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    Call setHwndByGame()
    If (Hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
    Call Plugin.Window.SetClientSize(HwndTidu, 800, 1000)
    TracePrint "HwndTidu:" & HwndTidu
    TracePrint "HwndGame:" & HwndGame
    TracePrint "Hwnd:" & Hwnd
End Function
Function setHwndByGame()
    Hwnd = HwndGame
    TracePrint "Hwnd Game Hwnd:" & Hwnd
    ScreenHeight = 480
    ScreenWidth = 800
    PicDefinition = 0.9
End Function
Function setHwndByTidu()
    TracePrint "Hwnd Tidu Hwnd:" & Hwnd
    Hwnd = HwndTidu
    ScreenHeight = 1000
    ScreenWidth = 800
    PicDefinition = 1.0
End Function

/**第三方库查找图片**/
Function Lib_FindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, 0, 0, ScreenWidth, ScreenHeight, resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function
Function Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call Lib_FindPic(picName)
    If X > - 1  Then //找到了
        TracePrint "LJ_FindPic:" & picName & " FoundPic = true"
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
                        TracePrint "LJ_FindPic:" & picName & " FoundPic = false"
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    If X <= - 1  Then 
        Exit Function
    End If
    TracePrint "LJ_LeftClickOnXY x:" & X & " Y :" & Y
    If (Y < 800) Then 
        Call Plugin.Bkgnd.LeftClick(Hwnd, X, Y)
    Else 
        Call Plugin.Bkgnd.LeftClick(HwndTidu, X, Y)
    End If
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim ZuoBiao
    ZuoBiao = InStr(XY, "|")
    X = Clng(Left(XY, ZuoBiao - 1)) : Y = Clng(Right(XY, Len(XY) - ZuoBiao))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

Function LJ_DeleyForNet()
    Delay 5000
End Function