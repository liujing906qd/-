[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=1ea4e81b-f045-449e-81b4-25c7ad71afbb
Description=舰娘
Enable=0
AutoRun=0
[Repeat]
Type=1
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]
记得停止睡眠模式

[UIPackage]
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


[Script]
//开关
Dimenv AutoSupply,AutoRepair,AutoExpedition,AutoAttack,AutoChangeShip

Dimenv SupplyNavyArray
Dimenv ExpeditionNavyArray 
Dimenv AutoAttackNavyArray

//远征舰队
Dimenv Expedition_Navy2_Enable, Expedition_Navy3_Enable, Expedition_Navy4_Enable
//远征舰队对应任务ID
DimEnv ExpeditionMissionID_Navy2, ExpeditionMissionID_Navy3, ExpeditionMissionID_Navy4

//出击状态
DimEnv AttackNightFight,AttackFightRound

//换船
Dimenv ChangeShipPageCount, ChangeShipLineNumber


//自动补给开关
Event Form.CB_AutoSupply.Click
    AutoSupply = Form.CB_AutoSupply.Value
    Form.CB_Supply_When_Attack_Before.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply_When_Expedition_Before.Value = Form.CB_AutoSupply.Value
    Form.CB_Supply_Sort.Value = Form.CB_AutoSupply.Value
End Event
//自动入渠开关
Event Form.CB_AutoRepair.Click
    AutoRepair = Form.CB_AutoRepair.Value
    Form.CB_Repair_Dapo.Value = Form.CB_AutoRepair.Value
    Form.CB_Repair_ZhongPo.Value = 0
    Form.CB_Repair_XiaoPo.Value = 0
    Form.CB_Repair_Navy_1.Value = Form.CB_AutoRepair.Value
End Event
//自动远征开关
Event Form.CB_AutoExpedition.Click
    AutoExpedition = Form.CB_AutoExpedition.Value
    Form.CB_Supply_CheckOil.Value = Form.CB_AutoExpedition.Value
End Event
//自动攻击开关
Event Form.CB_AutoAttack.Click
    AutoAttack = Form.CB_AutoAttack.Value
    //    Form.CB_Attack_When_DaPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_When_DaPo.Value = 0
    Form.CB_Attack_When_ZhongPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_When_XiaoPo.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_Suppy.Value = Form.CB_AutoAttack.Value
    Form.CB_Attack_CheckOil.Value = Form.CB_AutoAttack.Value
End Event
//结束自动换船开关
Event Form.CB_AutoChangeShip.Click
    AutoChangeShip = Form.CB_AutoChangeShip.Value
End Event


//大破出击开关
Event Form.CB_Attack_When_DaPo.Click
    If (Form.CB_Attack_When_DaPo.Value = 1) Then 
        MessageBox "警告，这极有可能导致舰船沉没！请确认了解该情况会导致的后果！"
    End If
End Event

//是否进击回合次数
Event Form.CB_AttackNightFight.Click
    AttackNightFight = Form.CB_AttackNightFight.Value
End Event
//是否夜战
Event Form.CB_AttackFightRound.SelectChange
    AttackFightRound = Form.CB_AttackFightRound.ListIndex
End Event

//设置第几舰队远征
Event Form.CB_Expedition_Navy2_Enable.Click
    Expedition_Navy2_Enable = Form.CB_Expedition_Navy2_Enable.Value
    Form.CB_Supply2.Value = Form.CB_Expedition_Navy2_Enable.Value
    Form.CB_AutoSupply.Value =1
End Event
Event Form.CB_Expedition_Navy3_Enable.Click
    Expedition_Navy3_Enable = Form.CB_Expedition_Navy3_Enable.Value
    Form.CB_Supply3.Value = Form.CB_Expedition_Navy3_Enable.Value
    Form.CB_AutoSupply.Value = 1
End Event
Event Form.CB_Expedition_Navy4_Enable.Click
    Expedition_Navy4_Enable = Form.CB_Expedition_Navy4_Enable.Value
    Form.CB_Supply4.Value = Form.CB_Expedition_Navy4_Enable.Value
    Form.CB_AutoSupply.Value = 1
End Event
//设置远征地图
Event Form.CB_Expedition_Missionevel_Navy2.SelectChange
    ExpeditionMissionID_Navy2 = Form.CB_Expedition_Missionevel_Navy2.ListIndex
End Event
Event Form.CB_Expedition_Missionevel_Navy3.SelectChange
    ExpeditionMissionID_Navy3 = Form.CB_Expedition_Missionevel_Navy3.ListIndex
End Event
Event Form.CB_Expedition_Missionevel_Navy4.SelectChange
    ExpeditionMissionID_Navy4 = Form.CB_Expedition_Missionevel_Navy4.ListIndex
End Event

//出击后强制补给
Event Form.CB_Attack_Suppy.Click
    Form.CB_Supply1.Value = Form.CB_Attack_Suppy.Value
    Form.CB_AutoSupply.Value = 1
End Event
/**********************************************************设置用户自定义变量**********************************************************/

//资源文件夹路径
Dim resourceFolder
resourceFolder = "C:\Users\LiuJing\Pictures\"
DimEnv ChangeShipIDArrayIndex










/*****************************设置常量*****************************/
//远征舰队坐标
Const ExpeditionNavyPosition = "356|120"
Const ExpeditionNavyPositionOffset = 30
//远征地图坐标
Const ExpeditionMapPosition = "135|450"
Const ExpeditionMapPositionOffset = 55
//远征关卡坐标
Const ExpeditionMissionPosition = "160|170"
Const ExpeditionMissionPositionOffset = 30

//补给全选框坐标
Const SupplyCheckBoxAllPosition = "120|120"
//补给舰队坐标
Const SupplyNavyPosition = "150|120"
Const SupplyNavyPositionOffset = 30
//补给舰队确定
Const SupplyNavyConfirmPosition = "700|450"

//入渠空位坐标
Const RepairEmptyPosition = "250|170"
Const RepairEmptyPositionOffset = 80
//列表类型坐标
Const TypePosition = "780|110"
//入渠舰队坐标
Const RepairNavyPosition = "480|141"
Const RepairNavyPositionOffset = 30

//出击地图坐标
Const AttackMapPosition = "160|450"
Const AttackMapPositionOffset = 75
//出击任务坐标
Const AttackMissionPosition = "280|200"
Const AttackMissionPositionOffsetX = 350
Const AttackMissionPositionOffsetY = 150
//出击的BOSS地图坐标
Const AttackMissionPositionOfBossMap = "710|260"
//出击的BOSS地图任务2坐标
Const AttackMissionPositionOfBossMission1 = "710|260"
//出击的BOSS地图任务3坐标
Const AttackMissionPositionOfBossMission2 = "710|300"

//出击的活动地图坐标
Const AttackMissionPositionOfSpecialMap = "720|450"
//出击的活动地图任务1坐标
Const AttackMissionPositionOfSpecialMission = "720|200"
Const AttackMissionPositionOfSpecialMissionOffset = 100


//换船接触除了旗舰以外的船坐标
Const ChangeShipWithOutFlagPosition = "420|120"
Const ChangeShipPagePosition = "520|450"
Const ChangeShipPagePositionOffset = 30
Const ChangeShipListPosition = "470|170"
Const ChangeShipListPositionOffset = 30
Const ChangeShipBackToFirstPagePosition = "440|450"
Const ChangeShipJumpPageToNext5Position = "680|450"
Const ChangeShipListNavyPosition = "130|120"

/**********************************************************初始化变量**********************************************************/
X = -1 
Y = - 1 
//攻击阵形坐标数组
AttackFormationPositionArray = Array("450|185","480|185","710|185","510|345","640|345")






















/**********************************************************提督很忙**********************************************************/


















/*****************************远征*****************************/
Function TD_Expedition()
    Call setHwndByGame()
    Call GoToMuGang()
    If (Form.CB_Supply_When_Expedition_Before.Value = 1) Then 
        Call SupplyNavy()
    End If
    Call ExpeditionNavy()
End Function

/****************************出击****************************/
Function TD_Attack()
    Call setHwndByGame()
    Call GoToMuGang()
    If (Form.CB_Supply_When_Attack_Before.Value = 1) Then 
        Call SupplyNavy()
    End If
    Call AttackNavy()
End Function


/**检查远征是否就绪**/
Function TD_CheckTiDu()
    Do
        Call setHwndByTidu()
        
        Rem 远征判断
        If (Form.CB_AutoExpedition.Value = 1) Then 
        	

            Call LJ_FindPic("提督_综合_远征_第二舰队_准备就绪1")
            If (Form.CB_Expedition_Navy2_Enable.Value = 1 and FoundPic = 1) Then 
                Call TD_Expedition()
                Exit Function
            End If
            Call LJ_FindPic("提督_综合_远征_第二舰队_准备就绪2")
            If (Form.CB_Expedition_Navy2_Enable.Value = 1 and FoundPic = 1) Then 
                Call TD_Expedition()
                Exit Function
            End If
            Call LJ_FindPic("提督_综合_远征_第三舰队_准备就绪1")
            If (Form.CB_Expedition_Navy3_Enable.Value = 1 and FoundPic = 1) Then 
                Call TD_Expedition()
                Exit Function
            End If
            Call LJ_FindPic("提督_综合_远征_第三舰队_准备就绪2")
            If (Form.CB_Expedition_Navy3_Enable.Value = 1 and FoundPic = 1) Then 
                Call TD_Expedition()
                Exit Function
            End If
        Else 
            TracePrint "远征没有开启"
        End If
        Rem 远征结束
        
        Rem 入渠开始判断	
        If (Form.CB_Repair_Dapo.Value = 1) Then 
            TracePrint "按照入渠设置，检测是否大破"
            Call LJ_FindPic("提督_综合_舰队列表_HP_大破")
            If (FoundPic = 1) Then 
                TracePrint "按照出击设置，检测是否大破：是"
                Call RepairNavy()
                Call ChangeNavy()
                Goto 入渠结束判断
            Else 
                TracePrint "按照入渠设置，检测是否大破：否"
            End If
        Else 
            TracePrint "按照入渠设置，不检测是否大破"
        End If
        If (Form.CB_Repair_ZhongPo.Value = 1) Then 
            TracePrint "按照入渠设置，检测是否中破"
            Call LJ_FindPic("提督_综合_舰队列表_HP_中破")
            If (FoundPic = 1) Then 
                TracePrint "按照出击设置，检测是否中破：是"
                Call RepairNavy()
                Call ChangeNavy()
                Goto 入渠结束判断
            Else 
                TracePrint "按照出击设置，检测是否中破：否"
            End If
        Else 
            TracePrint "按照入渠设置，不检测是否中破"
        End If
            
        If (Form.CB_Repair_XiaoPo.Value = 1) Then 
            TracePrint "按照入渠设置，检测是否小破"
            Call LJ_FindPic("提督_综合_舰队列表_HP_小破")
            If (FoundPic = 1) Then 
                TracePrint "按照出击设置，检测是否小破：是！"
                Call RepairNavy()
                Call ChangeNavy()
                Goto 入渠结束判断
            Else 
                TracePrint "按照出击设置，检测是否小破：否"
            End If
        Else
            TracePrint "按照入渠设置，不检测是否小破"
        End If
        Rem 入渠结束判断
        
        Rem 进击判断
        If (AutoAttack = 1) Then 
            If (Form.CB_Attack_When_DaPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否大破"
            Else 
                Call LJ_FindPic("提督_综合_舰队列表_HP_大破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否大破：是 取消出击！"
                    Call RepairNavy()
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否大破：否"
                End If
            End If
            If (Form.CB_Attack_When_ZhongPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否中破"
            Else 
                Call LJ_FindPic("提督_综合_舰队列表_HP_中破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否中破：是 取消出击！"
                    Call RepairNavy() 
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否中破：否"
                End If
            End If
            If (Form.CB_Attack_When_XiaoPo.Value = 1) Then 
                TracePrint "按照出击设置，跳过检测是否小破"
            Else
                Call LJ_FindPic("提督_综合_舰队列表_HP_小破")
                If (FoundPic = 1) Then 
                    TracePrint "按照出击设置，检测是否小破：是 取消出击！"
                    Call RepairNavy()
                    Goto 进击结束
                Else 
                    TracePrint "按照出击设置，检测是否小破：否"
                End If
            End If
            Call LJ_FindPic("提督_综合_舰队列表_入渠中")
            If (FoundPic = 1) Then 
                TracePrint "当前舰队有船只正在入渠"
                If (AutoChangeShip = 1) Then 
                    Call ChangeNavy()
                    Exit Function
                End If
                Goto 进击结束
            End If
            TracePrint "AutoAttack:" & AutoAttack
            If (AutoAttack = 1) Then 
                If (Form.CB_Attack_CheckCondition.Value = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_可以出击")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_疲劳回复好了")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_疲劳回复时间到了")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_6只疲劳49")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPic("提督_综合_舰队列表_6只疲劳40以上")
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
                Call LJ_FindPicByRect("提督_综合_舰队列表_舰队状态_可以出击",103,572,130,604)
                If (FoundPic = 1) Then 
                    Call TD_Attack()
                    Exit Function
                End If
            End If
        End If
        Rem 进击结束
        TracePrint "进击结束"
        Delay 5000
    loop While (True)
End Function

Function TD_RefreshGame()
    Call setHwndByTidu()
    Call LJ_PointGetAndClick("30|840")
    Call LJ_PointGetAndClick("130|590")
    Call LJ_PointGetAndClick("770|590")
    Call LJ_FindPicAndClick("提督_设置")
    Call setHwndByGame()
End Function
































//**********************************************************逻辑**********************************************************/
Do
/****************************初始化****************************/
    Call GetHwndForGame()
    //Call AttackChangeNavy()
    //    result = CheckOilAndAmmoIsFull()
    //    If (CheckOilAndAmmoIsFull()) Then 
    //        TracePrint "result1:" & result
    //    Else 
    //        TracePrint "result2:" & result	
    //    End If
    //    TracePrint "result3:" & result
    Call TD_CheckTiDu()
    ///****************************远征结束*****************************/
    //Call GoToMuGang()
    ///*****************************补给*****************************/
    //TracePrint "AutoSupply:" & AutoSupply
    //If (AutoSupply = 1) Then 
    //    Call SupplyNavy()
    //End If
    ///*****************************入渠*****************************/
    //TracePrint "AutoRepair:" & AutoRepair
    //If (AutoRepair = 1) Then 
    //    Call RepairNavy()
    //End If
    ///*****************************远征*****************************/
    //TracePrint "AutoExpedition:" & AutoExpedition
    //If (AutoExpedition = 1) Then 
    //    Call ExpeditionNavy()
    //End If
    ///****************************出击****************************/
    //TracePrint "AutoAttack:" & AutoAttack
    //If (AutoAttack = 1) Then 
    //    Call AttackNavy()
    //End If
    ///*****************************补给*****************************/
    //If (AutoSupply = 1) Then 
    //    Call SupplyNavy()
    //End If
    ///*****************************入渠*****************************/
    //If (AutoRepair = 1) Then 
    //    Call RepairNavy()
    //End If
    ///*****************************结束*****************************/
    //Call TD_CheckExpedition()
    Delay 1000
Loop While(1=1)




















/**********************************************************函数**********************************************************/





























/*进入母港 先查找是不是在母港界面 如果不是 则尝试找到并点击左边UI上的母港返回 点击后阻塞等待 直到找到或者超时*/
Function GoToMuGang()
    Call setHwndByGame()
    //回到母港
    Call LJ_FindPic("母港_出击")
    If (FoundPic = 0)
        Call LJ_FindPicUntilFoundThenClick("左侧UI_母港")
        Call LJ_FindPicUntilFound("母港_出击")
    End If
    
    Do While(FoundPic = 1)
        //每次回港都直接检查远征
        Call LJ_FindPic("远征_结束_开始")
        If (FoundPic = 1) Then 
            TracePrint "发现远征结束舰队"
            Call LJ_FindPicUntilFoundThenClick("远征_结束_开始")
            Call LJ_DeleyForNet()
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPicUntilFoundThenClick("远征_结束_评价_继续")
            Call LJ_DeleyForNet()
            Call LJ_FindPic("远征_结束_开始")
            isExpeditionFinish = True
        End If
    Loop
    If (isExpeditionFinish) Then 
        isExpeditionFinish = False
        Call SupplyNavy()
    End If
End Function
Function GoToScene(SceneName)
    Call setHwndByGame()
    Call LJ_FindPic("左侧UI_" & SceneName)
    If (FoundPic = 0) Then 
        Call GoToMuGang()
        Call LJ_FindPicUntilFoundThenClick("母港_" & SceneName)
    Else 
        Call LJ_FindPicUntilFoundThenClick("左侧UI_" & SceneName)
    End If
End Function

/*远征主逻辑*/
Function ExpeditionNavy()
    TracePrint "AutoExpedition:" & AutoExpedition
    Call setHwndByGame()
    If (AutoExpedition = 0) Then 
        Exit Function
    End If
    
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_远征")
    Call LJ_DeleyForNet()
    
    If (Expedition_Navy2_Enable = 1) Then 
        Call ExpeditionSelectMapByMissionID(ExpeditionMissionID_Navy2,1)	
    End If
    If (Expedition_Navy3_Enable = 1) Then 
        Call ExpeditionSelectMapByMissionID(ExpeditionMissionID_Navy3,2)	
    End If
    If (Expedition_Navy4_Enable = 1) Then 
        Call ExpeditionSelectMapByMissionID(ExpeditionMissionID_Navy4,3)	
    End If
    
    If (Form.CB_Supply_CheckOil.Value = 1) Then 
        If (CheckOilAndAmmoIsFull() = false) Then 
            TracePrint NavyNumber & "舰队在执行任务" & ExpeditionMissionID + 1  & "时缺油或弹药"
            Call SupplyNavy()
            Exit Function
        End If
    End If
    
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
    
//    Call GoToMuGang()
End Function

/*选择远征地图*/
Function ExpeditionSelectMapByMissionID(ExpeditionMissionID,NavyNumber)
    //远征地图下标
    ExpeditionMapIndex = ExpeditionMissionID / 8
    TracePrint "ExpeditionMapIndex:" & ExpeditionMapIndex
    //远征任务下标
    ExpeditionMissionIndex = ExpeditionMissionID mod 8
    TracePrint "ExpeditionMissionIndex:" & ExpeditionMissionIndex
    
    /*选择远征地图*/
    Call LJ_PointAddAndClick(ExpeditionMapPosition,ExpeditionMapIndex * ExpeditionMapPositionOffset,0)
	/*选择远征关卡*/
    Call LJ_PointAddAndClick(ExpeditionMissionPosition,0,ExpeditionMissionIndex * ExpeditionMissionPositionOffset)

    Call LJ_FindPic("出击_远征_远征中止")
    If (FoundPic = 1) Then //如果远征正在执行，则退出
        TracePrint "第" & NavyNumber + 1 & "舰队已经在执行远征任务"
        Exit Function
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    Call LJ_PointAddAndClick(ExpeditionNavyPosition, NavyNumber * ExpeditionNavyPositionOffset, 0)
    
    If (Form.CB_Attack_CheckOil.Value = 1) Then 
        If (CheckOilAndAmmoIsFull() = false) Then 
            TracePrint NavyNumber & "舰队在执行任务" & ExpeditionMissionID + 1  & "时缺油或弹药"
            Call SupplyNavy()
            Exit Function
        End If
    End If
    Call LJ_FindPicUntilFoundThenClick("出击_远征_远征开始")
    Call LJ_DeleyForNet()
End Function

Function CheckOilAndAmmoIsFull()
    Call LJ_FindPic("远征_结束_舰队_缺油")
    If (FoundPic = 1) Then 
        CheckOilAndAmmoIsFull = False
        Exit Function
    End If
    
    Call LJ_FindPic("远征_结束_舰队_极度缺油")
    If (FoundPic = 1) Then 
        CheckOilAndAmmoIsFull = False
        Exit Function
    End If
    
    Call LJ_FindPic("远征_结束_舰队_缺弹药")
    If (FoundPic = 1) Then 
        CheckOilAndAmmoIsFull = False
        Exit Function
    End If
    CheckOilAndAmmoIsFull = True
End Function

/*补给主逻辑*/
Function SupplyNavy()
    TracePrint "AutoSupply:" & AutoSupply
    Call setHwndByGame()
    If (AutoSupply = 0) Then 
        Exit Function
    End If
    Call GoToMuGang()
    Call GoToScene("补给")
    Call LJ_DeleyForNet()
    ForForm = 0
    ForTo = 3
    ForStep = 1
    If (Form.CB_Supply_Sort.Value = 1) Then 
    	ForForm = 3
    	ForTo = 0
    	ForStep = -1
    End If
    For index = ForForm To ForTo Step ForStep
        If (index = 0) Then 
            If (Form.CB_Supply1.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 1) Then 
            If (Form.CB_Supply2.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 2) Then 
            If (Form.CB_Supply3.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        If (index = 3) Then 
            If (Form.CB_Supply4.Value = 0) Then 
                Goto 下一个补给舰队
            End If
        End If
        Call LJ_PointAddAndClick(SupplyNavyPosition,index * SupplyNavyPositionOffset,0)
        Call LJ_FindPic("补给_补给列表_全选框")
        If (FoundPic = 1) Then 
            TracePrint "补给第" & index+1 &"舰队时，使用全选框"
            Call LJ_PointGetAndClick(SupplyCheckBoxAllPosition)
            Call LJ_FindPic("补给_补给列表_确定补给_disable")
            If (FoundPic = 0) Then 
                TracePrint "不能补给，第" & index+1 &"舰队"
                Call LJ_FindPicAndClick("补给_补给列表_确定补给")
                Call LJ_DeleyForNet()
            End If
        End If
        Rem 下一个补给舰队
    Next
    Call GoToMuGang()
End Function

/*入渠主逻辑*/
Function RepairNavy()
    TracePrint "AutoRepair:" & AutoRepair
    Call setHwndByGame()
    If (AutoRepair = 0) Then 
        Exit Function
    End If
    Call GoToScene("入渠")
    Call LJ_DeleyForNet()
    
    Dim FlagShipIsRepayed
    FlagShipIsRepayed = 0
    Dim RepairedX, RepairedY
    RepairedX = 0
    RepairedY = 0
    IsRepayed = 0
    For index = 0 To 3
        Call LJ_FindPicUntilFoundThenClick("入渠_维修列表_空位")
        //确定船只
        For index = 0 To 9
            TracePrint "正在判断第" & index+1 &"艘舰"
            If (Form.CB_Repair_Navy_1.Value = 1) Then 
                Call LJ_FindPicByRect("入渠_维修列表_第一舰队", X, Y, 800, 480)
            End If
            If (FoundPic = 1) Then 
                TracePrint "找到第一舰队 x:" & X & " Y:" &Y
                IsRepayed = RepairFindShip(X, Y)
            End If
            If (IsRepayed = 0) Then 
                Call LJ_FindPicAndClick("入渠_维修列表_入渠开始")
                Call LJ_FindPicAndClick("入渠_维修列表_维修开始_确定维修")
                Call LJ_FindPicAndClick("入渠_维修列表_空位_详情返回")
                Call LJ_FindPicAndClick("入渠_维修列表_空位_列表返回")
            End If
        Next
    Next
    //    Call GoToMuGang()
End Function

Function RepairFindShip(RepairedX,RepairedY)
    RepairedYStart = RepairedY - 10
    RepairedYEnd = RepairedY + 30
    If (Form.CB_Repair_XiaoPo.Value = 1) Then 
        TracePrint"小破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_小破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_ZhongPo.Value = 1) Then 
        TracePrint"中破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_中破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    If (Form.CB_Repair_DaPo.Value = 1) Then 
        TracePrint"大破入渠被选中 检查中"
        Call LJ_FindPicByRect("入渠_战斗状态_大破", RepairedX, RepairedYStart, 800,RepairedYEnd)
        Call LJ_LeftClickOnXY()
    End If
    Call LJ_FindPicByRect("入渠_战斗状态_修复", RepairedX, RepairedYStart, 800,RepairedYEnd)
    If (FoundPic = 1) Then 
        RepairedX = RepairedX + 0
        RepairedY = RepairedY + 25
        RepairFindShip = 0
    End If
    
End Function

/**战斗**/
Function AttackNavy()
    Call setHwndByGame()
    TracePrint "AutoAttack:" & AutoAttack
    If (AutoAttack = 0) Then 
        Exit Function
    End If
    If (Int(Form.CB_Attack_Limit_Count.Value) = 1 and Int(Form.Label_Attack_Index.Caption) > Int(Form.IB_Attack_Limit_Count.Text)) Then 
        TracePrint "当前出击次数超过用户设置的最大次数，停止出击" & Form.Label_Attack_Index.Caption &" "& Int(Form.IB_Attack_Limit_Count.Text)
        Exit Function
    End If
    Form.Label_Attack_Index.Caption = Int(Form.Label_Attack_Index.Caption) + 1
        
    Call GoToMuGang()
    Call LJ_FindPicUntilFoundThenClick("母港_出击")
    Delay 1000
    Call LJ_FindPicUntilFoundThenClick("出击_主界面_出击")
    Call LJ_DeleyForNet()
    
    //出击地图
    AttackMapIndex = Form.CB_Attack_MapLevel.ListIndex
    //出击关卡
    AttackMissionXIndex = Form.CB_Attack_MissionLevel.ListIndex mod 2
    AttackMissionYIndex = Int(Form.CB_Attack_MissionLevel.ListIndex / 2)
	
	/*选择出击地图*/
    If (AttackMapIndex < 6) Then //正常地图
        Call LJ_PointAddAndClick(AttackMapPosition, AttackMapIndex * AttackMapPositionOffset, 0)
		/*选择出击关卡*/
        If (Form.CB_Attack_MissionLevel.ListIndex < 4) Then //如果是正常地图，就用正常关卡
            Call LJ_PointAddAndClick(AttackMissionPosition,AttackMissionXIndex * AttackMissionPositionOffsetX,AttackMissionYIndex * AttackMissionPositionOffsetY)
        Else// If(AttackMapIndex = 5)//如果是BOSS地图，就是第五地图
            Call LJ_PointGetAndClick(AttackMissionPositionOfBossMap)
            Delay 2000
            Call LJ_PointGetAndClick(AttackMissionPositionOfBossMission1)//只实现了X-5，没有实现X-6
        End If
    Else// If(AttackMapIndex = 6)//活动地图
        Call LJ_PointGetAndClick(AttackMissionPositionOfSpecialMap)
        Call LJ_PointAddAndClick(AttackMissionPositionOfSpecialMission, 0, Form.CB_Attack_MissionLevel.ListIndex * AttackMissionPositionOfSpecialMissionOffset)
        Call LJ_PointAddAndClick(AttackMissionPositionOfSpecialMission, 0, Form.CB_Attack_MissionLevel.ListIndex * AttackMissionPositionOfSpecialMissionOffset)
        Call LJ_PointAddAndClick(AttackMissionPositionOfSpecialMission, 0, Form.CB_Attack_MissionLevel.ListIndex * AttackMissionPositionOfSpecialMissionOffset)
    End If
	

    Delay 1000
	
    
    Call LJ_FindPicUntilFoundThenClick("出击_确定任务")
    
    
    If (Form.CB_Supply_CheckOil.Value = 1) Then 
        If (CheckOilAndAmmoIsFull() = false) Then 
            TracePrint NavyNumber & "舰队在执行任务" & ExpeditionMissionID + 1  & "时缺油或弹药"
            Call SupplyNavy()
            Exit Function
        End If
    End If
    
    Call LJ_FindPic("出击_出击_出击开始_disable")
    If (FoundPic = 0) Then 
        Call LJ_FindPicUntilFoundThenClick("出击_出击_出击开始")
        Call Fighting()
        Call LJ_DeleyForNet()
    End If
End Function
//战斗中
Function Fighting()
    FightingRound = 0
    Timeout = 0
    Do
        Call LJ_FindPicAndClick("战斗_战斗中_指南针")
        
        Call LJ_PointGetAndClick(AttackFormationPositionArray(Form.CB_Attack_Formation.ListIndex))
        
        If (AttackNightFight = 1) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_夜战")
        Else 
            Call LJ_FindPicAndClick("战斗_战斗中_脱离判定_追击")
        End If
        If (FightingRound < AttackFightRound) Then 
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_进击")
            If (FoundPic = 1) Then 
                FightingRound = FightingRound + 1
                TracePrint "当前战斗回合数：" & FightingRound & " 总攻击回合数：" & AttackFightRound
                Call LJ_DeleyForNet()
            End If
        Else 
            TracePrint "当前战斗回合数：" & FightingRound & " 总攻击回合数：" & AttackFightRound
            Call LJ_FindPicAndClick("战斗_战斗中_回合结束_撤退")
        End If
        Call LJ_FindPicAndClick("战斗_结束_评价_战果报告")
        If (FoundPic = 1) Then 
            TracePrint "战斗结束，判断舰船是否大破"
            Call LJ_FindPicByRect("战斗_战斗中_战斗状态_大破", 0, 0, 400, 480)
            If (FoundPic = 1) Then 
                TracePrint "检测到舰船大破，不再继续进击"
                ShipWasDestroyed = 1
                FightingRound = 999//不在继续战斗
            End If
        End If
        Call LJ_FindPicAndClick("进击_结束_评价_继续")
        Call LJ_FindPicAndClick("出击_结束_评价_返回")
        Call LJ_FindPic("母港_出击")
        Delay 1000
        Timeout = Timeout + 1000
        If (Timeout >= 300000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
    //Call LJ_FindPicUntilFoundThenClick("出击_结束_评价_继续")
End Function

//换船
Function ChangeNavy()
    TracePrint "AutoChangeShip:" & AutoChangeShip
    If (AutoChangeShip = 0) Then 
        Exit Function
    End If
    //舰船更换ID
    Call ChangeNavyUpdate()
    Call GoToScene("编成")
    Call LJ_PointGetAndClick(ChangeShipListNavyPosition)
    Call LJ_PointGetAndClick(ChangeShipListNavyPosition)
    Call LJ_PointGetAndClick(ChangeShipWithOutFlagPosition)
    Call LJ_FindPicUntilFoundThenClick("编成_列表_变更")
    Call LJ_DeleyForNet()
    //更换旗舰
    Call LJ_ClickUntilChangeTo(TypePosition, "编成_列表_类型_船只")
    //初始化页数
    Call LJ_PointGetAndClick(ChangeShipBackToFirstPagePosition)
    Call LJ_PointAddAndClick(ChangeShipPagePosition, ChangeShipPagePositionOffset * 2, 0)
    For index = 0 To ChangeShipPageCount /5 - 1 
        Call LJ_PointGetAndClick(ChangeShipJumpPageToNext5Position)
    Next
    Call LJ_PointAddAndClick(ChangeShipPagePosition, ChangeShipPagePositionOffset * (ChangeShipPageCount mod 5), 0)
    Delay 1000
    Call LJ_PointAddAndClick(ChangeShipListPosition, 0, ChangeShipListPositionOffset * ChangeShipLineNumber)
    Delay 1000
    Call LJ_FindPic("编成_列表_确定变更_disable")
    If (FoundPic = 0) Then 
        Call LJ_FindPicUntilFoundThenClick("编成_列表_确定变更")
    Else 
        ChangeShipIDArrayIndex = ChangeShipIDArrayIndex + 1
        Call ChangeNavy()
    End If
End Function
Function ChangeNavyUpdate()
    ChangeShipIDArray = Split(Form.IB_ChangeShipIDs.Text, "|", - 1 , 1)
    
    Dim ShipID
    ShipID = ChangeShipIDArray(ChangeShipIDArrayIndex)
    PageCount = Int(ShipID  / 10)
    LineIndex = Int(ShipID mod 10)
    //换船页数
    ChangeShipPageCount = pageCount - 1
    //换船行数
    ChangeShipLineNumber = LineIndex
    ChangeShipIDArrayIndex = ChangeShipIDArrayIndex + 1
    TracePrint "ChangeShipIDArrayIndex:" &　ChangeShipIDArrayIndex
End Function

//工厂开发
Function FatoryExploitation()
    TracePrint "AutoChangeShip:" & AutoChangeShip
    If (AutoChangeShip = 0) Then 
        Exit Function
    End If
    Call GoToScene("工厂")
    Delay 1000
    
End Function












































/**********************************************************工具函数**********************************************************/
/*获得游戏句柄*/
Function GetHwndForGame()
    Dim HwndEmbedding,HwndDocObject
    HwndTidu = Plugin.Window.Find(0, "提督Iも忙しい！")
    HwndEmbedding = Plugin.Window.FIndex(HwndTidu, 0, "Shell Embedding", 0)
    HwndDocObject = Plugin.Window.FIndex(HwndEmbedding, 0, "Shell DocObject View", 0)
    HwndGame = Plugin.Window.FIndex(HwndDocObject, 0, "Internet Explorer_Server", 0)
    Call setHwndByGame()
    If (Hwnd = 0) Then 
        MessageBox "找不到窗口句柄，程序结束"
        EndScript
    End If
    Call Plugin.Window.SetClientSize(HwndTidu, 800, 1000)
    TracePrint "HwndTidu:" & HwndTidu
    TracePrint "HwndGame:" & HwndGame
    TracePrint "Hwnd:" & Hwnd
End Function
Function setHwndByGame()
    Hwnd = HwndGame
    TracePrint "Hwnd Game Hwnd:" & Hwnd
    ScreenHeight = 480
    ScreenWidth = 800
    PicDefinition = 0.9
End Function
Function setHwndByTidu()
    TracePrint "Hwnd Tidu Hwnd:" & Hwnd
    Hwnd = HwndTidu
    ScreenHeight = 1000
    ScreenWidth = 800
    PicDefinition = 1.0
End Function

/**第三方库查找图片**/
Function Lib_FindPic(picName)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, 0, 0, ScreenWidth, ScreenHeight, resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function
Function Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Plugin.BGCP2_02.FindPicture(Hwnd, StartX ,StartY ,EndX ,EndY ,resourceFolder & picName & ".bmp", 50, PicDefinition, X, Y)
End Function

/**查找图片**/
Function LJ_FindPic(picName)
    Call Lib_FindPic(picName)
    If X > - 1  Then //找到了
        TracePrint "LJ_FindPic:" & picName & " FoundPic = true"
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            TracePrint "LJ_FindPic:" & picName & " FoundPic = false"
            FoundPic = 0//真没找到
        End If
    End If
End Function
Function LJ_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    Call Lib_FindPicByRect(picName,StartX,StartY,EndX,EndY)
    If X > - 1  Then //找到了	
        FoundPic = 1
    Else //没知道，可能是被选中的状态，更换选中状态的图片再找一次
        Call Lib_FindPic(picName & "_touched")
        If X > - 1  Then 
            FoundPic = 1//找到了	
        Else 
            FoundPic = 0//真没找到
        End If
    End If
End Function

/**查找图片，找到就点没找到就算了**/
Function LJ_FindPicAndClick(picName)
    Call LJ_FindPic(picName)
    If (FoundPic = 1) Then 
        Call LJ_LeftClickOnXY()
    End If
End Function

/**查找图片，直到超时**/
Function LJ_FindPicUntilFound(picName)
    Dim Timeout
    Timeout = 0
    Do
        Call LJ_FindPic(picName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop While (FoundPic = 0)
End Function

/**查找图片，直到超时或者图片位置点击**/
Function LJ_FindPicUntilFoundThenClick(picName)
    Call LJ_FindPicUntilFound(picName)
    Call LJ_LeftClickOnXY()
End Function

/**点击XY的位置**/
Function LJ_LeftClickOnXY()
    If X <= - 1  Then 
        Exit Function
    End If
    TracePrint "LJ_LeftClickOnXY x:" & X & " Y :" & Y
    If (Y < 800) Then 
        Call Plugin.Bkgnd.LeftClick(Hwnd, X, Y)
    Else 
        Call Plugin.Bkgnd.LeftClick(HwndTidu, X, Y)
    End If
    X = -1 
    Y = - 1 
    Delay 1000
End Function

/**存储坐标给某个变量**/
Function LJ_PointSet(positionX, positionY)
    LJ_PointSet = positionX & "|" & positionY
End Function

/**获得坐标从某个变量**/
Function LJ_PointGet(XY)
    Dim ZuoBiao
    ZuoBiao = InStr(XY, "|")
    X = Clng(Left(XY, ZuoBiao - 1)) : Y = Clng(Right(XY, Len(XY) - ZuoBiao))
End Function

/**获得坐标从某个变量，然后单击**/
Function LJ_PointGetAndClick(XY)
    LJ_PointGet (XY)
    
    Call LJ_LeftClickOnXY()
End Function

/**某个变量与坐标相加**/
Function LJ_PointAdd(XY,positionX,positionY)
    Call LJ_PointGet(XY)
    X = X + positionX
    Y = Y + positionY
End Function
/**某个变量与坐标相加，然后单击**/
Function LJ_PointAddAndClick(XY,positionX,positionY)
    Call LJ_PointAdd(XY,positionX,positionY)
    Call LJ_LeftClickOnXY()
End Function

/**点击坐标，直到出现图片**/
Function LJ_ClickUntilChangeTo(Position,PicName)
    Dim Timeout
    Timeout = 0
    Call LJ_FindPic(PicName)
    Do While (FoundPic = 0)
        Call LJ_PointGetAndClick(Position)
        Delay 100
        Call LJ_FindPic(PicName)
        Delay 100
        Timeout = Timeout + 100
        If (Timeout >= 5000) Then 
            Exit Function
        End If
    Loop
End Function

Function LJ_DeleyForNet()
    Delay 10000
End Function
